'use strict';var li;var mi=chrome.i18n.getMessage("545449835455981095");w("mr.IssueSeverity",{sv:"fatal",DA:"warning",Bx:"notification"});w("mr.IssueAction",{hv:"dismiss",Hw:"learn_more"});
var ni=function(a,c){this.sinkId=this.routeId=null;this.severity=c;this.isBlocking="fatal"==this.severity?!0:!1;this.title=a;this.message=null;this.defaultAction="dismiss";this.helpPageId=this.secondaryActions=null},pi=function(){var a=new ni(oi,"notification");a.helpPageId=6320939;a.defaultAction="learn_more";a.secondaryActions=["dismiss"];return a},qi=function(a){a.isBlocking=!0;return a},ri=function(a,c){a.routeId=c;return a},si=function(a,c){a.sinkId=c;return a};var ti=function(a,c){var b=this;this.f=void 0===c?null:c;this.b=new Promise(function(d,e){var f=function(g){b.f=null;e(g)};b.g=f;a(function(g){b.f=null;d(g)},f)})};ti.prototype.cancel=function(a){this.g(a);if(this.f){var c=this.f;this.f=null;setTimeout(function(){return c(a)},0)}};var ui=function(a,c,b){b=void 0===b?null:b;return new ti(function(d,e){a.b.then(function(f){if(c)try{d(c(f))}catch(g){e(g)}else d(f)},function(f){if(b)try{d(b(f))}catch(g){e(g)}else e(f)})},function(d){a.cancel(d)})};
ti.prototype.then=function(a,c){return ui(this,a,void 0===c?null:c)};ti.prototype.catch=function(a){return ui(this,null,a)};var vi=function(a){return new ti(function(c){c(a)})},wi=function(a){return new ti(function(c,b){b(a)})},xi=function(a){return new ti(function(c,b){a.then(c,b)})},yi=function(a,c){var b=!1,d=null;return new ti(function(e,f){a.then(function(g){b||(d=c(g),d.b.then(e,f))},f)},function(e){d?d.cancel(e):b=!0})};var zi={tu:0,ru:1,vu:2,su:3,Tt:4,uu:5,Zv:6,Sz:7,cv:8,tp:9},Ai=function(a,c){a=Error.call(this,a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.reason=0<=c&&9>=c?c:9};q(Ai,Error);var Bi=function(){var a=l(navigator.userAgent.match(/Windows NT (\d+.\d+)/)||[]);a.next();a=a.next().value;return 6.2<=parseFloat(a)},Ci=function(){var a=navigator.userAgent;return a.includes("CrOS")?"ChromeOS":a.includes("Windows")?"Windows":a.includes("Macintosh")?"Mac":a.includes("Linux")?"Linux":"Other"};var Di=!("undefined"==typeof chrome||!chrome.networkingPrivate||!chrome.networkingPrivate.setWifiTDLSEnabledState||"ChromeOS"!=Ci()),Ei=["ChromeOS","Windows"].includes(Ci());var Fi=function(a,c,b,d){this.f=a;this.b=c;this.g=b||null;this.presentationId=d||null},Ii=function(a,c){if("tab"==a.f)a=Gi(a);else if("offscreen_tab"==a.f)c=Gi(a),c.presentationId=a.presentationId,a=c;else{var b={audio:!1,video:!1};a.b.shouldCaptureVideo?(b.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:c}},Hi(a,b.video.mandatory),Ei&&a.b.shouldCaptureAudio&&(b.audio={mandatory:{chromeMediaSource:"system",chromeMediaSourceId:c}})):a.b.shouldCaptureAudio&&(b.audio={mandatory:{chromeMediaSource:"system"}});
a=b}return a},Gi=function(a){var c={audio:a.b.shouldCaptureAudio,video:a.b.shouldCaptureVideo};a.b.shouldCaptureVideo&&(c.videoConstraints={mandatory:{enableAutoThrottling:!0}},Hi(a,c.videoConstraints.mandatory));return c},Hi=function(a,c){var b=a.b.minWidth,d=a.b.minHeight;if(a.b.senderSideLetterboxing){b=a.b;if(0==b.minHeight||0==b.maxHeight?0:Math.floor(100*b.minWidth/b.minHeight)==Math.floor(100*b.maxWidth/b.maxHeight))b={width:b.minWidth,height:b.minHeight};else{d=b.maxWidth;for(var e=b.maxHeight;0!=
e;){var f=d%e;d=e;e=f}e=b.maxWidth/d;d=b.maxHeight/d;if(e<b.minWidth||d<b.minHeight)if(f=Math.max(b.minWidth/e,b.minHeight/d),e*=f,d*=f,e>b.maxWidth||d>b.maxHeight)e=b.maxWidth,d=b.maxHeight;e=Math.round(e);d=Math.round(d);b={width:e,height:d}}d=b;b=d.width;d=d.height}Object.assign(c,{minWidth:b,minHeight:d,maxWidth:a.b.maxWidth,maxHeight:a.b.maxHeight,minFrameRate:a.b.minFrameRate,maxFrameRate:a.b.maxFrameRate})};var Ji=function(a){this.b=a;this.f=this.Yf=null;this.l=gb("mr.mirror.MirrorMediaStream")};Ji.prototype.start=function(){return"tab"==this.b.f?Ki(this):"offscreen_tab"==this.b.f?Li(this):Mi(this)};var Ki=function(a){var c=Ii(a.b);a.l.info("Starting tab capture with constraints "+JSON.stringify(c));return new Promise(function(b,d){chrome.tabCapture.capture(c,function(e){e?(Ni(a,e),b(a)):d(Oi())});window.setTimeout(function(){d(new Ai("chrome.tabCapture.capture failed to call its callback",2))},5E3)})};
Ji.prototype.g=function(a){a&&this.l.info(function(){return"Track "+JSON.stringify(a.target)+" ended"});this.stop()};
var Oi=function(){return chrome.runtime.lastError&&chrome.runtime.lastError.message?new Ai(chrome.runtime.lastError.message,7):new Ai("empty_stream",0)},Qi=function(a){a=void 0===a?!0:a;return new Promise(function(c,b){var d=["screen"];a&&d.push("audio");"Linux"==Ci()&&d.push("window");var e=window.setTimeout(function(){f&&chrome.desktopCapture.cancelChooseDesktopMedia(f);b(new Ai("timeout",1))},6E4);var f=chrome.desktopCapture.chooseDesktopMedia(d,null,function(g){window.clearTimeout(e);g?c(g):b(new Ai("User cancelled capture dialog",
3))})})},Ri=function(a,c){return new Promise(function(b,d){a.l.info(function(){return"Starting desktop capture with constraints "+JSON.stringify(c)});navigator.mediaDevices.getUserMedia(c).then(function(e){e||d(new Ai("empty_stream",8));Ni(a,e);b(e)},function(e){var f=8;"NotAllowedError"==e.name&&(f=3);d(new Ai(e.name+" "+e.constraintName+": "+e.message,f))})})},Mi=function(a){return Ei&&a.b.b.shouldCaptureAudio&&!a.b.b.shouldCaptureVideo?Ri(a,Ii(a.b)).then(function(){return a}):Qi().then(function(c){c=
Ii(a.b,c);return Ri(a,c).then(function(){return a})})},Li=function(a){var c=Ii(a.b);a.l.info(function(){return"Starting offscreen tab capture with constraints "+JSON.stringify(c)});return new Promise(function(b,d){chrome.tabCapture.captureOffscreenTab(a.b.g.toString(),c,function(e){e?(Ni(a,e),b(a)):d(Oi())})})},Ni=function(a,c){a.f=c;c.getAudioTracks().length||c.getVideoTracks();c.getTracks().forEach(function(b){b.onended=a.g.bind(a)})};
Ji.prototype.stop=function(){this.f&&(this.f.getTracks().forEach(function(a){a.onended=null;a.stop()}),this.f=null,this.Yf&&this.Yf())};var Si=function(){},Wi=function(a){var c=Ti.get(a)||null;if(c)return Promise.resolve(c);c=Ui.get(a);c||(c=new Cb,Ui.set(a,c),Vi(a,c));return c.b},Vi=function(a,c){var b=Xi.get(a)||null;if(!b)c.reject(Error("No corresponding bundle for "+a));else if(!Yi.has(b)){var d=Zi.get(b);d||($i.info("Loading bundle "+b+" for module "+a),d=aj(b),Zi.set(b,d));d.catch(function(e){c.reject(e)})}},aj=function(a){var c=new Cb;c.b.then(function(){$i.info("Bundle "+a+" loaded")},function(d){$i.error("Failed to load bundle "+
a);throw d;});var b=document.createElement("script");b.src=chrome.extension.getURL(a);b.setAttribute("type","text/javascript");b.async=!0;b.onload=function(){return c.resolve(void 0)};b.onerror=function(){return c.reject(Error("Failed to load bundle "+a))};document.head.appendChild(b);return c.b},bj=function(a,c){if(Ti.has(a))throw Error("Duplicate module "+a);Ti.set(a,c);(a=Ui.get(a))&&a.resolve(c)};
Si.prototype.handleEvent=function(a,c){for(var b=1;b<arguments.length;++b);throw Error("Not implemented");};
var Xi=new Map([["mr.cast.ChannelService","background_script.js"],["mr.cast.SinkDiscoveryService","background_script.js"],["mr.mirror.cast.Service","mirroring_cast_streaming.js"],["mr.cloud.slarti.SinkDiscoveryService","background_script.js"],["mr.cloud.discovery.WeaveSinkDiscoveryService","background_script.js"],["mr.mirror.hangouts.HangoutsService","mirroring_hangouts.js"],["mr.mirror.hangouts.MeetingsService","mirroring_hangouts.js"],["mr.ProviderManager","background_script.js"],["mr.mirror.webrtc.WebRtcService",
"mirroring_webrtc.js"]]),Yi=new Set(["background_script.js"]),$i=gb("mr.Module"),Ti=new Map,Ui=new Map,Zi=new Map;var cj,dj={Qw:0,wu:1,xu:2,dv:3,ev:4,Ev:5,bw:6,Ow:7,rx:8,sx:9,Ay:10,lz:11,mz:12,Cz:13,Rz:14},ej=function(a){void 0==cj&&(Bb("MediaRouter.Provider.WakeEvent",a,dj),cj=a)};var hj=function(a){return fj(a)||gj(a)},ij=function(a){try{var c=new URL(a);return"http:"!=c.protocol&&"https:"!=c.protocol?!1:-1==c.hash.indexOf("__castAppId__")}catch(b){return!1}},jj=["https://docs.google.com"],fj=function(a){return a.startsWith("urn:x-org.chromium.media:source:tab:")||-1!=a.indexOf("0F5096E8")},gj=function(a){return"urn:x-org.chromium.media:source:desktop"==a},kj=function(a){var c=a.search("urn:x-org.chromium.media:source:tab:");return-1==c?null:parseInt(a.substr(c+36),10)||null};var lj=function(a,c){this.oa=a;this.g=c||null;this.f=this.b=null;this.R=gb("mr.mirror.Service."+a);this.ea=this.ma.bind(this);this.D=!1};q(lj,Si);h=lj.prototype;h.initialize=function(a,c){this.D||(this.g=a,this.D=!0,this.yg(c))};h.yg=function(){};h.getName=function(){return this.oa};
h.Ej=function(a,c,b,d,e){var f=this;this.R.info("Start mirroring on route "+a.id);if(!this.D)return wi(Error("Not initialized"));var g=new Promise(function(k,m){f.m().then(function(){var p=mj(c,b,d);return(new Ji(p)).start()}).then(function(p){if(f.f)throw p.stop(),new Ai("Cannot start multiple streams");f.f=p;p=f.C.bind(f);f.f.Yf=p;return e?e(a).b:a}).then(function(p){if(f.b)throw new Ai("Cannot start multiple sessions");if(!f.f)throw new Ai("Media stream ended before session could start.");f.b=
f.xh(b,p);p.wb.vc=f.b.vc;p=f.g.Si.bind(f.g);f.b.G=p;nj(f.b);return f.b.start(f.f.f)}).then(function(){fj(c)&&!chrome.tabs.onUpdated.hasListener(f.ea)&&chrome.tabs.onUpdated.addListener(f.ea);return f.Tc(a,c,b)}).then(function(){k(a)}).catch(function(p){oj(f,p);return f.C().then(function(){m(p)})})});return xi(g)};h.Fj=function(a,c,b,d,e,f){this.R.info("Update mirroring on route "+a.id);return this.D?xi(pj(this,a,c,b,d,f)):wi(Error("Not initialized"))};
var pj=function(a,c,b,d,e,f){if(!a.b)return Promise.reject(new Ai("No session to update streams on",7));if(!a.b.Fn())return Promise.reject(new Ai("Session does not support updating stream",7));var g=!1;return new Promise(function(k,m){var p=mj(b,d,e);(new Ji(p)).start().then(function(u){a.f&&(a.f.Yf=null,a.f.stop(),a.dh());a.f=u;u=a.C.bind(a);a.f.Yf=u;g=!0;return f?f(c).b:c}).then(function(){if(!a.b)throw new Ai("Session ended while updating stream");if(!a.f)throw new Ai("Media stream ended before session could be updated.");
return a.b.Ln(a.f.f)}).then(a.Tc.bind(a,c,b,d)).then(function(){return k(c)}).catch(function(u){oj(a,u);if(g)return a.C().then(function(){m(u)});m(u)})})};
lj.prototype.Tc=function(a,c,b){var d=this;return new Promise(function(e,f){if(d.b){fj(c)?(qj(d.b,a.wb.tabId),d.eh()):ij(c)?(qj(d.b,a.wb.tabId),d.Yh()):d.ah();f=d.f;var g=a.sinkId;b.shouldCaptureAudio&&f.f&&!f.f.getAudioTracks().length&&d.g.bf(si(new ni(mi,"notification"),g));nj(d.b);e()}else f(new Ai("Session gone before executing post-startup steps",7))})};
var oj=function(a,c){c.reason=null!=c.reason?c.reason:9;a.R.error("Failed to start mirroring: "+c.message+(",  reason = "+c.reason+": "+c.stack));a.Zf(c.reason)};lj.prototype.m=function(){var a=this;return this.D?this.C().then(function(c){c&&a.bh();return c}):Promise.reject("Not initialized")};
lj.prototype.C=function(){var a=this;chrome.tabs.onUpdated.removeListener(this.ea);var c=this.f;this.f=null;c&&(c.Yf=null);var b=this.b;this.b=null;var d;b?d=this.wi(b).catch(function(e){return a.R.error("Error in before-cleanup steps",e)}).then(function(){return b.stop()}).catch(function(e){return a.R.error("Error stopping session",e)}).then(function(){a.g.Vh(b.f.id)}).catch(function(e){return a.R.error("Error in ended callbacks",e)}).then(function(){return!0}):d=Promise.resolve(!1);c&&(d=d.then(function(e){c.stop();
a.dh();return e}));return d};lj.prototype.wi=function(){return Promise.resolve()};lj.prototype.ma=function(a,c,b){ej(14);this.b&&rj(this.b,a,c,b)};var mj=function(a,c,b){if(fj(a))return new Fi("tab",c);if(gj(a))return new Fi("desktop",c);if(ij(a)){if(!b)throw new Ai("Missing offscreen tab presentation id");return new Fi("offscreen_tab",c,a,b)}throw new Ai("Source URN does not suggest a known capture type.");};h=lj.prototype;h.xh=function(){};h.eh=function(){};h.ah=function(){};h.Yh=function(){};
h.bh=function(){};h.Zf=function(){};h.dh=function(){};h.Dj=function(){return cb()};h.createMediaRouteController=function(){return cb()};var sj=function(a,c,b){this.f=a;this.h=c;this.b=void 0===b?null:b;this.g=null},tj=function(a){switch(a.f){case "mirror_tab":return a.b?"Casting tab ("+a.b+")":"Casting tab";case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return a.b?"Casting media ("+a.b+")":"Casting media";case "presentation":return"Casting "+(a.b||"site");default:return""}},uj=function(a){if(a.h)return"Casting active";switch(a.f){case "mirror_tab":return"Casting tab";
case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return"Casting media";case "presentation":return"Casting site";default:return""}};var vj=function(a){return(new Promise(function(c){chrome.tabs.get(a,c)})).then(function(c){if(!c)throw Error("No such tab "+a);return c})};var wj=function(a,c){this.f=a;this.G=void 0===c?null:c;c=null;var b=a.mediaSource;if(ij(b)){var d="presentation";c=(new URL(b)).origin}else fj(b)?d="mirror_tab":gj(b)&&(d="mirror_desktop");this.vc=new sj(d,a.offTheRecord,c);this.g=this.tabId=null;this.K=!1},qj=function(a,c){a.tabId!=c?(a.tabId=c,vj(c).then(function(b){a.g=b;nj(a)})):Promise.resolve()},rj=function(a,c,b,d){c==a.tabId&&("complete"==b.status||b.favIconUrl&&"complete"==d.status)&&(a.g=d,nj(a))},nj=function(a){if(a.g){a.vc.g=a.g.title;
a.vc.h=a.g.incognito;var c=new URL(a.g.url);"file:"==c.protocol?(a.vc.f="mirror_file",a.vc.b=null):(a.vc.f=a.K?"media_remoting":"mirror_tab",a.vc.b="https:"==c.protocol?c.origin.substr(8):c.origin)}a.f.description=tj(a.vc);a.G&&a.G(a.f,a.vc);a.nn()};h=wj.prototype;h.start=function(){};h.Fn=function(){return!1};h.Ln=function(){};h.stop=function(){return Promise.resolve()};h.nn=function(){};var Aj=function(){var a=this;this.f=1920;this.b=1080;this.maxWidth=this.f;this.maxHeight=this.b;this.minHeight=this.minWidth=180;this.senderSideLetterboxing=!1;this.minFrameRate=0;this.maxFrameRate=30;this.minVideoBitrate=300;this.maxVideoBitrate=5E3;this.audioBitrate=0;this.animatedLatencyMillis=this.minLatencyMillis=this.maxLatencyMillis=400;this.dscpEnabled=["Mac","Linux","ChromeOS"].includes(Ci())||Bi();this.enableLogging=!0;this.useTdls=!1;this.shouldCaptureAudio=this.shouldCaptureVideo=!0;var c=
window.localStorage?window.localStorage.getItem(xj):null;if(c)try{var b=JSON.parse(String(c));if(b instanceof Object)yj(this,b),gb("mr.mirror.Settings").H(function(){return"Initial mr.mirror.Settings overridden to: "+zj(a)});else throw Error("localStorage["+xj+"] does not parse as an Object: "+c);}catch(d){throw gb("mr.mirror.Settings").error(xj+' must be of the form \'{"maxWidth":640, "maxHeight":360}\'.',d),Error("Overrides not parseable.  See ERROR log for details.");}};
Aj.prototype.clone=function(){var a=new Aj;yj(a,this);return a};
var zj=function(a){return JSON.stringify(a,function(c,b){if(0==c.length||!c.endsWith("_"))return b})},yj=function(a,c){for(var b=l(Object.keys(c)),d=b.next();!d.done;d=b.next())d=d.value,d.endsWith("_")||typeof c[d]!==typeof a[d]||(a[d]=c[d])},Bj=function(a){var c=Math.round(screen.width*window.devicePixelRatio),b=Math.round(screen.height*window.devicePixelRatio);b>c&&(b=l([b,c]),c=b.next().value,b=b.next().value);a.maxHeight*c<a.maxWidth*b?(c=Math.min(a.maxWidth,c),c-=c%160,b=90*c/160):(b=Math.min(a.maxHeight,
b),b-=b%90,c=160*b/90);if(c<Math.max(160,a.minWidth)||b<Math.max(90,a.minHeight))c=Math.max(160,a.minWidth),b=Math.max(90,a.minHeight);a.maxWidth=c;a.maxHeight=b},xj="mr.mirror.Settings.Overrides";var Cj=function(a,c){this.type=a;this.data=c},Dj=function(a){a=JSON.parse(a);if(!a.type)throw Error("Invalid message");return new Cj(a.type,a.data)},Ej=function(a,c,b,d,e){this.description=a;this.settings=c||null;this.mediaConstraints=b||null;this.presentationUrl=d||null;this.presentationId=e||null};var Hj=function(a,c){this.l=gb("cv2.PeerConnection");this.G=Fj;this.ga=Gj(this,c);this.h=this.ga.createDataChannel(a,{reliable:!1});this.F=new Cb;this.m=!1;this.g=0;this.f=null;this.o=this.j=0;this.b=!1;this.C=function(){};this.w=function(){};this.D=function(){};this.s=function(){}},Ij=function(a,c){a.w=c},Jj=function(a,c){a.D=c},Kj=function(a,c){a.s=c},Lj=function(a,c){a.C=c},Mj=function(a,c){a.h.onmessage=function(b){c(b.data)}},Nj=function(a){var c={};c.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);
return c},Gj=function(a,c){var b=Nj(c);c=new webkitRTCPeerConnection(b);c.onicecandidate=a.J.bind(a);c.onicegatheringstatechange=a.T.bind(a);c.oniceconnectionstatechange=a.M.bind(a);a.l.info(function(){return"Created webkitRTCPeerConnnection with config: "+JSON.stringify(b)});return c};Hj.prototype.start=function(){this.b||(this.b=!0,Oj(this))};Hj.prototype.stop=function(){this.l.info("Stopping peer connection...");this.b&&(this.b=!1,"closed"!=this.ga.signalingState&&this.ga.close());this.ga=null};
var Oj=function(a){a.l.info("Sending offer to peer.");a.j=Date.now();a.ga.createOffer(a.K.bind(a),function(c){a.l.H("Error creating offer.",c)},a.G);a.F.b.then(function(c){a.C(c)})};Hj.prototype.K=function(a){var c=this;this.l.info(function(){return"Setting local description: "+JSON.stringify(a)});this.ga.setLocalDescription(a,function(){c.l.info("Local description set successfully")},function(b){c.l.H("Error setting local description.",b)})};
var Pj=function(a,c){nb(a.l,function(){return"<===: "+JSON.stringify(c)});var b=new RTCSessionDescription(c);a.l.info(function(){return"Setting remote description: "+JSON.stringify(b)});a.ga.setRemoteDescription(b,function(){a.l.info("Remote description set successfully.")},function(d){a.l.H("Error setting remote description.",d)})};
Hj.prototype.J=function(a){var c=this;a.candidate?(this.g++,this.o=Date.now(),1==this.g?this.f=setTimeout(function(){c.l.info("ICE candidate gathering timed out.");c.f=null;Qj(c)},5E3):this.m&&this.l.H("Received ICE candidate after resolving session description.")):(this.l.info("End of ICE candidates."),tb("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",Date.now()-this.j),Qj(this),0<this.g&&tb("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.o-this.j))};
Hj.prototype.T=function(){"completed"==this.ga.iceGatheringState&&Qj(this)};var Qj=function(a){clearTimeout(a.f);a.f=null;if(!a.m){a.l.info("Resolving sesion description after gathering "+a.g+" ICE candidates.");var c=a.ga.localDescription;a.F.resolve({type:c.type,sdp:c.sdp});a.m=!0}};
Hj.prototype.M=function(a){var c=this;if(this.ga){var b=this.ga.iceConnectionState;this.l.info("New ICE connection state: "+b+".");"connected"==b?this.w("iceconnected"):"completed"==b?this.w("icecompleted"):"failed"==b?(this.l.H(function(){return"Ice connection failed: "+JSON.stringify(a)}),this.D("icefailed")):"closed"==b?this.s("iceclosed"):"disconnected"==b&&(this.l.H("Ice connection state is bad."),this.b&&(this.l.info("Restarting ICE."),this.ga.createOffer(this.K.bind(this),function(d){c.l.H("Error creating new offer.",
d)},Rj)))}};var Fj={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},Rj={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};var Sj=function(){var a=window.crypto.getRandomValues(new Uint8Array(16));return Nb(a,function(c){c=c.toString(16);return 1<c.length?c:"0"+c}).join("")},Tj=function(a){for(var c=[],b=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?c[b++]=e:(2048>e?c[b++]=e>>6|192:(55296==(e&64512)&&d+1<a.length&&56320==(a.charCodeAt(d+1)&64512)?(e=65536+((e&1023)<<10)+(a.charCodeAt(++d)&1023),c[b++]=e>>18|240,c[b++]=e>>12&63|128):c[b++]=e>>12|224,c[b++]=e>>6&63|128),c[b++]=e&63|128)}return c},Uj=function(a){for(var c=
[],b=0,d=0;b<a.length;){var e=a[b++];if(128>e)c[d++]=String.fromCharCode(e);else if(191<e&&224>e){var f=a[b++];c[d++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){f=a[b++];var g=a[b++],k=a[b++];e=((e&7)<<18|(f&63)<<12|(g&63)<<6|k&63)-65536;c[d++]=String.fromCharCode(55296+(e>>10));c[d++]=String.fromCharCode(56320+(e&1023))}else f=a[b++],g=a[b++],c[d++]=String.fromCharCode((e&15)<<12|(f&63)<<6|g&63)}return c.join("")};var Vj={},Wj=null,Yj=function(a){var c;void 0===c&&(c=0);Xj();c=Vj[c];for(var b=[],d=0;d<a.length;d+=3){var e=a[d],f=d+1<a.length,g=f?a[d+1]:0,k=d+2<a.length,m=k?a[d+2]:0,p=e>>2;e=(e&3)<<4|g>>4;g=(g&15)<<2|m>>6;m&=63;k||(m=64,f||(g=64));b.push(c[p],c[e],c[g]||"",c[m]||"")}return b.join("")},ak=function(a){var c=a.length,b=3*c/4;b%3?b=Math.floor(b):-1!="=.".indexOf(a[c-1])&&(b=-1!="=.".indexOf(a[c-2])?b-2:b-1);var d=new Uint8Array(b),e=0;Zj(a,function(f){d[e++]=f});return d.subarray(0,e)},Zj=function(a,
c){function b(m){for(;d<a.length;){var p=a.charAt(d++),u=Wj[p];if(null!=u)return u;if(!ld(p))throw Error("Unknown base64 encoding at char: "+p);}return m}Xj();for(var d=0;;){var e=b(-1),f=b(0),g=b(64),k=b(64);if(64===k&&-1===e)break;c(e<<2|f>>4);64!=g&&(c(f<<4&240|g>>2),64!=k&&c(g<<6&192|k))}},Xj=function(){if(!Wj){Wj={};for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=["+/=","+/","-_=","-_.","-_"],b=0;5>b;b++){var d=a.concat(c[b].split(""));Vj[b]=d;for(var e=
0;e<d.length;e++){var f=d[e];void 0===Wj[f]&&(Wj[f]=e)}}}};var bk=0,ck=0,dk=function(a){var c=0>a;a=Math.abs(a);var b=a>>>0;a=Math.floor((a-b)/4294967296);a>>>=0;c&&(a=~a>>>0,b=(~b>>>0)+1,4294967295<b&&(b=0,a++,4294967295<a&&(a=0)));bk=b;ck=a},ek=function(a){var c=0>a?1:0;a=c?-a:a;if(0===a)0<1/a?bk=ck=0:(ck=0,bk=2147483648);else if(isNaN(a))ck=0,bk=2147483647;else if(3.4028234663852886E38<a)ck=0,bk=(c<<31|2139095040)>>>0;else if(1.1754943508222875E-38>a)a=Math.round(a/Math.pow(2,-149)),ck=0,bk=(c<<31|a)>>>0;else{var b=Math.floor(Math.log(a)/Math.LN2);a*=
Math.pow(2,-b);a=Math.round(8388608*a)&8388607;ck=0;bk=(c<<31|b+127<<23|a)>>>0}},fk=function(a,c){return 4294967296*c+(a>>>0)},gk=function(a,c){var b=c&2147483648;b&&(a=~a+1>>>0,c=~c>>>0,0==a&&(c=c+1>>>0));a=fk(a,c);return b?-a:a},hk=function(a,c){function b(e,f){e=e?String(e):"";return f?"0000000".slice(e.length)+e:e}if(2097151>=c)return""+(4294967296*c+a);var d=(a>>>24|c<<8)>>>0&16777215;c=c>>16&65535;a=(a&16777215)+6777216*d+6710656*c;d+=8147497*c;c*=2;1E7<=a&&(d+=Math.floor(a/1E7),a%=1E7);1E7<=
d&&(c+=Math.floor(d/1E7),d%=1E7);return b(c,0)+b(d,c)+b(a,1)},ik=function(a,c){var b=c&2147483648;b&&(a=~a+1>>>0,c=~c+(0==a?1:0)>>>0);a=hk(a,c);return b?"-"+a:a},jk=function(a){if(a.constructor===Uint8Array)return a;if(a.constructor===ArrayBuffer)return new Uint8Array(a);if(a.constructor===Array)return new Uint8Array(a);if(a.constructor===String)return ak(a);Gb("Type not convertible to Uint8Array.");return new Uint8Array(0)};var lk=function(a,c,b){this.f=null;this.b=this.g=this.j=0;this.m=!1;a&&kk(this,a,c,b)},mk=[],nk=function(a,c,b){if(mk.length){var d=mk.pop();a&&kk(d,a,c,b);return d}return new lk(a,c,b)};lk.prototype.clone=function(){return nk(this.f,this.j,this.g-this.j)};lk.prototype.clear=function(){this.f=null;this.b=this.g=this.j=0;this.m=!1};var kk=function(a,c,b,d){a.f=jk(c);a.j=Ia(b)?b:0;a.g=Ia(d)?a.j+d:a.f.length;a.b=a.j};lk.prototype.reset=function(){this.b=this.j};
var ok=function(a,c){for(var b=128,d=0,e=0,f=0;4>f&&128<=b;f++)b=a.f[a.b++],d|=(b&127)<<7*f;128<=b&&(b=a.f[a.b++],d|=(b&127)<<28,e|=(b&127)>>4);if(128<=b)for(f=0;5>f&&128<=b;f++)b=a.f[a.b++],e|=(b&127)<<7*f+3;if(128>b)return c(d>>>0,e>>>0);Gb("Failed to read varint, encoding is invalid.");a.m=!0};
lk.prototype.h=function(){var a=this.f;var c=a[this.b+0];var b=c&127;if(128>c)return this.b+=1,b;c=a[this.b+1];b|=(c&127)<<7;if(128>c)return this.b+=2,b;c=a[this.b+2];b|=(c&127)<<14;if(128>c)return this.b+=3,b;c=a[this.b+3];b|=(c&127)<<21;if(128>c)return this.b+=4,b;c=a[this.b+4];b|=(c&15)<<28;if(128>c)return this.b+=5,b>>>0;this.b+=5;128<=a[this.b++]&&128<=a[this.b++]&&128<=a[this.b++]&&128<=a[this.b++]&&this.b++;return b};lk.prototype.w=lk.prototype.h;
var pk=function(a){var c=a.f[a.b+0];var b=a.f[a.b+1];var d=a.f[a.b+2],e=a.f[a.b+3];a.b+=4;b=(c<<0|b<<8|d<<16|e<<24)>>>0;a=2*(b>>31)+1;c=b>>>23&255;b&=8388607;return 255==c?b?NaN:Infinity*a:0==c?a*Math.pow(2,-149)*b:a*Math.pow(2,c-150)*(b+Math.pow(2,23))};lk.prototype.o=function(){return this.w()};var qk=function(a){this.b=nk(a,void 0,void 0);this.w=this.b.b;this.h=this.f=-1;this.j=!1},rk=function(a){return 4==a.h};qk.prototype.reset=function(){this.b.reset();this.h=this.f=-1};
var sk=function(a){var c=a.b;if(c.b==c.g)return!1;(c=a.j)||(c=a.b,c=c.m||0>c.b||c.b>c.g);if(c)return Gb("Decoder hit an error"),!1;a.w=a.b.b;var b=a.b.h();c=b>>>3;b&=7;if(0!=b&&5!=b&&1!=b&&2!=b&&3!=b&&4!=b)return Gb("Invalid wire type: %s (at position %s)",b,a.w),a.j=!0,!1;a.f=c;a.h=b;return!0},tk=function(a){switch(a.h){case 0:if(0!=a.h)Gb("Invalid wire type for skipVarintField"),tk(a);else{for(a=a.b;a.f[a.b]&128;)a.b++;a.b++}break;case 1:1!=a.h?(Gb("Invalid wire type for skipFixed64Field"),tk(a)):
(a=a.b,a.b+=8);break;case 2:if(2!=a.h)Gb("Invalid wire type for skipDelimitedField"),tk(a);else{var c=a.b.h();a=a.b;a.b+=c}break;case 5:5!=a.h?(Gb("Invalid wire type for skipFixed32Field"),tk(a)):(a=a.b,a.b+=4);break;case 3:c=a.f;do{if(!sk(a)){Gb("Unmatched start-group tag: stream EOF");a.j=!0;break}if(4==a.h){a.f!=c&&(Gb("Unmatched end-group tag"),a.j=!0);break}tk(a)}while(1);break;default:Gb("Invalid wire encoding for field.")}};
qk.prototype.g=function(a,c){var b=this.b.g,d=this.b.h();d=this.b.b+d;this.b.g=d;c(a,this);this.b.b=d;this.b.g=b};
var uk=function(a){return!!a.b.h()},vk=function(a){return ok(a.b,gk)},wk=function(a){var c=a.b.h();a=a.b;var b=a.f,d=a.b,e=d+c,f=[];for(c="";d<e;){var g=b[d++];if(128>g)f.push(g);else if(192>g)continue;else if(224>g){var k=b[d++];f.push((g&31)<<6|k&63)}else if(240>g){k=b[d++];var m=b[d++];f.push((g&15)<<12|(k&63)<<6|m&63)}else if(248>g){k=b[d++];m=b[d++];var p=b[d++];g=(g&7)<<18|(k&63)<<12|(m&63)<<6|p&63;g-=65536;f.push((g>>10&1023)+55296,(g&1023)+56320)}8192<=f.length&&(c+=String.fromCharCode.apply(null,
f),f.length=0)}if(8192>=f.length)f=String.fromCharCode.apply(null,f);else{b="";for(e=0;e<f.length;e+=8192)b+=String.fromCharCode.apply(null,gc(f,e,e+8192));f=b}a.b=d;return c+f},xk=function(a,c){var b=a.b.h();b=a.b.b+b;for(var d=[];a.b.b<b;)d.push(c.call(a.b));return d};var yk=function(a,c){this.b=a;this.f=c},zk=function(a){return new yk((a.b>>>1|(a.f&1)<<31)>>>0,a.f>>>1>>>0)},Ak=function(a){return new yk(a.b<<1>>>0,(a.f<<1|a.b>>>31)>>>0)};yk.prototype.add=function(a){return new yk((this.b+a.b&4294967295)>>>0>>>0,((this.f+a.f&4294967295)>>>0)+(4294967296<=this.b+a.b?1:0)>>>0)};yk.prototype.sub=function(a){return new yk((this.b-a.b&4294967295)>>>0>>>0,((this.f-a.f&4294967295)>>>0)-(0>this.b-a.b?1:0)>>>0)};
var Bk=function(a){var c=a&65535,b=a>>>16;a=10*c+65536*(0*c&65535)+65536*(10*b&65535);for(c=0*b+(0*c>>>16)+(10*b>>>16);4294967296<=a;)a-=4294967296,c+=1;return new yk(a>>>0,c>>>0)};
yk.prototype.toString=function(){for(var a="",c=this;0!=c.b||0!=c.f;){var b=new yk(0,0);c=new yk(c.b,c.f);for(var d=new yk(10,0),e=new yk(1,0);!(d.f&2147483648);)d=Ak(d),e=Ak(e);for(;0!=e.b||0!=e.f;)0>=(d.f<c.f||d.f==c.f&&d.b<c.b?-1:d.f==c.f&&d.b==c.b?0:1)&&(b=b.add(e),c=c.sub(d)),d=zk(d),e=zk(e);b=[b,c];c=b[0];a=b[1].b+a}""==a&&(a="0");return a};
var Ck=function(a){for(var c=new yk(0,0),b=new yk(0,0),d=0;d<a.length;d++){if("0">a[d]||"9"<a[d])return null;b.b=parseInt(a[d],10);var e=Bk(c.b);c=Bk(c.f);c.f=c.b;c.b=0;c=e.add(c).add(b)}return c};yk.prototype.clone=function(){return new yk(this.b,this.f)};var Dk=function(a,c){this.b=a;this.f=c};Dk.prototype.add=function(a){return new Dk((this.b+a.b&4294967295)>>>0>>>0,((this.f+a.f&4294967295)>>>0)+(4294967296<=this.b+a.b?1:0)>>>0)};
Dk.prototype.sub=function(a){return new Dk((this.b-a.b&4294967295)>>>0>>>0,((this.f-a.f&4294967295)>>>0)-(0>this.b-a.b?1:0)>>>0)};Dk.prototype.clone=function(){return new Dk(this.b,this.f)};Dk.prototype.toString=function(){var a=0!=(this.f&2147483648),c=new yk(this.b,this.f);a&&(c=(new yk(0,0)).sub(c));return(a?"-":"")+c.toString()};var Ek=function(){this.b=[]};Ek.prototype.length=function(){return this.b.length};Ek.prototype.end=function(){var a=this.b;this.b=[];return a};
var Fk=function(a,c,b){for(;0<b||127<c;)a.b.push(c&127|128),c=(c>>>7|b<<25)>>>0,b>>>=7;a.b.push(c)},Gk=function(a,c){for(;127<c;)a.b.push(c&127|128),c>>>=7;a.b.push(c)},Hk=function(a,c){if(0<=c)Gk(a,c);else{for(var b=0;9>b;b++)a.b.push(c&127|128),c>>=7;a.b.push(1)}},Ik=function(a,c){a.b.push(c>>>0&255);a.b.push(c>>>8&255);a.b.push(c>>>16&255);a.b.push(c>>>24&255)};var C=function(){this.w=[];this.j=0;this.g=new Ek;this.m=[]},Kk=function(a,c){Jk(a,c,2);c=a.g.end();a.w.push(c);a.j+=c.length;c.push(a.j);return c},Lk=function(a,c){var b=c.pop();for(b=a.j+a.g.length()-b;127<b;)c.push(b&127|128),b>>>=7,a.j++;c.push(b);a.j++};C.prototype.reset=function(){this.w=[];this.g.end();this.j=0;this.m=[]};
var D=function(a){for(var c=new Uint8Array(a.j+a.g.length()),b=a.w,d=b.length,e=0,f=0;f<d;f++){var g=b[f];c.set(g,e);e+=g.length}b=a.g.end();c.set(b,e);a.w=[c];return c},Jk=function(a,c,b){Gk(a.g,8*c+b)};C.prototype.f=function(a,c){null!=c&&null!=c&&(Jk(this,a,0),Hk(this.g,c))};
var G=function(a,c,b){null!=b&&null!=b&&(Jk(a,c,0),a=a.g,dk(b),Fk(a,bk,ck))},Mk=function(a,c,b){if(null!=b){var d=b;(b=0<d.length&&"-"==d[0])&&(d=d.substring(1));d=Ck(d);null===d?b=null:(b&&(d=(new yk(0,0)).sub(d)),b=new Dk(d.b,d.f));Jk(a,c,0);Fk(a.g,b.b,b.f)}};C.prototype.h=function(a,c){null!=c&&null!=c&&(Jk(this,a,0),Gk(this.g,c))};
var Nk=function(a,c,b){null!=b&&null!=b&&(Jk(a,c,0),a=a.g,dk(b),Fk(a,bk,ck))},Ok=function(a,c,b){null!=b&&(b=Ck(b),Jk(a,c,0),Fk(a.g,b.b,b.f))},Pk=function(a,c,b){null!=b&&(Jk(a,c,5),Ik(a.g,b))},Qk=function(a,c,b){null!=b&&(Jk(a,c,5),a=a.g,ek(b),Ik(a,bk))},Rk=function(a,c,b){if(null!=b){Jk(a,c,1);a=a.g;var d=b;d=(b=0>d?1:0)?-d:d;if(0===d)ck=0<1/d?0:2147483648,bk=0;else if(isNaN(d))ck=2147483647,bk=4294967295;else if(1.7976931348623157E308<d)ck=(b<<31|2146435072)>>>0,bk=0;else if(2.2250738585072014E-308>
d)d/=Math.pow(2,-1074),ck=(b<<31|d/4294967296)>>>0,bk=d>>>0;else{var e=d;c=0;if(2<=e)for(;2<=e&&1023>c;)c++,e/=2;else for(;1>e&&-1022<c;)e*=2,c--;d*=Math.pow(2,-c);ck=(b<<31|c+1023<<20|1048576*d&1048575)>>>0;bk=4503599627370496*d>>>0}Ik(a,bk);Ik(a,ck)}},H=function(a,c,b){null!=b&&(Jk(a,c,0),a.g.b.push(b?1:0))},I=function(a,c,b){null!=b&&(Jk(a,c,0),Hk(a.g,b))},K=function(a,c,b){if(null!=b){c=Kk(a,c);for(var d=a.g,e=0;e<b.length;e++){var f=b.charCodeAt(e);if(128>f)d.b.push(f);else if(2048>f)d.b.push(f>>
6|192),d.b.push(f&63|128);else if(65536>f)if(55296<=f&&56319>=f&&e+1<b.length){var g=b.charCodeAt(e+1);56320<=g&&57343>=g&&(f=1024*(f-55296)+g-56320+65536,d.b.push(f>>18|240),d.b.push(f>>12&63|128),d.b.push(f>>6&63|128),d.b.push(f&63|128),e++)}else d.b.push(f>>12|224),d.b.push(f>>6&63|128),d.b.push(f&63|128)}Lk(a,c)}},Sk=function(a,c,b){null!=b&&(b=jk(b),Jk(a,c,2),Gk(a.g,b.length),c=a.g.end(),a.w.push(c),a.w.push(b),a.j+=c.length+b.length)};
C.prototype.b=function(a,c,b){null!=c&&(a=Kk(this,a),b(c,this),Lk(this,a))};
var Tk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++){var e=a,f=b[d];null!=f&&(Jk(e,c,0),Hk(e.g,f))}},Uk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++){var e=a,f=b[d];null!=f&&(Jk(e,c,0),e=e.g,dk(f),Fk(e,bk,ck))}},Vk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++){var e=a,f=b[d];null!=f&&(Jk(e,c,0),Gk(e.g,f))}},Wk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++)Pk(a,c,b[d])},Xk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++)I(a,c,b[d])},Yk=function(a,c,b){if(null!=
b)for(var d=0;d<b.length;d++)K(a,c,b[d])},Zk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++)Sk(a,c,b[d])},L=function(a,c,b,d){if(null!=b)for(var e=0;e<b.length;e++){var f=Kk(a,c);d(b[e],a);Lk(a,f)}},$k=function(a,c,b,d){if(null!=b)for(var e=0;e<b.length;e++)Jk(a,c,3),d(b[e],a),Jk(a,c,4)},al=function(a,c,b){if(null!=b&&b.length){c=Kk(a,c);for(var d=0;d<b.length;d++)Hk(a.g,b[d]);Lk(a,c)}},bl=function(a,c,b){if(null!=b&&b.length)for(Jk(a,c,2),Gk(a.g,4*b.length),c=0;c<b.length;c++){var d=a.g;ek(b[c]);
Ik(d,bk)}},cl=function(a,c,b){if(null!=b&&b.length){c=Kk(a,c);for(var d=0;d<b.length;d++)Hk(a.g,b[d]);Lk(a,c)}};var el=function(a){this.f=a;this.b={};this.g=!0;if(0<this.f.length){for(a=0;a<this.f.length;a++){var c=this.f[a],b=c[0];this.b[b.toString()]=new dl(b,c[1])}this.g=!0}};el.prototype.nc=function(){var a;if(!this.g){this.f.length=0;var c=fl(this);c.sort();for(var b=0;b<c.length;b++){var d=this.b[c[b]];(a=d.b)&&a.nc();this.f.push([d.key,d.value])}this.g=!0}return this.f};var gl=function(a){this.b=0;this.f=a};
gl.prototype.next=function(){return this.b<this.f.length?{done:!1,value:this.f[this.b++]}:{done:!0,value:void 0}};"undefined"!=typeof Symbol&&(gl.prototype[Symbol.iterator]=function(){return this});h=el.prototype;h.clear=function(){this.b={};this.g=!1};h.entries=function(){var a=[],c=fl(this);c.sort();for(var b=0;b<c.length;b++){var d=this.b[c[b]];a.push([d.key,d.value])}return new gl(a)};h.keys=function(){var a=[],c=fl(this);c.sort();for(var b=0;b<c.length;b++)a.push(this.b[c[b]].key);return new gl(a)};
h.values=function(){var a=[],c=fl(this);c.sort();for(var b=0;b<c.length;b++)a.push(this.b[c[b]].value);return new gl(a)};h.forEach=function(a,c){var b=fl(this);b.sort();for(var d=0;d<b.length;d++){var e=this.b[b[d]];a.call(c,e.value,e.key,this)}};h.set=function(a,c){var b=new dl(a);b.value=c;this.b[a.toString()]=b;this.g=!1;return this};h.get=function(a){if(a=this.b[a.toString()])return a.value};h.has=function(a){return a.toString()in this.b};
h.u=function(a,c,b,d){var e=fl(this);e.sort();for(var f=0;f<e.length;f++){var g=this.b[e[f]];c.m.push(Kk(c,a));b.call(c,1,g.key);d.call(c,2,g.value);Lk(c,c.m.pop())}};var fl=function(a){a=a.b;var c=[],b;for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c},dl=function(a,c){this.key=a;this.value=c;this.b=void 0};var M=function(){},hl="function"==typeof Uint8Array,N=function(a,c,b,d,e,f){a.b=null;c||(c=b?[b]:[]);a.uf=b?String(b):void 0;a.j=0===b?-1:0;a.f=c;a:{b=a.f.length;c=-1;if(b&&(c=b-1,b=a.f[c],!(null===b||"object"!=typeof b||Ta(b)||hl&&b instanceof Uint8Array))){a.m=c-a.j;a.g=b;break a}-1<d?(a.m=Math.max(d,c+1-a.j),a.g=null):a.m=Number.MAX_VALUE}a.s={};if(e)for(d=0;d<e.length;d++)c=e[d],c<a.m?(c+=a.j,a.f[c]=a.f[c]||il):(jl(a),a.g[c]=a.g[c]||il);if(f&&f.length)for(d=0;d<f.length;d++)kl(a,f[d])},il=Object.freeze?
Object.freeze([]):[],jl=function(a){var c=a.m+a.j;a.f[c]||(a.g=a.f[c]={})},ll=function(a,c,b,d){for(var e in b){var f=b[e],g=f.sq;if(!f.yi)throw Error("Message extension present that was generated without binary serialization support");var k=d.call(a,g);if(null!=k)if(g.Fd)if(f.xl)f.yi.call(c,g.Hl,k,f.xl);else throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");else f.yi.call(c,g.Hl,k)}},O=function(a,c){if(c<a.m){c+=
a.j;var b=a.f[c];return b===il?a.f[c]=[]:b}if(a.g)return b=a.g[c],b===il?a.g[c]=[]:b},ml=function(a,c){a=O(a,c);return null==a?a:+a},nl=function(a,c){a=O(a,c);return null==a?a:!!a},ol=function(a,c){var b=O(a,c);a.s||(a.s={});if(!a.s[c]){for(var d=0;d<b.length;d++)b[d]=+b[d];a.s[c]=!0}return b},pl=function(a){if(null==a||a instanceof Uint8Array)return a;if(Ja(a))return ak(a);Gb("Cannot coerce to Uint8Array: "+Ra(a));return null},rl=function(a){ql(a);return!a.length||a[0]instanceof Uint8Array?a:Nb(a,
pl)},ql=function(a){if(a&&1<a.length){var c=Ra(a[0]);Kb(a,function(b){Ra(b)!=c&&Gb("Inconsistent type in JSPB repeated field array. Got "+Ra(b)+" expected "+c)})}},P=function(a,c,b){a=O(a,c);return null==a?b:a},sl=function(a,c,b){a=nl(a,c);return null==a?b:a},tl=function(a,c){a=ml(a,c);return null==a?0:a},Q=function(a,c,b){c<a.m?a.f[c+a.j]=b:(jl(a),a.g[c]=b);return a},vl=function(a,c,b){return ul(a,c,b,"")},wl=function(a,c,b){ul(a,c,b,0)},ul=function(a,c,b,d){b!==d?Q(a,c,b):a.f[c+a.j]=null;return a},
kl=function(a,c){for(var b,d,e=0;e<c.length;e++){var f=c[e],g=O(a,f);null!=g&&(b=f,d=g,Q(a,f,void 0))}return b?(Q(a,b,d),b):0},S=function(a,c,b,d){a.b||(a.b={});if(!a.b[b]){var e=O(a,b);if(d||e)a.b[b]=new c(e)}return a.b[b]},T=function(a,c,b){xl(a,c,b);c=a.b[b];c==il&&(c=a.b[b]=[]);return c},xl=function(a,c,b){a.b||(a.b={});if(!a.b[b]){for(var d=O(a,b),e=[],f=0;f<d.length;f++)e[f]=new c(d[f]);a.b[b]=e}},V=function(a,c,b){a.b||(a.b={});var d=b?b.nc():b;a.b[c]=b;return Q(a,c,d)},zl=function(a,c,b){var d=
yl[0];a.b||(a.b={});var e=b?b.nc():b;a.b[c]=b;(b=kl(a,d))&&b!==c&&void 0!==e&&(a.b&&b in a.b&&(a.b[b]=void 0),Q(a,b,void 0));Q(a,c,e)},Al=function(a,c,b){a.b||(a.b={});b=b||[];for(var d=[],e=0;e<b.length;e++)d[e]=b[e].nc();a.b[c]=b;return Q(a,c,d)},Bl=function(a,c,b,d,e){xl(a,d,c);var f=a.b[c];f||(f=a.b[c]=[]);b=b?b:new d;a=O(a,c);void 0!=e?(f.splice(e,0,b),a.splice(e,0,b.nc())):(f.push(b),a.push(b.nc()));return b},Cl=function(a){if(a.b)for(var c in a.b){var b=a.b[c];if(Ta(b))for(var d=0;d<b.length;d++)b[d]&&
b[d].nc();else b&&b.nc()}};M.prototype.nc=function(){Cl(this);return this.f};M.prototype.va=hl?function(){var a=Uint8Array.prototype.toJSON;Uint8Array.prototype.toJSON=function(){return Yj(this)};try{return JSON.stringify(this.f&&this.nc(),Dl)}finally{Uint8Array.prototype.toJSON=a}}:function(){return JSON.stringify(this.f&&this.nc(),Dl)};var Dl=function(a,c){return r(c)&&(isNaN(c)||Infinity===c||-Infinity===c)?String(c):c};M.prototype.toString=function(){Cl(this);return this.f.toString()};
M.prototype.w=function(a){if(this.g)return this.b||(this.b={}),a.Fd?(!this.b[175237375]&&this.g[175237375]&&(this.b[175237375]=new a.Fd(this.g[175237375])),this.b[175237375]):this.g[175237375]};
var Fl=function(a,c){a=a||{};c=c||{};var b={},d;for(d in a)b[d]=0;for(d in c)b[d]=0;for(d in b)if(!El(a[d],c[d]))return!1;return!0},El=function(a,c){if(a==c)return!0;if(!Wa(a)||!Wa(c))return r(a)&&isNaN(a)||r(c)&&isNaN(c)?String(a)==String(c):!1;if(a.constructor!=c.constructor)return!1;if(hl&&a.constructor===Uint8Array){if(a.length!=c.length)return!1;for(var b=0;b<a.length;b++)if(a[b]!=c[b])return!1;return!0}if(a.constructor===Array){var d=void 0,e=void 0,f=Math.max(a.length,c.length);for(b=0;b<f;b++){var g=
a[b],k=c[b];g&&g.constructor==Object&&(d=g,g=void 0);k&&k.constructor==Object&&(e=k,k=void 0);if(!El(g,k))return!1}return d||e?(d=d||{},e=e||{},Fl(d,e)):!0}if(a.constructor===Object)return Fl(a,c);throw Error("Invalid type in JSPB array");};M.prototype.clone=function(){return Gl(this)};
var Gl=function(a){return new a.constructor(Hl(a.nc()))},Hl=function(a){if(Ta(a)){for(var c=Array(a.length),b=0;b<a.length;b++){var d=a[b];null!=d&&(c[b]="object"==typeof d?Hl(d):d)}return c}if(hl&&a instanceof Uint8Array)return new Uint8Array(a);c={};for(b in a)d=a[b],null!=d&&(c[b]="object"==typeof d?Hl(d):d);return c};var Il=function(a){N(this,a,0,-1,null,null)};x(Il,M);var Jl=function(a){N(this,a,0,-1,null,null)};x(Jl,M);var Ll=function(a,c){for(;sk(c)&&!rk(c);)switch(c.f){case 1:var b=ok(c.b,gk);Q(a,1,b);break;case 2:b=wk(c);Q(a,2,b);break;case 3:b=new Jl;c.g(b,Kl);V(a,3,b);break;default:tk(c)}return a};Il.prototype.u=function(){var a=new C;Ml(this,a);return D(a)};
var Ml=function(a,c){var b=O(a,1);null!=b&&G(c,1,b);b=O(a,2);null!=b&&K(c,2,b);b=S(a,Jl,3);null!=b&&c.b(3,b,Nl)},Kl=function(a,c){for(;sk(c)&&!rk(c);)switch(c.f){case 1:var b=wk(c);Q(a,1,b);break;case 2:b=ok(c.b,gk);Q(a,2,b);break;default:tk(c)}return a};Jl.prototype.u=function(){var a=new C;Nl(this,a);return D(a)};var Nl=function(a,c){var b=O(a,1);null!=b&&K(c,1,b);b=O(a,2);null!=b&&G(c,2,b)};Il.prototype.Lb=function(){return O(this,1)};var Ol=function(a,c){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=c;this.logRecord=this.deviceJustSetUp=void 0};w("castApp.eventPage.Message",Ol);var Pl=function(a,c,b){this.ipAddress=a;this.appId=c;this.sessionId=b};Ol.DeviceData=Pl;Ol.DeviceJustSetUp=function(a,c,b,d){this.ipAddress=a;this.name=c;this.udn=b;this.modelName=d};Ol.DeviceCapabilities=function(){};
Ol.LogRecord=function(a,c,b,d){this.levelValue=a;this.msg=c;this.loggerName=b;this.time=d};var Ql=function(a,c){this.type=a;this.entryPoint=c};w("castApp.frontEnd.ExtensionMessage",Ql);var Rl=function(a){return"urn:x-cast:com.google.cast."+a},Sl=Rl("tp.connection"),Tl=Rl("receiver"),Ul=Rl("remoting"),Vl=Rl("media"),Wl=Rl("webrtc"),Xl=Rl("broadcast"),Yl=Oc({Xz:Sl,Yz:Rl("tp.heartbeat"),Hy:Tl,My:Ul,Pw:Vl,Sw:Rl("media.universalRemote.optIn"),FA:Wl,fu:Xl});var Zl=function(a){return"available"==a||"available_rescan"==a};var $l=function(a,c,b,d,e){this.id=a;this.friendlyName=c;this.iconType=b||"generic";this.description=void 0===d?null:d;this.domain=void 0===e?null:e};var am=window.localStorage,bm=0,dm=function(a){return(a=window.localStorage.getItem(cm(a,!1)))?JSON.parse(a):null},em=function(a){return(a=window.localStorage.getItem(cm(a,!0)))?JSON.parse(a):null},gm=function(a){if(fm.has(a.Ca()))throw Error("Duplicate instance name "+a.Ca());fm.set(a.Ca(),a);a.ob()},mm=function(a){for(var c=0,b=l(Object.keys(am)),d=b.next();!d.done;d=b.next()){d=d.value;var e=d.length+window.localStorage.getItem(d).length;d.startsWith("mr.")?bm+=e:c+=e}hm=a;(window.localStorage.getItem("version")&&
window.localStorage.getItem("version")!==chrome.runtime.getManifest().version||im(a))&&jm();km.info("initialize: "+bm+" chars used, "+c+" other chars");chrome.runtime.onSuspend.addListener(lm)},hm=null,km=gb("mr.PersistentDataManager"),fm=new Map,cm=function(a,c){return"mr."+(c?"persistent.":"temp.")+a.Ca()},im=function(a){return!!window.localStorage.getItem("mrInstanceId")&&window.localStorage.getItem("mrInstanceId")!==a},lm=function(){km.info("onSuspend");nm("version",chrome.runtime.getManifest().version);
hm&&nm("mrInstanceId",hm);for(var a=fm.get("LogManager"),c=l(fm),b=c.next();!b.done;b=c.next())b=l(b.value),b.next(),b=b.next().value,b!=a&&om(b);a&&om(a)},om=function(a){try{var c=a.qb();c&&void 0!=c[0]&&nm(cm(a,!1),JSON.stringify(c[0]));c&&void 0!=c[1]&&nm(cm(a,!0),JSON.stringify(c[1]))}catch(b){km.error("Error while saving data for "+a.Ca()+": "+b.message)}},nm=function(a,c){var b=window.localStorage.getItem(a);b=null!=b?c.length-b.length:a.length+c.length;52E5<bm+b&&(km.H("Unable to write "+b+
" chars"),jm());if(52E5<bm+b)throw km.error("Unable to write "+b+" chars after clearing temporary"),Error("Setting the value of '"+a+"' would exceed the quota, according to accounting.");try{window.localStorage.setItem(a,c)}catch(d){throw Error("Setting the value of '"+a+"' would exceed the quota, according to the browser.");}bm+=b},pm=function(a){a=0==a.size%2?new Blob([a,new Uint8Array([0,0])]):new Blob([a,new Uint8Array([1])]);return new Promise(function(c,b){var d=new FileReader;d.onloadend=function(){if(d.error)b(d.error);
else try{for(var e=d.result,f=[],g=0,k=e.byteLength;g<k;g+=8192)f.push(String.fromCharCode.apply(null,new Uint16Array(e,g,Math.min(k-g,8192)/2)));nm("mr.temp.mirror.cast.Service.eventsBlob",f.join(""));c()}catch(m){b(m)}};d.readAsArrayBuffer(a)})},jm=function(){for(var a=l(Object.keys(am)),c=a.next();!c.done;c=a.next())c=c.value,c.startsWith("mr.temp.")&&(bm-=c.length+window.localStorage.getItem(c).length,delete window.localStorage[c]);km.info("removeTemporary_: "+bm+" chars used")};var qm=(new Map).set("+","-").set("/","_").set("=","."),rm=(new Map).set("-","+").set("_","/").set(".","="),sm=function(a){return atob(a.replace(/[-_.]/g,function(c){return rm.get(c)}))},tm=function(a){return btoa(String.fromCharCode.apply(String,n(a))).replace(/[+/=]/g,function(c){return qm.get(c)})};var um=function(){this.b=[];this.j=[];this.w=[];this.g=[];this.g[0]=128;for(var a=1;64>a;++a)this.g[a]=0;this.h=this.f=0;this.reset()};um.prototype.reset=function(){this.b[0]=1732584193;this.b[1]=4023233417;this.b[2]=2562383102;this.b[3]=271733878;this.b[4]=3285377520;this.h=this.f=0};
var vm=function(a,c,b){b=void 0===b?0:b;var d=a.w;if("string"===typeof c)for(var e=0;16>e;e++)d[e]=c.charCodeAt(b)<<24|c.charCodeAt(b+1)<<16|c.charCodeAt(b+2)<<8|c.charCodeAt(b+3),b+=4;else for(e=0;16>e;e++)d[e]=c[b]<<24|c[b+1]<<16|c[b+2]<<8|c[b+3],b+=4;for(c=16;80>c;c++)b=d[c-3]^d[c-8]^d[c-14]^d[c-16],d[c]=(b<<1|b>>>31)&4294967295;c=a.b[0];b=a.b[1];e=a.b[2];for(var f=a.b[3],g=a.b[4],k,m,p=0;80>p;p++)40>p?20>p?(k=f^b&(e^f),m=1518500249):(k=b^e^f,m=1859775393):60>p?(k=b&e|f&(b|e),m=2400959708):(k=
b^e^f,m=3395469782),k=(c<<5|c>>>27)+k+g+m+d[p]&4294967295,g=f,f=e,e=(b<<30|b>>>2)&4294967295,b=c,c=k;a.b[0]=a.b[0]+c&4294967295;a.b[1]=a.b[1]+b&4294967295;a.b[2]=a.b[2]+e&4294967295;a.b[3]=a.b[3]+f&4294967295;a.b[4]=a.b[4]+g&4294967295};
um.prototype.update=function(a,c){c=void 0===c?a.length:c;for(var b=c-64,d=0,e=this.j,f=this.f;d<c;){if(0==f)for(;d<=b;)vm(this,a,d),d+=64;if("string"===typeof a)for(;d<c;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){vm(this,e);f=0;break}}else for(;d<c;)if(e[f]=a[d],++f,++d,64==f){vm(this,e);f=0;break}}this.f=f;this.h+=c};
um.prototype.digest=function(){var a=[],c=8*this.h;56>this.f?this.update(this.g,56-this.f):this.update(this.g,64-(this.f-56));for(var b=63;56<=b;b--)this.j[b]=c&255,c/=256;vm(this,this.j);for(b=c=0;5>b;b++)for(var d=24;0<=d;d-=8)a[c]=this.b[b]>>d&255,++c;return a};var wm=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)};var ym=function(){this.j=wm();this.f=new xm(null,null);this.b=new xm(null,null);this.w=[];this.g=this.h=0;gm(this)},Am=function(){zm||(zm=new ym);return zm},Bm=function(a,c){c=c.toLowerCase();var b=new um;b.update(c);b.update(a.j);return"r"+tm(b.digest())},Cm=function(){var a=Am();return a.f.model?a.f:a.b.model?a.b:new xm(null,null)};ym.prototype.Ca=function(){return"SinkUtils"};
ym.prototype.qb=function(){return[{recentLaunchedDevice:this.f,recentDiscoveredDevice:this.b},{receiverIdToken:this.j,fixedIpList:this.w.join(","),castControlPort:this.h,lastCloudSinkCheckTimeMillis:this.g}]};
ym.prototype.ob=function(){var a=dm(this);a&&(this.f=a.recentLaunchedDevice||new xm(null,null),this.b=a.recentDiscoveredDevice||new xm(null,null));if(a=em(this))this.j=a.receiverIdToken||wm(),this.w=a.fixedIpList&&a.fixedIpList.split(",")||[],this.h=a.castControlPort||0,this.g=a.lastCloudSinkCheckTimeMillis||0};var zm=null,xm=function(a,c){this.model=a;this.ip=c};var Dm=function(a,c){this.Bc=this.Af=this.Yd=this.Ka=this.oc=null;this.Dc=new $l(c,a);this.hc={};this.Kh={};this.He=!1};Dm.prototype.getId=function(){return this.Dc.id};Dm.prototype.update=function(a){if(this.getId()!=a.getId())return!1;var c=!1;this.Dc.friendlyName!=a.Dc.friendlyName&&(this.Dc.friendlyName=a.Dc.friendlyName,c=!0);this.Yd!=a.Yd&&(this.Yd=a.Yd,c=!0);this.Af!=a.Af&&(this.Af=a.Af,c=!0);this.oc!=a.oc&&(this.oc=a.oc,c=!0);this.Ka!=a.Ka&&(this.Ka=a.Ka,c=!0);return c};Dm.prototype.Yb=function(){return this.oc};
Dm.prototype.Fb=function(){return this.Ka};var Em=function(a,c){return a.hc[c]||"unknown"},Fm=function(a){var c=new Dm(a.Dc.friendlyName,"");c.Dc.id=a.Dc.id;c.oc=a.oc;c.Ka=a.Ka;c.Yd=a.Yd;c.Af=a.Af;c.Bc=a.Bc;c.hc=a.hc;c.Kh=a.Kh;c.He=a.He;return c};var Gm=function(a,c,b,d,e,f){this.f=new $l(a,c,d&1?"cast":d&32?"cast_audio_group":"cast_audio");this.Bc=b||null;this.b=d||null;this.oc=e||null;this.Ka=f||null;this.hc={};this.Di=!1};Gm.prototype.update=function(a,c,b,d){var e=!1;this.f.friendlyName!=a&&(this.f.friendlyName=a,e=!0);null!=c&&this.oc!=c&&(this.oc=c,e=!0);null!=b&&this.Ka!=b&&(this.Ka=b,e=!0);null!=d&&this.b!=d&&(this.b=d,e=!0);return e};Gm.prototype.getId=function(){return this.f.id};Gm.prototype.Yb=function(){return this.oc};
Gm.prototype.Fb=function(){return this.Ka};var Hm=function(a,c){return a.hc[c]||"unknown"};var Im="StopIteration"in Ha?Ha.StopIteration:{message:"StopIteration",stack:""},Jm=function(){};Jm.prototype.next=function(){throw Im;};Jm.prototype.Rb=function(){return this};
var Km=function(a){if(a instanceof Jm)return a;if("function"==typeof a.Rb)return a.Rb(!1);if(Ua(a)){var c=0,b=new Jm;b.next=function(){for(;;){if(c>=a.length)throw Im;if(c in a)return a[c++];c++}};return b}throw Error("Not implemented");},Lm=function(a,c,b){if(Ua(a))try{Kb(a,c,b)}catch(d){if(d!==Im)throw d;}else{a=Km(a);try{for(;;)c.call(b,a.next(),void 0,a)}catch(d){if(d!==Im)throw d;}}},Mm=function(a,c){a=Km(a);try{for(;!c.call(void 0,a.next(),void 0,a););}catch(b){if(b!==Im)throw b;}},Nm=function(a){if(Ua(a))return y(a);
a=Km(a);var c=[];Lm(a,function(b){c.push(b)});return c};var Pm=function(a,c){this.f={};this.b=[];this.h=this.g=0;var b=arguments.length;if(1<b){if(b%2)throw Error("Uneven number of arguments");for(var d=0;d<b;d+=2)this.set(arguments[d],arguments[d+1])}else a&&Om(this,a)};Pm.prototype.za=function(){return this.g};Pm.prototype.Ga=function(){Qm(this);for(var a=[],c=0;c<this.b.length;c++)a.push(this.f[this.b[c]]);return a};Pm.prototype.Jb=function(){Qm(this);return this.b.concat()};var Sm=function(a,c){return Rm(a.f,c)};
Pm.prototype.Ff=function(a){for(var c=0;c<this.b.length;c++){var b=this.b[c];if(Rm(this.f,b)&&this.f[b]==a)return!0}return!1};Pm.prototype.equals=function(a,c){if(this===a)return!0;if(this.g!=a.za())return!1;c=c||Tm;Qm(this);for(var b,d=0;b=this.b[d];d++)if(!c(this.get(b),a.get(b)))return!1;return!0};var Tm=function(a,c){return a===c};Pm.prototype.Ub=function(){return 0==this.g};Pm.prototype.clear=function(){this.f={};this.h=this.g=this.b.length=0};
Pm.prototype.remove=function(a){return Rm(this.f,a)?(delete this.f[a],this.g--,this.h++,this.b.length>2*this.g&&Qm(this),!0):!1};var Qm=function(a){if(a.g!=a.b.length){for(var c=0,b=0;c<a.b.length;){var d=a.b[c];Rm(a.f,d)&&(a.b[b++]=d);c++}a.b.length=b}if(a.g!=a.b.length){var e={};for(b=c=0;c<a.b.length;)d=a.b[c],Rm(e,d)||(a.b[b++]=d,e[d]=1),c++;a.b.length=b}};Pm.prototype.get=function(a,c){return Rm(this.f,a)?this.f[a]:c};
Pm.prototype.set=function(a,c){Rm(this.f,a)||(this.g++,this.b.push(a),this.h++);this.f[a]=c};var Om=function(a,c){if(c instanceof Pm)for(var b=c.Jb(),d=0;d<b.length;d++)a.set(b[d],c.get(b[d]));else for(b in c)a.set(b,c[b])};Pm.prototype.forEach=function(a,c){for(var b=this.Jb(),d=0;d<b.length;d++){var e=b[d],f=this.get(e);a.call(c,f,e,this)}};Pm.prototype.clone=function(){return new Pm(this)};var Um=function(a){Qm(a);for(var c={},b=0;b<a.b.length;b++){var d=a.b[b];c[d]=a.f[d]}return c};
Pm.prototype.Rb=function(a){Qm(this);var c=0,b=this.h,d=this,e=new Jm;e.next=function(){if(b!=d.h)throw Error("The map has changed since the iterator was created");if(c>=d.b.length)throw Im;var f=d.b[c++];return a?f:d.f[f]};return e};var Rm=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};var Vm=function(a,c){this.h=c;this.f=a;this.f.pa=this.pa.bind(this);this.b=new Pm;this.j=new Pm;this.l=gb("mr.cast.SinkDiscoveryService");this.g={qg:0,Hg:0}};q(Vm,Si);Vm.prototype.init=function(){gm(this);bj("mr.cast.SinkDiscoveryService",this)};
var cn=function(a,c){a.l.info("addSinks returned "+c.length+" sinks");nb(a.l,function(){return"....the list is: "+JSON.stringify(c)});var b=new Set(a.b.Jb());c.forEach(function(e){var f=e.sink_id;var g=e.extra_data.cast_media_sink,k=g.ip_endpoint?g.ip_endpoint.address:g.ip_address,m=g.ip_endpoint?g.ip_endpoint.port:Am().h||8009;f=new Gm(f,e.name,g.model_name,g.capabilities,k.address_bytes.join("."),m);g=a.b.get(f.getId());k=a.f;e=e.extra_data.cast_media_sink.cast_channel_id;m=f.getId();var p=k.f.get(m);
if(!p||p.channelId!=e){Wm.info("Added cast channel "+e+" to receiver: "+m);p&&k.b.remove(p.channelId);p={auth:"ssl_verified",ipAddress:f.Yb(),port:f.Fb()};p={channelId:e,readyState:"open",keepAlive:!0,audioOnly:!(f.b&1),connectInfo:p};k.f.set(m,p);k.b.set(e,m);var u=k.h.get(m);u&&u.channelId!=e&&(Wm.info("Re-connected to receiver: "+f.getId()),Xm(k.g,u,p),Ym(k.j.j,f,!0));k.h.set(m,p)}if(g){if(k=g.update(f.f.friendlyName,f.Yb(),f.Fb(),f.b))g.Di=!1;k&&Zm(a.h,g)}else a.l.info("Adding sink "+f.getId()),
$m(a,f),g=a.h,g.g.onSinkAvailabilityUpdated(g,1),Zm(g,f),Ym(g.j,f),Am().b=new xm(f.Bc,f.Yb());b.delete(f.getId())});b.forEach(function(e){var f=a.f,g=f.h.get(e);g&&(an(f.g,g),f.h.remove(e));bn(a,e)});var d=a.b.za();a.g={qg:d,Hg:d}};Vm.prototype.Ye=function(){return this.g};
var $m=function(a,c){var b=a.b.get(c.getId()),d=null,e=c.Yb(),f=c.Fb();null!=e&&null!=f&&(d=a.j.get(e+":"+f));if(b&&!d){var g=c.Yb(),k=c.Fb();g&&k&&a.j.remove(g+":"+k)}d&&!b&&a.b.remove(d.getId());a.b.set(c.getId(),c);null!=e&&null!=f&&a.j.set(e+":"+f,c)},bn=function(a,c){var b=a.b.get(c);if(b){a.l.info("Removing sink "+c);a.b.remove(c);c=b.Yb();var d=b.Fb();null!=c&&null!=d&&a.j.remove(c+":"+d);a=a.h;if(0==a.b.b.za())a.g.onSinkAvailabilityUpdated(a,0);c=a.j;b=b.getId();(b=dn(c.b,b))&&b.session&&
en(c,b.session.sessionId);fn(a.F);a.g.hd()}},hn=function(a){a.l.info("Pruning inactive sinks.");var c=new Set;a.b.forEach(function(b){gn(a.f,b)||c.add(b.getId())});c.forEach(function(b){return bn(a,b)})};Vm.prototype.pa=function(a){return this.b.get(a,null)};var jn=function(a,c){var b=[];Lm(a.b.Rb(!1),function(d){Zl(Hm(d,c))&&b.push(d)});return b};Vm.prototype.Ca=function(){return"cast.SinkDiscoveryService"};
Vm.prototype.qb=function(){var a=this,c={};Lm(this.b.Rb(!0),function(b){var d=a.b.get(b);d={id:d.getId(),ip:d.Yb(),port:d.Fb(),friendlyName:d.f.friendlyName,modelName:d.Bc,capabilities:d.b,discoveredByDial:d.Di,appStatusMap:d.hc};c[b]=d});return[new kn(c,this.g)]};
Vm.prototype.ob=function(){var a=dm(this);if(a&&4==a.version){this.g=a.deviceCounts;a=a.sinkMap;for(var c in a){var b=void 0,d=a[c],e=new Gm("",d.friendlyName,d.modelName,d.capabilities,d.ip,d.port);e.f.id=d.id;e.Di=d.discoveredByDial;e.hc=d.appStatusMap;for(b in e.hc)"unavailable"==e.hc[b]&&(e.hc[b]="unavailable_rescan");b=e;this.pa(b.getId())||$m(this,b)}hn(this)}};var kn=function(a,c){this.sinkMap=a;this.deviceCounts=c;this.version=4};var ln={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var mn=function(){this.type="GET_STATUS";this.requestId=0};var nn=function(a,c){this.requestId=a;this.gh=c;this.Gn=null};nn.prototype.b=function(){};var on=function(){this.b=new Pm},pn=function(a,c){a.b.set(c.requestId,c);c.Gn=setTimeout(function(){a.b.remove(c.requestId);c.b()},c.gh)},qn=function(a,c){var b=a.b.get(c);if(!b)return null;clearTimeout(b.Gn);a.b.remove(c);return b};var rn=function(a,c,b){this.type="APPLICATION_BROADCAST";this.requestId=0;this.appIds=a;this.namespace=c;this.message=b};var sn=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var tn=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var un=function(a){this.f=a;this.b=1E3*Math.floor(1E6*Math.random())},vn=function(a){var c=a.b++;0==c&&(c=a.b++);return c};un.prototype.Ca=function(){return"IdGenerator."+this.f};un.prototype.qb=function(){return[this.b]};un.prototype.ob=function(){var a=dm(this);a&&(this.b=a)};var wn=function(a,c){this.f=a;this.g=c;this.b=new on;this.h=new un("cast.RequestIdGenerator")};wn.prototype.init=function(){gm(this.h)};var yn=function(a,c,b,d){var e=vn(a.h);c.requestId=e;c=new Cb;b=new xn(e,c,"number"===typeof b&&0<b?b:6E5,d);pn(a.b,b);return b};
wn.prototype.sendRequest=function(a,c,b,d,e,f){var g=this;if(!Yl.hasOwnProperty(b))return Promise.reject(Error("Custom namespace is not supported"));var k=yn(this,a,void 0!==d?d:3E3,e),m=k.Gb;zn(this.f,c,b,a,e||this.g,f).then(null,function(){qn(g.b,k.requestId);m.reject(An)});return m.b};
wn.prototype.sendMessage=function(a,c,b,d,e,f){var g=this,k=yn(this,a,void 0!==d?d:3E3,e),m=k.Gb;zn(this.f,c,b,a,e||this.g,f).then(function(){qn(g.b,k.requestId);m.resolve(!0)},function(){qn(g.b,k.requestId);m.reject(An)});return m.b};
var Bn=function(a,c,b){var d=new sn(c.appId);d.language=c.language?c.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return a.sendRequest(d,b,Tl,c.requestSessionTimeout)},Cn=Error("Timeout"),An=Error("Failed to send message"),xn=function(a,c,b,d){nn.call(this,a,b);this.Gb=c;this.sourceId=d};q(xn,nn);xn.prototype.b=function(){this.Gb.reject(Cn)};var Dn=function(a){return a.za&&"function"==typeof a.za?a.za():Ua(a)||Ja(a)?a.length:Dc(a)},En=function(a){if(a.Ga&&"function"==typeof a.Ga)return a.Ga();if(Ja(a))return a.split("");if(Ua(a)){for(var c=[],b=a.length,d=0;d<b;d++)c.push(a[d]);return c}return Fc(a)},Fn=function(a){if(a.Jb&&"function"==typeof a.Jb)return a.Jb();if(!a.Ga||"function"!=typeof a.Ga){if(Ua(a)||Ja(a)){var c=[];a=a.length;for(var b=0;b<a;b++)c.push(b);return c}return Gc(a)}},Gn=function(a){return a.Ub&&"function"==typeof a.Ub?
a.Ub():Ua(a)||Ja(a)?Vb(a):Kc(a)},Hn=function(a,c,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(c,b);else if(Ua(a)||Ja(a))Kb(a,c,b);else for(var d=Fn(a),e=En(a),f=e.length,g=0;g<f;g++)c.call(b,e[g],d&&d[g],a)},In=function(a,c,b){if("function"==typeof a.map)return a.map(c,b);if(Ua(a)||Ja(a))return Nb(a,c,b);var d=Fn(a),e=En(a),f=e.length;if(d){var g={};for(var k=0;k<f;k++)g[d[k]]=c.call(b,e[k],d[k],a)}else for(g=[],k=0;k<f;k++)g[k]=c.call(b,e[k],void 0,a);return g},Jn=function(a,c){if("function"==
typeof a.every)return a.every(c,void 0);if(Ua(a)||Ja(a))return Qb(a,c,void 0);for(var b=Fn(a),d=En(a),e=d.length,f=0;f<e;f++)if(!c.call(void 0,d[f],b&&b[f],a))return!1;return!0};var Ln=function(a){this.b=new Pm;a&&Kn(this,a)},Mn=function(a){var c=typeof a;return"object"==c&&a||"function"==c?"o"+(a[Xa]||(a[Xa]=++Za)):c.substr(0,1)+a};Ln.prototype.za=function(){return this.b.za()};Ln.prototype.add=function(a){this.b.set(Mn(a),a)};var Kn=function(a,c){c=En(c);for(var b=c.length,d=0;d<b;d++)a.add(c[d])};h=Ln.prototype;h.removeAll=function(a){a=En(a);for(var c=a.length,b=0;b<c;b++)this.remove(a[b])};h.remove=function(a){return this.b.remove(Mn(a))};h.clear=function(){this.b.clear()};
h.Ub=function(){return this.b.Ub()};h.contains=function(a){return Sm(this.b,Mn(a))};h.Ga=function(){return this.b.Ga()};h.clone=function(){return new Ln(this)};h.equals=function(a){return this.za()==Dn(a)&&Nn(this,a)};var Nn=function(a,c){var b=Dn(c);if(a.za()>b)return!1;!(c instanceof Ln)&&5<b&&(c=new Ln(c));return Jn(a,function(d){var e=c;return e.contains&&"function"==typeof e.contains?e.contains(d):e.Ff&&"function"==typeof e.Ff?e.Ff(d):Ua(e)||Ja(e)?Ub(e,d):Ic(e,d)})};Ln.prototype.Rb=function(){return this.b.Rb(!1)};var Pn=function(a,c){this.h=a;this.g=c;this.f=new Pm;this.b=new Ln;this.j=0;this.o=new Pm("serviceCheck",this.Jq.bind(this),"startDeviceMonitor",this.Kq.bind(this),"releaseDeviceMonitor",this.Iq.bind(this),"deviceJustSetUp",this.Fq.bind(this),"logRecord",this.Gq.bind(this));chrome.runtime.onMessage.addListener(this.m.bind(this));chrome.runtime.onMessageExternal.addListener(this.w.bind(this));On(this,"serviceReady")};Pn.prototype.l=gb("castApp.eventPage.Service");
var fn=function(a){if(Qn(a)){var c=new Ln;Lm(a.h.b.Rb(!1),function(d){var e=d.Yb();c.add(e);Sm(this.f,e)||this.g.sendRequest(new mn,d,Tl)}.bind(a));var b=!1;a.f.Jb().forEach(function(d){c.contains(d)||(this.f.remove(d),b=!0)}.bind(a));b&&Rn(a)}},Qn=function(a){if(0===a.b.za())return!1;var c=v();3E4<c-a.j&&(a.j=c,chrome.tabs.query({url:["chrome://cast/*","chrome-extension://"+chrome.runtime.id+"/cast_setup/*"]},function(b){0===b.length?(this.l.info("No tabs found. Clearing device monitor clients."),
this.b.clear()):this.l.info(function(){return"Tab check found active tabs: "+b.map(function(d){return d.id})})}.bind(a)));c=a.b.za();a.l.info("Monitor client count: "+c);return 0<c};Pn.prototype.m=function(a,c,b){if("object"!==typeof a||"cast_app"!==a.type)return!1;var d=this.o.get(a.subtype);if(!d)return!1;if(!a.originId)return Gb("Missing origin ID in the incoming message."),!1;try{var e=d(a,c,b);e&&b(e)}catch(f){this.l.error("Error while handling request",f)}return!1};
var On=function(a,c,b){var d=new Ol(c,b);nb(a.l,function(){return"Sending message: "+JSON.stringify(d)});chrome.runtime.sendMessage(d)};h=Pn.prototype;h.Jq=function(){On(this,"serviceReady")};h.Kq=function(a){this.b.contains(a.originId)?this.l.info("Client: "+a.originId+"already registered, dispatching current device list."):(this.l.info("Registering monitor client: "+a.originId),this.b.add(a.originId));Rn(this);Sn(this)};h.Iq=function(a){this.l.info("Unregistering monitor client: "+a.originId);this.b.remove(a.originId)};
h.Fq=function(a){a=a.deviceJustSetUp.udn.replace(/-/g,"").toLowerCase();this.l.info("Device just set up: "+a.slice(-4))};h.Gq=function(a){a=a.logRecord;jb({level:qb(a.levelValue),R:a.loggerName,time:a.time,message:a.msg})};var Rn=function(a){var c=a.f.Ga();On(a,"devices",c)},Sn=function(a){a.h.b.Ga().forEach(function(c){this.g.sendRequest(new mn,c,Tl)}.bind(a))};
Pn.prototype.w=function(a,c,b){switch(a.type){case "handshake":b(new Ql("handshake"));break;case "launch":c=c.tab&&"number"===typeof c.tab.id?c.tab.id:null,null===c||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(c,{url:"chrome://cast#"+a.entryPoint})}};chrome.cast.VERSION=[1,2];w("chrome.cast.VERSION",chrome.cast.VERSION);chrome.cast.yt=!0;w("chrome.cast.usingPresentationApi",chrome.cast.yt);chrome.cast.Error=function(a,c,b){this.code=a;this.description=c||null;this.details=b||null};w("chrome.cast.Error",chrome.cast.Error);chrome.cast.hp=function(a){this.platform=a;this.packageId=this.url=null};w("chrome.cast.SenderApplication",chrome.cast.hp);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};w("chrome.cast.Image",chrome.cast.Image);
chrome.cast.Volume=function(a,c){this.level=void 0!==a?a:null;this.muted=void 0!==c?c:null};w("chrome.cast.Volume",chrome.cast.Volume);chrome.cast.qd={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};w("chrome.cast.AutoJoinPolicy",chrome.cast.qd);chrome.cast.oh={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};w("chrome.cast.DefaultActionPolicy",chrome.cast.oh);chrome.cast.Xd={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
w("chrome.cast.Capability",chrome.cast.Xd);chrome.cast.sd={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};w("chrome.cast.ErrorCode",chrome.cast.sd);chrome.cast.So={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
w("chrome.cast.ReceiverAvailability",chrome.cast.So);chrome.cast.jp={CHROME:"chrome",IOS:"ios",ANDROID:"android"};w("chrome.cast.SenderPlatform",chrome.cast.jp);chrome.cast.ph={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};w("chrome.cast.ReceiverType",chrome.cast.ph);chrome.cast.ho={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};w("chrome.cast.DialAppState",chrome.cast.ho);chrome.cast.mg={CAST:"cast",STOP:"stop"};w("chrome.cast.ReceiverAction",chrome.cast.mg);
chrome.cast.Yk={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};w("chrome.cast.SessionStatus",chrome.cast.Yk);chrome.cast.dl={ATTENUATION:"attenuation",FIXED:"fixed",MASTER:"master"};w("chrome.cast.VolumeControlType",chrome.cast.dl);chrome.cast.Tn=function(a,c,b,d,e){this.sessionRequest=a;this.sessionListener=c;this.receiverListener=b;this.autoJoinPolicy=d||chrome.cast.qd.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=e||chrome.cast.oh.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};w("chrome.cast.ApiConfig",chrome.cast.Tn);chrome.cast.jo=function(a,c){this.appName=a;this.launchParameter=c||null};w("chrome.cast.DialRequest",chrome.cast.jo);
chrome.cast.Fk=function(a,c,b){this.receiver=a;this.appState=c;this.extraData=b||null};w("chrome.cast.DialLaunchData",chrome.cast.Fk);chrome.cast.io=function(a,c){this.doLaunch=a;this.launchParameter=c||null};w("chrome.cast.DialLaunchResponse",chrome.cast.io);chrome.cast.Xk=function(a,c,b){this.appId=a;this.capabilities=Ta(c)?c:[chrome.cast.Xd.VIDEO_OUT,chrome.cast.Xd.AUDIO_OUT];this.requestSessionTimeout=b||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
w("chrome.cast.SessionRequest",chrome.cast.Xk);
chrome.cast.ii=function(a,c,b,d){this.label=a;a=c;vd.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(pd,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(qd,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(rd,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(sd,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(td,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(ud,"&#0;")));this.friendlyName=a;this.capabilities=b||[];this.volume=d||null;this.receiverType=chrome.cast.ph.CAST;this.displayStatus=this.isActiveInput=null};
w("chrome.cast.Receiver",chrome.cast.ii);chrome.cast.To=function(a,c){this.statusText=a;this.appImages=c;this.showStop=null};w("chrome.cast.ReceiverDisplayStatus",chrome.cast.To);chrome.cast.al=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};w("chrome.cast.Timeout",chrome.cast.al);chrome.cast.timeout=new chrome.cast.al;w("chrome.cast.timeout",chrome.cast.timeout);chrome.cast.zk="auto-join";chrome.cast.Tk="cast-session_";chrome.cast.media.po={SDR:"sdr",HDR:"hdr",DV:"dv"};w("chrome.cast.media.HdrType",chrome.cast.media.po);chrome.cast.media.qo={AAC:"aac",AC3:"ac3",MP3:"mp3",TS:"ts",TS_AAC:"ts_aac",E_AC3:"e_ac3",FMP4:"fmp4"};w("chrome.cast.media.HlsSegmentFormat",chrome.cast.media.qo);chrome.cast.media.ro={MPEG2_TS:"mpeg2_ts",FMP4:"fmp4"};w("chrome.cast.media.HlsVideoSegmentFormat",chrome.cast.media.ro);chrome.cast.media.ve={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};
w("chrome.cast.media.MediaCommand",chrome.cast.media.ve);chrome.cast.media.Po={ALBUM:"ALBUM",PLAYLIST:"PLAYLIST",AUDIOBOOK:"AUDIOBOOK",RADIO_STATION:"RADIO_STATION",PODCAST_SERIES:"PODCAST_SERIES",TV_SERIES:"TV_SERIES",VIDEO_PLAYLIST:"VIDEO_PLAYLIST",LIVE_TV:"LIVE_TV",MOVIE:"MOVIE"};w("chrome.cast.media.QueueType",chrome.cast.media.Po);chrome.cast.media.di={GENERIC_CONTAINER:0,AUDIOBOOK_CONTAINER:1};w("chrome.cast.media.ContainerType",chrome.cast.media.di);
chrome.cast.media.we={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4,AUDIOBOOK_CHAPTER:5};w("chrome.cast.media.MetadataType",chrome.cast.media.we);chrome.cast.media.PlayerState={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};w("chrome.cast.media.PlayerState",chrome.cast.media.PlayerState);chrome.cast.media.ji={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};w("chrome.cast.media.RepeatMode",chrome.cast.media.ji);
chrome.cast.media.Uo={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};w("chrome.cast.media.ResumeState",chrome.cast.media.Uo);chrome.cast.media.Zk={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};w("chrome.cast.media.StreamType",chrome.cast.media.Zk);chrome.cast.media.to={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};w("chrome.cast.media.IdleReason",chrome.cast.media.to);chrome.cast.media.sp={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};
w("chrome.cast.media.TrackType",chrome.cast.media.sp);chrome.cast.media.pp={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};w("chrome.cast.media.TextTrackType",chrome.cast.media.pp);chrome.cast.media.lp={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};w("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.lp);chrome.cast.media.qp={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};
w("chrome.cast.media.TextTrackWindowType",chrome.cast.media.qp);chrome.cast.media.mp={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};w("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.mp);chrome.cast.media.np={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};w("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.np);
chrome.cast.media.vp={LIKE:"LIKE",DISLIKE:"DISLIKE",FOLLOW:"FOLLOW",UNFOLLOW:"UNFOLLOW"};w("chrome.cast.media.UserAction",chrome.cast.media.vp);chrome.cast.media.no=function(){this.customData=null};w("chrome.cast.media.GetStatusRequest",chrome.cast.media.no);chrome.cast.media.Eo=function(){this.customData=null};w("chrome.cast.media.PauseRequest",chrome.cast.media.Eo);chrome.cast.media.Fo=function(){this.customData=null};w("chrome.cast.media.PlayRequest",chrome.cast.media.Fo);chrome.cast.media.gp=function(){this.customData=this.resumeState=this.currentTime=null};w("chrome.cast.media.SeekRequest",chrome.cast.media.gp);
chrome.cast.media.kp=function(){this.customData=null};w("chrome.cast.media.StopRequest",chrome.cast.media.kp);chrome.cast.media.zp=function(a){this.volume=a;this.customData=null};w("chrome.cast.media.VolumeRequest",chrome.cast.media.zp);chrome.cast.media.vo=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};w("chrome.cast.media.LoadRequest",chrome.cast.media.vo);
chrome.cast.media.Ey=function(a){this.type="PRECACHE";this.requestId=0;this.precacheData=a};chrome.cast.media.mo=function(a,c){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=c||null};w("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.mo);chrome.cast.media.ci=function(a){this.containerType=a=void 0===a?chrome.cast.media.di.GENERIC_CONTAINER:a;this.containerDuration=this.containerImages=this.sections=this.title=void 0};w("chrome.cast.media.ContainerMetadata",chrome.cast.media.ci);
chrome.cast.media.sc=function(a){this.metadataType=this.type=a;this.queueItemId=this.sectionStartTimeInContainer=this.sectionStartAbsoluteTime=this.sectionStartTimeInMedia=this.sectionDuration=void 0};w("chrome.cast.media.MediaMetadata",chrome.cast.media.sc);chrome.cast.media.Lk=function(){chrome.cast.media.sc.call(this,chrome.cast.media.we.GENERIC);this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=void 0};q(chrome.cast.media.Lk,chrome.cast.media.sc);
w("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.Lk);chrome.cast.media.Nk=function(){chrome.cast.media.sc.call(this,chrome.cast.media.we.MOVIE);this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=void 0};q(chrome.cast.media.Nk,chrome.cast.media.sc);w("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.Nk);
chrome.cast.media.bl=function(){chrome.cast.media.sc.call(this,chrome.cast.media.we.TV_SHOW);this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=void 0};q(chrome.cast.media.bl,chrome.cast.media.sc);w("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.bl);
chrome.cast.media.Ok=function(){chrome.cast.media.sc.call(this,chrome.cast.media.we.MUSIC_TRACK);this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=void 0};q(chrome.cast.media.Ok,chrome.cast.media.sc);w("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.Ok);
chrome.cast.media.Uk=function(){chrome.cast.media.sc.call(this,chrome.cast.media.we.PHOTO);this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=void 0};q(chrome.cast.media.Uk,chrome.cast.media.sc);w("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.Uk);chrome.cast.media.Bk=function(){chrome.cast.media.ci.call(this,chrome.cast.media.di.AUDIOBOOK_CONTAINER);this.releaseDate=this.publisher=this.narrators=this.authors=void 0};
q(chrome.cast.media.Bk,chrome.cast.media.ci);w("chrome.cast.media.AudiobookContainerMetadata",chrome.cast.media.Bk);chrome.cast.media.Ak=function(){chrome.cast.media.sc.call(this,chrome.cast.media.we.AUDIOBOOK_CHAPTER);this.images=this.subtitle=this.bookTitle=this.chapterNumber=this.title=this.chapterTitle=void 0};q(chrome.cast.media.Ak,chrome.cast.media.sc);w("chrome.cast.media.AudiobookChapterMediaMetadata",chrome.cast.media.Ak);
chrome.cast.media.xo=function(a,c){this.contentId=a;this.contentUrl=void 0;this.streamType=chrome.cast.media.Zk.BUFFERED;this.contentType=c;this.metadata=null;this.entity=void 0;this.duration=null;this.startAbsoluteTime=void 0;this.customData=this.textTrackStyle=this.tracks=null;this.userActionStates=this.hlsVideoSegmentFormat=this.hlsSegmentFormat=this.vmapAdsRequest=this.breakClips=this.breaks=void 0};w("chrome.cast.media.MediaInfo",chrome.cast.media.xo);
chrome.cast.media.Jo=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};w("chrome.cast.media.QueueItem",chrome.cast.media.Jo);chrome.cast.media.eo="CC1AD845";w("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.eo);chrome.cast.media.timeout={};chrome.cast.media.timeout.load=0;w("chrome.cast.media.timeout.load",chrome.cast.media.timeout.load);
chrome.cast.media.timeout.Ua=0;w("chrome.cast.media.timeout.getStatus",chrome.cast.media.timeout.Ua);chrome.cast.media.timeout.play=0;w("chrome.cast.media.timeout.play",chrome.cast.media.timeout.play);chrome.cast.media.timeout.pause=0;w("chrome.cast.media.timeout.pause",chrome.cast.media.timeout.pause);chrome.cast.media.timeout.seek=0;w("chrome.cast.media.timeout.seek",chrome.cast.media.timeout.seek);chrome.cast.media.timeout.stop=0;w("chrome.cast.media.timeout.stop",chrome.cast.media.timeout.stop);
chrome.cast.media.timeout.setVolume=0;w("chrome.cast.media.timeout.setVolume",chrome.cast.media.timeout.setVolume);chrome.cast.media.timeout.Ei=0;w("chrome.cast.media.timeout.editTracksInfo",chrome.cast.media.timeout.Ei);chrome.cast.media.timeout.us=0;w("chrome.cast.media.timeout.queue",chrome.cast.media.timeout.us);chrome.cast.media.rp=function(a,c){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=c;this.customData=this.subtype=this.language=this.name=null};
w("chrome.cast.media.Track",chrome.cast.media.rp);chrome.cast.media.op=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};w("chrome.cast.media.TextTrackStyle",chrome.cast.media.op);
chrome.cast.media.Lo=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.ji.OFF;this.customData=null};w("chrome.cast.media.QueueLoadRequest",chrome.cast.media.Lo);chrome.cast.media.Io=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};w("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.Io);
chrome.cast.media.Qo=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};w("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.Qo);chrome.cast.media.Ko=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};w("chrome.cast.media.QueueJumpRequest",chrome.cast.media.Ko);
chrome.cast.media.Oo=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};w("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.Oo);chrome.cast.media.Mo=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};w("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.Mo);
chrome.cast.media.No=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};w("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.No);chrome.cast.media.Wn=function(a,c,b){this.id=a;this.breakClipIds=c;this.position=b;this.duration=void 0;this.isWatched=!1;this.isEmbedded=void 0};w("chrome.cast.media.Break",chrome.cast.media.Wn);
chrome.cast.media.Xn=function(a){this.id=a;this.vastAdsRequest=this.customData=this.hlsSegmentFormat=this.clickThroughUrl=this.posterUrl=this.whenSkippable=this.duration=this.title=this.contentType=this.contentUrl=this.contentId=void 0};w("chrome.cast.media.BreakClip",chrome.cast.media.Xn);chrome.cast.media.xp=function(){this.adsResponse=this.adTagUrl=void 0};w("chrome.cast.media.VastAdsRequest",chrome.cast.media.xp);
chrome.cast.media.Yn=function(){this.whenSkippable=this.breakClipId=this.breakId=this.currentBreakClipTime=this.currentBreakTime=void 0};w("chrome.cast.media.BreakStatus",chrome.cast.media.Yn);chrome.cast.media.uo=function(a,c,b,d){this.start=a;this.end=c;this.isMovingWindow=b;this.isLiveDone=d};w("chrome.cast.media.LiveSeekableRange",chrome.cast.media.uo);
chrome.cast.media.Ho=function(a,c,b,d,e,f,g){this.id=a;this.queueType=this.entity=void 0;this.name=c;this.description=b;this.repeatMode=d;this.shuffle=!1;this.items=e;this.startIndex=f;this.startTime=g;this.containerMetadata=void 0};w("chrome.cast.media.QueueData",chrome.cast.media.Ho);chrome.cast.media.wp=function(a){this.userAction=a;this.customData=void 0};w("chrome.cast.media.UserActionState",chrome.cast.media.wp);chrome.cast.media.yp=function(a,c,b){this.width=a;this.height=c;this.hdrType=b};
w("chrome.cast.media.VideoInformation",chrome.cast.media.yp);chrome.cast.media.W=function(a,c){this.sessionId=a;this.mediaSessionId=c;this.media=null;this.videoInfo=this.queueData=void 0;this.playbackRate=1;this.playerState=chrome.cast.media.PlayerState.IDLE;this.currentTime=0;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.ji.OFF;this.liveSeekableRange=this.breakStatus=void 0};
w("chrome.cast.media.Media",chrome.cast.media.W);chrome.cast.media.W.prototype.Ua=function(){};chrome.cast.media.W.prototype.getStatus=chrome.cast.media.W.prototype.Ua;chrome.cast.media.W.prototype.play=function(){};chrome.cast.media.W.prototype.play=chrome.cast.media.W.prototype.play;chrome.cast.media.W.prototype.ms=function(){};chrome.cast.media.W.prototype.playWithContext=chrome.cast.media.W.prototype.ms;chrome.cast.media.W.prototype.pause=function(){};chrome.cast.media.W.prototype.pause=chrome.cast.media.W.prototype.pause;
chrome.cast.media.W.prototype.ls=function(){};chrome.cast.media.W.prototype.pauseWithContext=chrome.cast.media.W.prototype.ls;chrome.cast.media.W.prototype.seek=function(){};chrome.cast.media.W.prototype.seek=chrome.cast.media.W.prototype.seek;chrome.cast.media.W.prototype.stop=function(){};chrome.cast.media.W.prototype.stop=chrome.cast.media.W.prototype.stop;chrome.cast.media.W.prototype.setVolume=function(){};chrome.cast.media.W.prototype.setVolume=chrome.cast.media.W.prototype.setVolume;
chrome.cast.media.W.prototype.Ei=function(){};chrome.cast.media.W.prototype.editTracksInfo=chrome.cast.media.W.prototype.Ei;chrome.cast.media.W.prototype.ws=function(){};chrome.cast.media.W.prototype.queueInsertItems=chrome.cast.media.W.prototype.ws;chrome.cast.media.W.prototype.vs=function(){};chrome.cast.media.W.prototype.queueAppendItem=chrome.cast.media.W.prototype.vs;chrome.cast.media.W.prototype.Gs=function(){};chrome.cast.media.W.prototype.queueUpdateItems=chrome.cast.media.W.prototype.Gs;
chrome.cast.media.W.prototype.Bs=function(){};chrome.cast.media.W.prototype.queuePrev=chrome.cast.media.W.prototype.Bs;chrome.cast.media.W.prototype.As=function(){};chrome.cast.media.W.prototype.queueNext=chrome.cast.media.W.prototype.As;chrome.cast.media.W.prototype.xs=function(a){Tn(this,a)};chrome.cast.media.W.prototype.queueJumpToItem=chrome.cast.media.W.prototype.xs;chrome.cast.media.W.prototype.Fs=function(){};chrome.cast.media.W.prototype.queueSetRepeatMode=chrome.cast.media.W.prototype.Fs;
chrome.cast.media.W.prototype.Ds=function(){};chrome.cast.media.W.prototype.queueRemoveItems=chrome.cast.media.W.prototype.Ds;chrome.cast.media.W.prototype.Cs=function(a){Tn(this,a)};chrome.cast.media.W.prototype.queueRemoveItem=chrome.cast.media.W.prototype.Cs;chrome.cast.media.W.prototype.Es=function(){};chrome.cast.media.W.prototype.queueReorderItems=chrome.cast.media.W.prototype.Es;
chrome.cast.media.W.prototype.zs=function(a,c,b,d){a=Tn(this,a);0>a||(0>c?d&&d(new chrome.cast.Error(chrome.cast.sd.INVALID_PARAMETER)):a==c&&b&&b())};chrome.cast.media.W.prototype.queueMoveItemToNewIndex=chrome.cast.media.W.prototype.zs;chrome.cast.media.W.prototype.ut=function(a){return-1<this.supportedMediaCommands.indexOf(a)};chrome.cast.media.W.prototype.supportsCommand=chrome.cast.media.W.prototype.ut;chrome.cast.media.W.prototype.zq=function(){return this.currentTime};
chrome.cast.media.W.prototype.getEstimatedTime=chrome.cast.media.W.prototype.zq;chrome.cast.media.W.prototype.xq=function(){if(this.breakStatus&&void 0!==this.breakStatus.currentBreakTime)return this.breakStatus.currentBreakTime};chrome.cast.media.W.prototype.getEstimatedBreakTime=chrome.cast.media.W.prototype.xq;chrome.cast.media.W.prototype.wq=function(){if(this.breakStatus&&void 0!==this.breakStatus.currentBreakClipTime)return this.breakStatus.currentBreakClipTime};
chrome.cast.media.W.prototype.getEstimatedBreakClipTime=chrome.cast.media.W.prototype.wq;chrome.cast.media.W.prototype.yq=function(){if(this.liveSeekableRange&&void 0!==this.liveSeekableRange.start&&void 0!==this.liveSeekableRange.end)return this.liveSeekableRange};chrome.cast.media.W.prototype.getEstimatedLiveSeekableRange=chrome.cast.media.W.prototype.yq;chrome.cast.media.W.prototype.ti=function(){};chrome.cast.media.W.prototype.addUpdateListener=chrome.cast.media.W.prototype.ti;
chrome.cast.media.W.prototype.ui=function(){};chrome.cast.media.W.prototype.addUpdateListenerWithContext=chrome.cast.media.W.prototype.ui;chrome.cast.media.W.prototype.ak=function(){};chrome.cast.media.W.prototype.removeUpdateListener=chrome.cast.media.W.prototype.ak;chrome.cast.media.W.prototype.bk=function(){};chrome.cast.media.W.prototype.removeUpdateListenerWithContext=chrome.cast.media.W.prototype.bk;var Tn=function(a,c){return Rb(a.items,function(b){return b.itemId==c})};var Un=function(a,c,b){this.sessionId=a;this.namespaceName=c;this.message=b};var Vn=function(a,c){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=c||null};chrome.cast.ba=function(a,c,b,d,e){this.sessionId=a;this.appId=c;this.displayName=b;this.statusText=null;this.appImages=d;this.receiver=e;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.Yk.CONNECTED;this.transportId=""};w("chrome.cast.Session",chrome.cast.ba);chrome.cast.ba.prototype.it=function(a,c,b){this.zn(null,a,c,b)};chrome.cast.ba.prototype.setReceiverVolumeLevel=chrome.cast.ba.prototype.it;
chrome.cast.ba.prototype.zn=function(a,c,b,d){c=new Vn(new chrome.cast.Volume(c,null),this.receiver.volume);a.setReceiverVolume(this.sessionId,c,b,d)};chrome.cast.ba.prototype.setReceiverVolumeLevelWithContext=chrome.cast.ba.prototype.zn;chrome.cast.ba.prototype.ht=function(a,c,b){this.yn(null,a,c,b)};chrome.cast.ba.prototype.setReceiverMuted=chrome.cast.ba.prototype.ht;
chrome.cast.ba.prototype.yn=function(a,c,b,d){a=new Vn(new chrome.cast.Volume(null,c),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,b,d)};chrome.cast.ba.prototype.setReceiverMutedWithContext=chrome.cast.ba.prototype.yn;chrome.cast.ba.prototype.leave=function(a,c){null.leaveSession(this.sessionId,a,c)};chrome.cast.ba.prototype.leave=chrome.cast.ba.prototype.leave;chrome.cast.ba.prototype.stop=function(){};chrome.cast.ba.prototype.stop=chrome.cast.ba.prototype.stop;
chrome.cast.ba.prototype.st=function(){};chrome.cast.ba.prototype.stopWithContext=chrome.cast.ba.prototype.st;chrome.cast.ba.prototype.sendMessage=function(){};chrome.cast.ba.prototype.sendMessage=chrome.cast.ba.prototype.sendMessage;chrome.cast.ba.prototype.Us=function(){};chrome.cast.ba.prototype.sendMessageWithContext=chrome.cast.ba.prototype.Us;chrome.cast.ba.prototype.ti=function(){};chrome.cast.ba.prototype.addUpdateListener=chrome.cast.ba.prototype.ti;chrome.cast.ba.prototype.ui=function(){};
chrome.cast.ba.prototype.addUpdateListenerWithContext=chrome.cast.ba.prototype.ui;chrome.cast.ba.prototype.ak=function(){};chrome.cast.ba.prototype.removeUpdateListener=chrome.cast.ba.prototype.ak;chrome.cast.ba.prototype.bk=function(){};chrome.cast.ba.prototype.removeUpdateListenerWithContext=chrome.cast.ba.prototype.bk;chrome.cast.ba.prototype.Np=function(){};chrome.cast.ba.prototype.addMessageListener=chrome.cast.ba.prototype.Np;chrome.cast.ba.prototype.Op=function(){};
chrome.cast.ba.prototype.addMessageListenerWithContext=chrome.cast.ba.prototype.Op;chrome.cast.ba.prototype.Lp=function(){};chrome.cast.ba.prototype.addMediaListener=chrome.cast.ba.prototype.Lp;chrome.cast.ba.prototype.Mp=function(){};chrome.cast.ba.prototype.addMediaListenerWithContext=chrome.cast.ba.prototype.Mp;chrome.cast.ba.prototype.Ns=function(){};chrome.cast.ba.prototype.removeMediaListener=chrome.cast.ba.prototype.Ns;chrome.cast.ba.prototype.Os=function(){};
chrome.cast.ba.prototype.removeMediaListenerWithContext=chrome.cast.ba.prototype.Os;chrome.cast.ba.prototype.Ps=function(){};chrome.cast.ba.prototype.removeMessageListener=chrome.cast.ba.prototype.Ps;chrome.cast.ba.prototype.Qs=function(){};chrome.cast.ba.prototype.removeMessageListenerWithContext=chrome.cast.ba.prototype.Qs;chrome.cast.ba.prototype.er=function(a){a.sessionId=this.sessionId};chrome.cast.ba.prototype.loadMedia=chrome.cast.ba.prototype.er;
chrome.cast.ba.prototype.ys=function(a){a.sessionId=this.sessionId};chrome.cast.ba.prototype.queueLoad=chrome.cast.ba.prototype.ys;var Yn=function(a,c){if(!c.applications||1!=c.applications.length)return null;var b=c.applications[0];a=Wn(a);a=new chrome.cast.ba(b.sessionId,b.appId,b.displayName,b.appImages,a);a.senderApps=b.senderApps;a.namespaces=b.namespaces||[];a.transportId=b.transportId;a.statusText=b.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||Xn(a)))return null;a.receiver.volume=c.volume;"boolean"===typeof c.isActiveInput&&(a.receiver.isActiveInput=c.isActiveInput);return a},Zn=function(a){var c=
[];if(!a)return c;a&1&&c.push(chrome.cast.Xd.VIDEO_OUT);a&2&&c.push(chrome.cast.Xd.VIDEO_IN);a&4&&c.push(chrome.cast.Xd.AUDIO_OUT);a&8&&c.push(chrome.cast.Xd.AUDIO_IN);a&32&&c.push(chrome.cast.Xd.MULTIZONE_GROUP);return c},Wn=function(a){var c=Bm(Am(),a.getId());return new chrome.cast.ii(c,a.f.friendlyName,Zn(a.b))},$n=function(a,c){if(a.statusText!=c.statusText)return!0;var b=a.namespaces||[],d=c.namespaces||[];if(b.length!=d.length)return!0;for(var e={jg:0};e.jg<b.length;e={jg:e.jg},e.jg++)if(!d.some(function(f){return function(g){return g.name==
b[f.jg].name}}(e)))return!0;return a.receiver.volume.level!==c.receiver.volume.level||a.receiver.volume.muted!==c.receiver.volume.muted?!0:!1},ao=function(a){Ta(a)?a.forEach(ao):Wa(a)&&Object.keys(a).forEach(function(c){null===a[c]?delete a[c]:(Wa(a[c])||Ta(a[c]))&&ao(a[c])})},bo=function(a){return a.namespaces.some(function(c){return c.name==Vl})},Xn=function(a){return null!==a&&"MultizoneLeader"==a.appId},co=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==a};var eo=function(a,c,b){this.type=a;this.message=c;this.sequenceNumber=void 0!==b?b:-1;this.timeoutMillis=0;this.clientId=""};var fo=function(a,c){this.h=a;this.b=c;this.g=[];this.f=new on},ho=function(a,c){return(a=go(a.b,c))?a.routeId:null};fo.prototype.listen=function(a,c){this.g[a]=c};var jo=function(a,c,b,d){nb(io,"Sending to "+b);nb(io,JSON.stringify(d));d.clientId=b;a.h.g.ie(c,d)},ko=function(a,c,b){var d=go(a.b,c);d&&d.b?jo(a,d.routeId,c,b):a.connect(c).then(function(e){e?(e=ho(a,c))?jo(a,e,c,b):io.H("No route for "+c):io.H("No connected client "+c)},null)};
fo.prototype.connect=function(a){var c=go(this.b,a);if(null!=c&&c.b)return Promise.resolve(!0);c=ho(this,a);if(!c)return io.H("No route for client "+a),Promise.resolve(!1);if(a=this.f.b.get(c,null))return a.Gb.b;a=new Cb;pn(this.f,new lo(c,a));return a.b};var io=gb("mr.cast.ApiMessenger"),lo=function(a,c){nn.call(this,a,3E4);this.Gb=c};q(lo,nn);lo.prototype.b=function(){this.Gb.resolve(!1)};var mo=function(a,c,b){this.g=a;this.b=c;this.f=b},no=function(a){var c="cast-dial:"+a.g,b=new URLSearchParams;a.b&&b.set("dialPostData",a.b);a.f&&b.set("clientId",a.f);(a=b.toString())&&(c+="?"+a);return c};var oo=function(a,c,b,d,e,f,g,k,m,p){this.j=a;this.b=c||null;this.f=b||null;this.g=d||null;this.h=void 0!==e?e:null;this.s=f||null;this.D=g||null;this.o=k||!1;this.m=m||null;this.w=p||null},po=function(a,c){return(a=a.match(c+"=([^/]*)"))?a[1]:null},ro=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:Mb(Nb(a,function(c){c=po(c,"__castAppId__");if(!c)return null;c=c.match(qo);if(!c||0==c.length)return null;var b=[];3==c.length&&c[2]&&(b=c[2].split(","));return{appId:c[1],capabilities:b}}),
function(c){return null!=c})},so=function(a){return Nb(a.j,function(c){return c.appId})},to=function(a){return a.f?a.f:chrome.cast.qd.TAB_AND_ORIGIN_SCOPED},uo=function(a){var c=a.j.map(function(b){var d="cast:"+b.appId,e=new URLSearchParams;b.capabilities&&0<b.capabilities.length&&e.set("capabilities",b.capabilities.join(","));a.b&&e.set("clientId",a.b);a.f&&e.set("autoJoinPolicy",a.f);a.g&&e.set("defaultActionPolicy",a.g);null!=a.h&&e.set("launchTimeout",String(a.h));a.o&&e.set("invisibleSender",
"true");a.m&&(e.set("broadcastNamespace",a.m),e.set("broadcastId",String(Math.random())));a.w&&e.set("broadcastMessage",encodeURIComponent(JSON.stringify(a.w)));return d+"?"+e.toString()});a.s&&c.push(no(new mo(a.s,a.D,a.b)));return c},wo=function(a,c){a=so(a);var b=vo(c);return Pb(a,function(d){return Ub(b,d)})},xo=function(a){try{var c=new URL(a)}catch(u){return null}if("https:"==c.protocol)if("https:"!=c.protocol||"google.com"!=c.host||"/cast"!=c.pathname)a=null;else{var b=c.hash;if((a=ro(b))&&
0!=a.length){c=po(b,"__castClientId__");var d=po(b,"__castAutoJoinPolicy__"),e=po(b,"__castDefaultActionPolicy__");var f=po(b,"__castLaunchTimeout__");null==f?f=null:(f=Number(f),f=!isNaN(f)&&0<f?f:null);var g=po(b,"__dialAppName__"),k=po(b,"__dialPostData__");var m=po(b,"__castInvisibleSender__");m=null===m?null:"true"==m;var p=po(b,"__castBroadcastNamespace__");b=(b=po(b,"__castBroadcastMessage__"))?JSON.parse(decodeURIComponent(b)):null;a=new oo(a,c,d,e,f,g,k,m,p,b)}else a=null}else if("cast:"==
c.protocol){a=c.pathname;d=c.searchParams.get("capabilities");a={appId:a,capabilities:d?d.split(","):[]};k=c.searchParams;c=k.get("clientId");d=k.get("autoJoinPolicy");e=k.get("defaultActionPolicy");b=Number(k.get("launchTimeout"));if(isNaN(b)||0>=b)b=null;f="true"==k.get("invisibleSender");g=k.get("broadcastNamespace");k=(k=k.get("broadcastMessage"))?JSON.parse(decodeURIComponent(k)):null;a=new oo([a],c,d,e,b,void 0,void 0,f,g,k)}else a=null;return a},vo=function(a){return(a=xo(a))?so(a):null},yo=
function(a){return(a=xo(a))?a.b:null},qo=/(^\w+)(?:\(([\w, ]*)\))?$/;var zo={Gw:0,tw:1},Ao={zA:0,Ro:1,Iy:2},Bo={Lx:0,TIMEOUT:1,FAILED:2},Co={ew:0,qy:1,SEEK:2,ox:3,Dz:4,Ut:5},Do=function(a){Bb("MediaRouter.Cast.Session.Ended",a,Ao)},Eo=function(a){Bb("MediaRouter.Cast.Controller.ActionType",a,Co)},Fo=function(a){Bb("MediaRouter.Cast.Session.Fail",a,Bo)};var Go=function(a,c,b){this.R=gb("mr.MediaRouteController."+a);this.h=new mojo.Binding(mojo.MediaController,this,c);this.f=b;this.b=new mojo.MediaStatus({title:"",description:"",duration:new mojo.TimeDelta({microseconds:0}),current_time:new mojo.TimeDelta({microseconds:0})});this.o=!1;this.h.setConnectionErrorHandler(this.Rm.bind(this));this.f.ptr.setConnectionErrorHandler(this.Rm.bind(this))};h=Go.prototype;h.Rm=function(){this.lb();this.Pm()};
h.lb=function(){this.o||(this.o=!0,this.h&&(this.h.close(),this.h=null),this.f&&(this.f.ptr.reset(),this.f=null))};h.Pm=function(){};h.play=function(){};h.pause=function(){};h.hk=function(){};h.setVolume=function(){};h.seek=function(){};h.fq=function(a){a.close();throw Error("Not implemented");};Go.prototype.connectHangoutsMediaRouteController=Go.prototype.fq;Go.prototype.seek=Go.prototype.seek;Go.prototype.setVolume=Go.prototype.setVolume;Go.prototype.setMute=Go.prototype.hk;Go.prototype.pause=Go.prototype.pause;
Go.prototype.play=Go.prototype.play;var Ho=function(a){var c=new URL(a);a={};a.scheme=c.protocol.replace(":","");a.host=c.hostname;c=c.port?Number.parseInt(c.port,10):0;switch(a.scheme){case "http":a.port=c||80;break;case "https":a.port=c||443;break;default:throw Error("Scheme must be http or https");}a.suborigin="";return new mojo.Origin(a)},Io=function(a){return new mojo.TimeDelta({microseconds:Math.floor(1E6*a)})};var Jo=function(a,c,b,d){this.type=a;this.mediaSessionId=c;this.requestId=0;this.sessionId=b;this.currentTime=d},Lo=function(a,c,b,d,e){Go.call(this,"CastRouteController",a,c);this.session=b;this.g=d;this.j=e;this.m=new Date;this.w=new Set;Ko(this);Eo(0)};q(Lo,Go);
var Ko=function(a){var c=Mo(a);c&&No(a,c);c&&a.j||!a.session.statusText||(a.b.title=a.session.statusText.substring(0,256));a.b.volume=null===a.session.receiver.volume.level?0:a.session.receiver.volume.level;a.b.is_muted=!!a.session.receiver.volume.muted;a.b.can_mute=a.session.receiver.volume.controlType!==chrome.cast.dl.FIXED;a.b.can_set_volume=a.b.can_mute;if(a.f)a.f.onMediaStatusUpdated(a.b)};h=Lo.prototype;h.Pm=function(){Oo(this.g.b,this.session.sessionId)};
h.play=function(){var a=Mo(this);this.b.can_play_pause&&a&&this.b.play_state===mojo.MediaStatus.PlayState.PAUSED&&Po(this.g,this.session,new Jo("PLAY",a.mediaSessionId,this.session.sessionId));Qo(this,1)};h.pause=function(){var a=Mo(this);this.b.can_play_pause&&a&&this.b.play_state!==mojo.MediaStatus.PlayState.PAUSED&&Po(this.g,this.session,new Jo("PAUSE",a.mediaSessionId,this.session.sessionId));Qo(this,1)};
h.seek=function(a){var c=Mo(this);a=a?a.microseconds/1E6:0;var b;if(b=this.b.can_seek&&c&&0<=a)b=this.b.duration,b=a<=(b?b.microseconds/1E6:0);b&&Po(this.g,this.session,new Jo("SEEK",c.mediaSessionId,this.session.sessionId,a));Qo(this,2)};h.hk=function(a){this.b.can_mute&&a!==this.b.is_muted&&Ro(this.g,this.session,new chrome.cast.Volume(null,a));Qo(this,3)};h.setVolume=function(a){this.b.can_set_volume&&0<=a&&1>=a&&Ro(this.g,this.session,new chrome.cast.Volume(a));Qo(this,4)};
var Mo=function(a){return a.session.media.find(function(c){return!c.idleReason})||null},No=function(a,c){a.j&&c.media&&c.media.metadata&&c.media.metadata.title&&(a.b.title=c.media.metadata.title.substring(0,256));a.b.can_play_pause=c.supportedMediaCommands.includes(chrome.cast.media.ve.PAUSE);a.b.can_seek=c.supportedMediaCommands.includes(chrome.cast.media.ve.SEEK);var b=c.playerState;a.b.play_state=b===chrome.cast.media.PlayerState.PLAYING?mojo.MediaStatus.PlayState.PLAYING:b===chrome.cast.media.PlayerState.PAUSED?
mojo.MediaStatus.PlayState.PAUSED:mojo.MediaStatus.PlayState.BUFFERING;a.b.current_time=c.currentTime?Io(c.playerState===chrome.cast.media.PlayerState.PLAYING?c.currentTime+(new Date-a.m)/1E3:c.currentTime):Io(0);a.b.duration=c.media&&c.media.duration?Io(c.media.duration):Io(0)},Qo=function(a,c){0==a.w.size&&Eo(5);a.w.has(c)||(Eo(c),a.w.add(c))};Lo.prototype.setVolume=Lo.prototype.setVolume;Lo.prototype.setMute=Lo.prototype.hk;Lo.prototype.seek=Lo.prototype.seek;Lo.prototype.pause=Lo.prototype.pause;
Lo.prototype.play=Lo.prototype.play;var So=function(a){this.f=a;this.l=gb("mr.cast.SessionLauncher")},To=function(a,c,b){Bb("MediaRouter.Cast.Session.Type",0,zo);return Bn(a.f,c,b).then(a.b.bind(a,b),function(d){d&&Cn==d?Fo(1):Fo(0);throw d;})};So.prototype.b=function(a,c){nb(this.l,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==c.type)throw Fo(2),Error(c.reason);a=Yn(a,c.status);this.l.info("Launched session: "+a.sessionId);return a};var Uo=function(a){this.b=a;this.l=gb("mr.cast.ReceiverStatusQuerier")},Vo=function(a,c){return(new ef(t(a.f,a,c),3500,5)).start().then(null,function(b){a.l.info("Failed to get receiver status from "+c.getId());throw b;})};Uo.prototype.f=function(a){this.l.info("Query receiver status: "+a.getId());return this.b.sendRequest(new mn,a,Tl)};var Wo=function(a,c,b,d,e,f){this.g=a;this.w=c;this.j=b;this.b=d;this.m=e;this.h=f;this.f=new fo(f,b);this.C=new Uo(this.g);this.F=new So(this.g)};Wo.prototype.init=function(){this.j.init();this.f.listen("v2_message",this.D.bind(this));this.f.listen("app_message",this.o.bind(this));this.f.listen("leave_session",this.s.bind(this))};
var Zo=function(a,c,b,d){Xo(a.b,c).slice().forEach(function(e){e!=d&&Yo(a,e,b)})},Yo=function(a,c,b){b.clientId=c;ko(a.f,c,b)},$o=function(a,c,b,d){b={receiver:Wn(b),action:d};Yo(a,c,new eo("receiver_action",b))};
Wo.prototype.D=function(a){var c=a.message,b=c.sessionId;if(b){var d=ap(this.b,b);if(d)if(b=bp(this.b,b))if(b=this.w.pa(b))switch(c.type){case "STOP":cp(this,a,b);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":case "PRECACHE":dp(this,a,b,d);break;case "SET_VOLUME":ep(this,a,b);break;default:fp.H("Unknown request")}else gp(this,
a,chrome.cast.sd.INVALID_PARAMETER,"No receiver");else gp(this,a,chrome.cast.sd.INVALID_PARAMETER,"No sink ID");else gp(this,a,chrome.cast.sd.INVALID_PARAMETER,"Unknown session ID")}else gp(this,a,chrome.cast.sd.INVALID_PARAMETER,"No session ID")};
var gp=function(a,c,b,d){b=new chrome.cast.Error(b,d);hp(a,c,b)},hp=function(a,c,b){ko(a.f,c.clientId,new eo("error",b,c.sequenceNumber))},cp=function(a,c,b){var d=c.message;Ab("MediaRouter.Cast.Session.End");var e=d.sessionId,f=ip(a.b,e);f&&(f.j=!0);f=function(){en(a,e,c)};a.g.sendRequest(d,b,Tl,c.timeoutMillis,c.clientId).then(f,f)},dp=function(a,c,b,d){var e=c.message,f=e.type;f in ln&&(e.type=ln[f]);a.g.sendRequest(e,b,Vl,c.timeoutMillis,c.clientId,d.transportId).then(function(g){jp(a,d,g);ko(a.f,
c.clientId,new eo("v2_message",g,c.sequenceNumber))},function(g){hp(a,c,g)})},ep=function(a,c,b){var d=c.message;delete d.sessionId;a.g.sendRequest(d,b,Tl,c.timeoutMillis,c.clientId).then(function(){ko(a.f,c.clientId,new eo("v2_message",null,c.sequenceNumber))},function(e){hp(a,c,e)})};
Wo.prototype.o=function(a){var c=this,b=a.message,d=b.sessionId;if(d){var e=bp(this.b,d);e?(e=this.w.pa(e))?(d=ap(this.b,d),Sb(d.namespaces,function(f){return f.name==b.namespaceName})?zn(this.m,e,b.namespaceName,b.message,a.clientId,d.transportId).then(function(){ko(c.f,a.clientId,new eo("app_message",null,a.sequenceNumber))},function(){gp(c,a,chrome.cast.sd.CHANNEL_ERROR,"Channel to receiver not available")}):gp(this,a,chrome.cast.sd.INVALID_PARAMETER,"Invalid namespace")):fp.H("No receiver from sinkId"):
fp.H("No sinkId from sessionId")}else fp.H("No sessionId")};
Wo.prototype.s=function(a){var c=this;fp.info("Leave session");var b=ip(this.b,a.message);if(b){var d=a.clientId,e=go(this.j,d);if(e){var f=[],g=[],k=e.tabId,m=e.origin,p=e.autoJoinPolicy;b.f.forEach(function(u){var A=go(c.j,u);p==chrome.cast.qd.TAB_AND_ORIGIN_SCOPED&&k==A.tabId&&m==A.origin||p==chrome.cast.qd.ORIGIN_SCOPED&&m==A.origin?(A.f=!0,f.push(u)):g.push(u)});ko(this.f,d,new eo("leave_session",null,a.sequenceNumber));f.forEach(function(u){(u=go(c.j,u))&&kp(c.h,u.routeId,!0,!0)});b.f=g}else fp.H("No client record")}else fp.H("No session")};
var lp=function(a,c,b){bo(c)&&a.g.sendRequest(new mn,b,Vl,void 0,void 0,c.transportId).catch(Pa)},Ym=function(a,c,b){var d=c.getId();fp.info("Query status for "+d);Vo(a.C,c).then(function(e){mp(a,d,e);b&&(e=np(a.b,d))&&lp(a,e,c)},Pa)},op=function(a,c){if("*"==c.destinationId)return!0;c=c.destinationId;if(c==a.m.w||null!=go(a.j,c))return!0;fp.info("Invalid destination "+c);return!1},sp=function(a,c,b){nb(fp,function(){return"Cast message: "+JSON.stringify(b)});if(op(a,b))if(b.namespace_==Ul||b.namespace_==
Wl)(c=dn(a.b,c))&&c.b.forEach(function(f){var g=a.h,k=g.f.get(f);k&&k.Gf&&g.g.Th(f,b)});else{var d=JSON.parse(b.data),e=pp(a,d);e=e?e.sourceId:void 0;switch(d.type){case "RECEIVER_STATUS":mp(a,c,d);break;case "MEDIA_STATUS":qp(a,c,b,e)}}else rp(a.m,c,b.destinationId,b.sourceId,!1)},pp=function(a,c){a=qn(a.g.b,c.requestId);if(!a)return null;var b=a.Gb;switch(c.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete c.requestId;b.reject(new chrome.cast.Error(chrome.cast.sd.SESSION_ERROR,
c.reason||c.type,c));break;default:b.resolve(c)}return a},tp=function(a,c,b){nb(fp,function(){return"App message: "+JSON.stringify(b)});if(c=np(a.b,c)){var d;"*"==b.destinationId?d=Xo(a.b,c.sessionId):d=[b.destinationId];var e=new Un(c.sessionId,b.namespace_,b.data);d.forEach(function(f){ko(a.f,f,new eo("app_message",e))})}else fp.H("No session for incoming app message")},up=function(a,c){a.forEach(function(b){b.sessionId=c;var d=b.supportedMediaCommands,e=[];d&1&&e.push(chrome.cast.media.ve.PAUSE);
d&2&&e.push(chrome.cast.media.ve.SEEK);d&4&&e.push(chrome.cast.media.ve.STREAM_VOLUME);d&8&&e.push(chrome.cast.media.ve.STREAM_MUTE);b.supportedMediaCommands=e});return a},jp=function(a,c,b){c=c.sessionId;b.sessionId=c;b=up(b.status,c);vp(a.b,c,b);if((a=ip(a.b,c))&&a.controller&&(a=a.controller,a.m=new Date,(b=Mo(a))?No(a,b):(a.j&&(a.b.title=""),a.b.can_play_pause=!1,a.b.can_seek=!1),a.f))a.f.onMediaStatusUpdated(a.b)},wp=function(a,c){if(c=np(a.b,c)){c=c.sessionId;var b=ip(a.b,c);b&&b.j||en(a,c)}},
en=function(a,c,b){b&&Yo(a,b.clientId,b);(b=ip(a.b,c))&&b.b.slice().forEach(function(d){kp(a.h,d,!0)});xp(a.b,c);yp(a.h)},mp=function(a,c,b){nb(fp,"Receiver status for "+c);var d=b.status;if(d)if(b=a.w.pa(c)){d=Yn(b,d);var e=dn(a.b,c);e?d?d.sessionId==e.session.sessionId?(c=e.session,$n(c,d)&&(nb(fp,"Updating session "+d.sessionId),e.g&&(c.statusText=d.statusText),c.namespaces=d.namespaces,c.receiver.volume=d.receiver.volume,zp(a.h,e),Zo(a,c.sessionId,new eo("update_session",c)),e.controller&&Ko(e.controller))):
(wp(a,c),Do(1),Ap(a.h,null,b,null,d)):(wp(a,c),Do(1)):d&&Ap(a.h,null,b,null,d)}else Ab("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),fp.H("Got message from receiver "+c+", but sink is no longer available.")},qp=function(a,c,b,d){if(c=np(a.b,c))if(b=JSON.parse(b.data))jp(a,c,b),Zo(a,b.sessionId,new eo("v2_message",b),d)},Bp=function(a,c){var b=Zn(c.b);return(c=Sb(a.j,function(d){return Qb(d.capabilities,function(e){return Ub(b,e)})}))?c.appId:so(a)[0]},Cp=function(a,c,b){var d=xo(c);
if(!d)return Promise.reject(Error("Invalid source "+c));var e=Bp(d,b),f=new rb("MediaRouter.Cast.Session.Launch");return To(a.F,new chrome.cast.Xk(e,void 0,null==d.h?chrome.cast.timeout.requestSession:d.h),b).then(function(g){fp.info("Launched session "+g.sessionId+" for appId "+e);f.end("Success");return g},function(g){fp.error("Failed to session for appId "+e);f.end("Failure");throw g;})};
Wo.prototype.createMediaRouteController=function(a,c,b){a=Dp(this.b,a);if(!a)return Error("Session not found for the route");var d=a.session;if(a.controller)return Error("Controller already exists for the route");var e=Ep(this,d.sessionId);if(!e)return Error("Sink not found for the route");a.controller=new Lo(c,b,d,this,a.g);lp(this,d,e);return null};
var Po=function(a,c,b){var d=Ep(a,c.sessionId);d&&a.g.sendRequest(b,d,Vl,0,"",c.transportId).catch(function(e){fp.H("Failed to send a media control request: "+e)})},Ro=function(a,c,b){b=new Vn(b);(c=Ep(a,c.sessionId))&&a.g.sendRequest(b,c,Tl).catch(function(d){fp.H("Failed to send a volume control request: "+d)})},Ep=function(a,c){return(c=bp(a.b,c))?a.w.pa(c):null},fp=gb("mr.cast.ApiHandler");var Fp=function(a){return"0F5096E8"==a||"85CDB22F"==a};var Gp=function(a,c,b,d,e){for(var f=[],g=4;g<arguments.length;++g)f[g-4]=arguments[g];var k=this;this.j=a;this.w=c;this.Cj=b;this.f=d;this.h=f;this.b=!1;this.g=function(m){for(var p=[],u=0;u<arguments.length;++u)p[u-0]=arguments[u];return k.lq.apply(k,n(p))}};h=Gp.prototype;h.addListener=function(){this.b||(this.b=!0,this.f.addListener.apply(this.f,[this.g].concat(n(this.h))))};h.removeListener=function(){this.b&&(this.f.removeListener(this.g),this.b=!1)};
h.ih=function(a){for(var c=0;c<arguments.length;++c);return!0};h.lq=function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];var d=this;ej(this.j);if(!this.ih.apply(this,n(c)))return!1;Wi(this.Cj).then(function(e){return e.handleEvent.apply(e,[d.f].concat(n(c)))});return this.Bi()};h.Ca=function(){return"mr.EventListener."+this.w};h.qb=function(){return[this.b]};h.ob=function(){dm(this)&&this.addListener()};h.Bi=function(){};var Hp=null,Ip=null,Jp=function(){Hp||(Hp=new Gp(2,"CastChannelMessageListener","mr.cast.ChannelService",chrome.cast.channel.onMessage));Ip||(Ip=new Gp(1,"CastChannelErrorListener","mr.cast.ChannelService",chrome.cast.channel.onError));return[Hp,Ip]};var Kp=function(){},Lp=function(a){if(!a.startsWith("urn:x-org.chromium:media:route:"))return null;var c=a.substring(31);if(!c)return null;var b=c.match(/([^/]*)\/([^-/]*)-([^/]*)\/(.*)/);if(!b)return null;c=new Kp;c.f=a;a=l(b);a.next();c.b=a.next().value;c.h=a.next().value;c.j=a.next().value;c.g=a.next().value;return c};var Mp=function(a,c,b,d,e,f){this.id=a;this.presentationId=c;this.sinkId=b;this.mediaSource=d;this.isLocal=e;this.description=f;this.iconUrl=null;this.allowStop=!0;this.customControllerPath=null;this.supportsMediaRouteController=!1;this.controllerType=mojo&&mojo.RouteControllerType&&mojo.RouteControllerType.kNone;this.forDisplay=!0;this.offTheRecord=!1;this.Gf=e;this.isOffscreenPresentation=!1},Np=function(a,c,b,d,e,f){c=d&&ij(d)?a:"urn:x-org.chromium:media:route:"+a+"/"+c+"-"+b+"/"+d;return new Mp(c,
a,b,d,e,f)};var Op=function(a,c,b,d){b=Np(b,"cast",c.getId(),a,d,"");b.supportsMediaRouteController=!0;mojo&&mojo.RouteControllerType&&(b.controllerType=d&&fj(a)&&c.b&1&&mojo.RouteControllerType.kMirroring?mojo.RouteControllerType.kMirroring:mojo.RouteControllerType.kGeneric);return b},Pp=function(a,c){var b=c.wb.vc;b&&(c.description=tj(b),a.displayName="",a.statusText="mirror_desktop"==b.f?"":b.g||"")};var Qp=function(a,c,b,d){return{namespace_:a,data:"string"===typeof c?c:JSON.stringify(c),sourceId:b,destinationId:d}};var Rp=function(a){this.type="CLOSE";this.reasonCode=a};var Sp=function(a){return(a=a.exec(Yd))?a[1]:""},Tp=function(){if(Ye)return Sp(/Firefox\/([0-9.]+)/);if(Be||De||Ae)return Ve;if(bf)return ue()||ae("iPad")||ae("iPod")?Sp(/CriOS\/([0-9.]+)/):Sp(/Chrome\/([0-9.]+)/);if(cf&&!(ue()||ae("iPad")||ae("iPod")))return Sp(/Version\/([0-9.]+)/);if(Ze||$e){var a=/Version\/(\S+).*Mobile\/(\S+)/.exec(Yd);if(a)return a[1]+"."+a[2]}else if(af)return(a=Sp(/Android\s+([0-9.]+)/))?a:Sp(/Version\/([0-9.]+)/);return""}(),Up=function(a){return 0<=xd(Tp,a)};var Wp=function(a){this.type="CONNECT";this.origin={};this.userAgent=Yd;var c=this.userAgent.indexOf("(")+1;c=this.userAgent.substr(c,this.userAgent.indexOf(")",c)-1-c+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:Tp,platform:Vp(),systemVersion:c,connectionType:1};this.connType=a?0:2},Vp=function(){switch(Ci()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var Xp=function(a){if(!chrome.runtime.lastError)return null;var c="chrome.cast.channel.send failed, chrome.runtime.lastError: "+(chrome.runtime.lastError.message||"Unknown error");a&&nb(a,c);return Error(c)};var Yp=function(){this.b=new Pm};Yp.prototype.init=function(){gm(this)};var Zp=function(a,c,b,d,e){if(!Sm(a.b,[c.channelId,b,d].join("#"))){var f=Qp(Sl,new Wp(e),b,d);chrome.cast.channel.send(c,f,a.f.bind(a));a.b.set([c.channelId,b,d].join("#"),e)}};Yp.prototype.f=function(){Xp($p)};
var an=function(a,c){a.b.Jb().forEach(function(b){b.split("#")[0]==c.channelId.toString()&&a.b.remove(b)})},Xm=function(a,c,b){a.b.forEach(function(d,e){var f=e.split("#");f[0]==c.channelId.toString()&&(Zp(a,b,f[1],f[2],d),a.b.remove(e))})};Yp.prototype.Ca=function(){return"cast.VirtualConnectionManager"};Yp.prototype.qb=function(){var a=Um(this.b);return[new aq(a)]};Yp.prototype.ob=function(){var a=dm(this);if(a)for(var c in a.b)this.b.set(c,a.b[c])};Qa(Yp);
var $p=gb("mr.cast.VirtualConnectionManager"),aq=function(a){this.b=a};var bq=function(a,c){this.j=c;this.w=a;this.f=new Pm;this.b=new Pm;this.g=Yp.cb();this.pa=null;this.h=new Pm};q(bq,Si);bq.prototype.handleEvent=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];a==chrome.cast.channel.onMessage?this.o.apply(this,n(b)):a==chrome.cast.channel.onError&&this.m.apply(this,n(b))};bq.prototype.init=function(){this.g.init();gm(this);bj("mr.cast.ChannelService",this);Jp().forEach(function(a){return a.addListener()})};
var zn=function(a,c,b,d,e,f){e=e||a.w;f=f||"receiver-0";var g=gn(a,c);return g?cq(a,g,b,d,e,f):Promise.reject("Channel not found for "+c.getId())},rp=function(a,c,b,d,e){if(c=a.f.get(c))a=a.g,Sm(a.b,[c.channelId,b,d].join("#"))&&(a.b.remove([c.channelId,b,d].join("#")),b=Qp(Sl,new Rp(e?5:0),b,d),chrome.cast.channel.send(c,b,a.f.bind(a)))};
bq.prototype.o=function(a,c){var b=this.b.get(a.channelId);if(b){var d=this.pa(b);if(d){if(Yl.hasOwnProperty(c.namespace_)){var e=JSON.parse(c.data);switch(e.type){case "CLOSE":this.g.b.remove([a.channelId,c.destinationId,c.sourceId].join("#"));return;case "RPC":break;default:nb(Wm,function(){return"Got message "+(e.type||e.responseType)+" from "+d.getId()})}}else nb(Wm,"Got message in "+c.namespace_+" from "+d.getId());dq(this.j,d,c)}else Wm.H("Got message for unknown receiver (receiverId="+b+").")}else Wm.H("Got message for unknown channel (channelId="+
a.channelId+").")};var eq=function(a,c){var b=a.b.get(c.channelId);b&&(a.b.remove(c.channelId),a.f.remove(b))};bq.prototype.m=function(a,c){Wm.H(function(){return"Channel error: "+JSON.stringify(a)+(c?", "+JSON.stringify(c):"")});eq(this,a)};
var gn=function(a,c){c=c.getId();(a=a.f.get(c))||Wm.info("Channel not found for receiver: "+c);return a},cq=function(a,c,b,d,e,f){Zp(a.g,c,e,f,0==f.indexOf("receiver-0"));ao(d);var g=Qp(b,d,e,f);"object"===typeof d&&"RPC"==d.type||nb(Wm,function(){return"Channel is sending message: "+JSON.stringify(g)});return new Promise(function(k,m){chrome.cast.channel.send(c,g,function(p){p?p.errorState?(m(Error("Failed to send message")),eq(a,p)):k(!0):(p=Xp(Wm||void 0),m(p))})})};bq.prototype.Ca=function(){return"cast.ChannelService"};
bq.prototype.qb=function(){return[new fq(Um(this.f),Um(this.b),Um(this.h))]};bq.prototype.ob=function(){var a=dm(this);a&&(Om(this.f,a.f),Om(this.b,a.b),Om(this.h,a.g))};var Wm=gb("mr.cast.ChannelService"),fq=function(a,c,b){this.f=a;this.b=c;this.g=b};var gq=function(a,c,b,d,e,f){this.routeId=a;this.clientId=c;this.appIds=b;this.autoJoinPolicy=d;this.origin=e;this.tabId=f;this.f=this.b=!1},hq=function(){this.b=[]};hq.prototype.init=function(){gm(this)};hq.prototype.za=function(){return this.b.length};var go=function(a,c){return Sb(a.b,function(b){return b.clientId==c})},iq=function(a,c){return Sb(a.b,function(b){return b.routeId==c})},jq=function(a,c){a.b=Mb(a.b,function(b){return b.clientId!=c})};hq.prototype.Ca=function(){return"cast.ClientRecords"};
hq.prototype.qb=function(){return[new kq(this.b)]};hq.prototype.ob=function(){var a=dm(this);a&&(this.b=a.b)};var kq=function(a){this.b=a};var lq=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var mq=function(a,c){this.h=a;this.f=c;this.g=new Ln;this.b=new Pm};mq.prototype.init=function(){gm(this)};var nq=function(a,c){var b=a.b.get(c);b&&(b.Yj--,0<b.Yj||(Lm(a.f.b.Rb(!1),function(d){switch(Hm(d,c)){case "available":d.hc[c]="available_rescan";break;case "unavailable":d.hc[c]="unavailable_rescan"}}),a.b.remove(c)))};h=mq.prototype;
h.Im=function(a){var c=this;Lm(this.b.Rb(!0),function(b){a:{switch(Hm(a,b)){case "unknown":case "available_rescan":case "unavailable_rescan":var d=!0;break a}d=!1}if(d){var e=a.getId()+":"+b;c.g.contains(e)||(c.g.add(e),d=function(){c.g.remove(e)},(new ef(c.Yp.bind(c,a,b),5500,3)).start().then(c.In.bind(c,a,b),function(){c.l.error("Failed to get app availability response for "+a.getId()+", appId "+b+" after 3 attempts.");c.In(a,b,"unknown")}).then(d,d))}})};
h.In=function(a,c,b){b!=Hm(a,c)&&(this.l.info(c+" on "+a.getId()+" is "+b),a.hc[c]=b,Zm(this.f.h,a))};
h.Yp=function(a,c){var b=this,d=new lq;d.appId=[c];var e=new rb("MediaRouter.Cast.App.Availability");return this.h.sendRequest(d,a,Tl,5E3).then(function(f){e.end("Success");nb(b.l,function(){return"App availability response "+JSON.stringify(f)});for(var g in f.availability){if("APP_AVAILABLE"==f.availability[g])return"available";if("APP_UNAVAILABLE"==f.availability[g])return"unavailable"}return"unknown"},function(f){e.end("Failure");b.l.error("checkAppAvailability_ failed for "+a.getId()+", appId "+
c);throw f;})};h.Ca=function(){return"cast.AppDiscoveryService"};h.qb=function(){return[new oq(Um(this.b))]};h.ob=function(){var a=dm(this);a&&Om(this.b,a.b)};h.l=gb("mr.cast.AppDiscoveryService");var oq=function(a){this.b=a};var pq=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var qq=function(a,c){this.f=[];this.b=[];this.sinkId=a;this.session=c;this.w=this.h=null;this.offTheRecord=this.j=!1;this.controller=null;this.g=!0},rq=function(){this.l=gb("mr.cast.SessionRecords");this.b=[]};rq.prototype.init=function(){gm(this)};
var xp=function(a,c){a.l.info("Removing session "+c);Oo(a,c);a.b=Mb(a.b,function(b){return b.session.sessionId!=c})},Xo=function(a,c){return(a=ip(a,c))?a.f:[]},np=function(a,c){return(a=dn(a,c))?a.session:null},sq=function(a,c){return Sb(a.b,function(b){return Ub(b.f,c)})},Dp=function(a,c){return Sb(a.b,function(b){return Ub(b.b,c)})},tq=function(a,c){return Sb(a.b,function(b){return null!=Sb(b.b,function(d){return Lp(d).b==c})})},dn=function(a,c){return Sb(a.b,function(b){return b.sinkId==c||b.h==
c})},ip=function(a,c){return Sb(a.b,function(b){return b.session.sessionId==c})},bp=function(a,c){return(a=ip(a,c))?a.sinkId:null},ap=function(a,c){return(a=ip(a,c))?a.session:null},vp=function(a,c,b){var d=ap(a,c);d&&(a=Mb(b,function(e){return e.playerState!=chrome.cast.media.PlayerState.IDLE}),a.forEach(function(e){if(!e.media){var f=Sb(d.media,function(g){return g.mediaSessionId==e.mediaSessionId});f&&(e.media=f.media)}}),d.media=a)};rq.prototype.Ca=function(){return"cast.SessionRecords"};
rq.prototype.qb=function(){return[new uq(this.b)]};rq.prototype.ob=function(){var a=dm(this);if(a)for(var c=0;c<a.b.length;c++){var b=a.b[c],d=new qq(b.sinkId,b.session);d.f=b.f;d.b=b.b;d.j=b.j;d.w=b.w;d.h=b.h;d.g=b.g;this.b.push(d)}};
var Oo=function(a,c){(a=ip(a,c))&&a.controller&&(a.controller.lb(),a.controller=null)},uq=function(a){var c=[];a=l(a);for(var b=a.next();!b.done;b=a.next()){b=b.value;var d=new qq(b.sinkId,b.session);d.f=b.f;d.b=b.b;d.j=b.j;d.w=b.w;d.h=b.h;d.offTheRecord=b.offTheRecord;d.g=b.g;c.push(d)}this.b=c};var vq=function(a,c,b){var d=Error.call(this);this.message=d.message;"stack"in d&&(this.stack=d.stack);this.name="RouteRequestError";this.message=c||"";if(b)this.stack=b;else if(Error.captureStackTrace)Error.captureStackTrace(this,vq);else if(c=Error().stack)this.stack=c;this.errorCode=a};q(vq,Error);var wq=function(a,c){this.sinks=a;this.origins=c||null},xq=new wq([]);var yq=function(a){this.D="sender-"+se();this.f=new Pm;this.o=null;gm(this);this.g=a;this.m=new hq;this.h=new rq;this.s=new bq(this.D,this);this.b=new Vm(this.s,this);this.C=new wn(this.s,this.D);this.w=null;this.j=new Wo(this.C,this.b,this.m,this.h,this.s,this);this.F=new Pn(this.b,this.C)};h=yq.prototype;h.getName=function(){return"cast"};
h.initialize=function(a){a=a&&"boolean"===typeof a.enable_cast_sink_query?a.enable_cast_sink_query:!0;this.l.info("Query enabled: "+a);this.C.init();this.h.init();this.j.init();this.s.init();this.b.init();a&&(this.w=new mq(this.C,this.b),this.w.init())};h.Hd=function(){return this.f.Ga()};
h.Cg=function(a){var c=this;if(null!=zq(a))return new wq([]);var b=new Ln;Aq(a).forEach(function(d){jn(c.b,d).map(function(e){return e.f}).forEach(function(e){b.add(e)})});return new wq(b.Ga(),-1!=a.indexOf("0F5096E8")?jj:null)};
h.startObservingMediaSinks=function(a){var c=this,b=zq(a);b?(this.l.info("Received broadcast request "+a),Lm(this.b.b.Rb(!1),function(d){c.C.sendMessage(b,d,Xl).catch(function(e){c.l.error("Broadcast failed "+e.message)})})):this.w&&Aq(a).forEach(function(d){var e=c.w,f=e.b.get(d);f?f.Yj++:e.b.set(d,{Yj:1});e.l.info("Scanning sinks for app availability");Lm(e.f.b.Rb(!1),e.Im,e)})};h.stopObservingMediaSinks=function(a){var c=this;null!=zq(a)||this.w&&Aq(a).forEach(function(b){nq(c.w,b)})};
h.startObservingMediaRoutes=function(){};h.stopObservingMediaRoutes=function(){};h.pa=function(a){return(a=this.b.pa(a))?a.f:null};
var Bq=function(a,c,b){a.l.error("Error launching.",b);kp(a,c.id,!1,!0,"error");b=new ni(pq,"warning");ri(b,c.id);si(b,c.sinkId);a.g.bf(b)},Eq=function(a,c,b,d,e,f,g,k){Am().f=new xm(b.Bc,b.Yb());var m=Op(c,b,d,!0);m.forDisplay=!1;m.offTheRecord=e;a.f.set(m.id,m);a.g.Xf(a,m);yp(a);(e=xo(c))&&e.b&&Cq(a,e,m.id,g,k);return new Promise(function(p,u){hj(c)||ij(c)?(m.wb={tabId:k,sessionId:"",dg:b.Yb()||"",ne:b.Bc||"",nt:b.f.friendlyName||""},ij(c)&&(m.isOffscreenPresentation=!0),a.g.qj(a,m,d,function(A){return xi(Dq(a,
c,b,d,f,g,k,A))}).b.then(function(){var A=Dp(a.h,m.id);A.g=!1;Pp(A.session,m);A.controller&&(A.controller.j=!1,Ko(A.controller));p(m)},function(A){Bq(a,m,A);u(A)})):Dq(a,c,b,d,f,g,k,m).then(function(){p(m)},function(A){Bq(a,m,A);u(A)})})},Dq=function(a,c,b,d,e,f,g,k){return Cp(a.j,Fq(c,b,e),b).then(function(m){Ap(a,c,b,d,m,f,g,k);return k})};
yq.prototype.createRoute=function(a,c,b,d,e,f,g){var k=this,m=this.b.pa(c);if(!m)return wi(Error("No sink with ID "+c));var p=yo(a);if(p){setTimeout(function(){$o(k.j,p,m,chrome.cast.mg.CAST)},0);var u=function(){return Eq(k,a,m,b,d,e,f,g)},A=go(this.m,p);if(A)return xi(this.terminateRoute(A.routeId).then(u,u));if(f&&g&&(c=Gq(this,a,f,g,d,e,c)))return c}return xi(Eq(this,a,m,b,d,e,f,g))};
var kp=function(a,c,b,d,e){d=void 0===d?!1:d;e=void 0===e?"closed":e;a.l.info("Remove route "+c);var f=iq(a.m,c);if(f){b=b||f.f;var g=f.clientId;a.l.info("Remove client "+g);for(var k=a.h,m=0;m<k.b.length;m++)ac(k.b[m].f,g);jq(a.m,g)}if(g=Dp(a.h,c))ac(g.b,c),Hq(a,g.b);if(k=a.f.get(c))if(k.Gf&&g&&(rp(a.s,k.sinkId,f?f.clientId:a.D,g.session.transportId,b),k.forDisplay&&f&&(a.o={Ef:f,tn:g})),a.f.remove(c),a.g.Mg(k),yp(a),d)a.g.onPresentationConnectionClosed(c,e,"Remove route");else a.g.onPresentationConnectionStateChanged(c,
"terminated")},zp=function(a,c){c.b.forEach(function(b){if(b=a.f.get(b)){var d=c.session;if(b.forDisplay){var e=Fp(d.appId);e&&!b.isLocal?(b.description=d.statusText||"",d.displayName="",d.statusText=""):e||(b.description=d.statusText||d.displayName);c.controller&&Ko(c.controller)}a.g.gf(b)}})},aaa=function(a,c){Pb(c,function(b){b=a.f.get(b,null);if(!b||!b.mediaSource)return!1;var d=xo(b.mediaSource);d=d?d.o:!1;return b.isLocal&&!d})&&Kb(c,function(b){if(b=a.f.get(b,null))b.isLocal=!0})},Hq=function(a,
c){var b=[],d=[],e=null;c.forEach(function(f){if(f=a.f.get(f)){f.forDisplay=!1;var g=xo(f.mediaSource);g&&Sb(so(g),co)||(f.Gf?(g=g?to(g):null,e||g==chrome.cast.qd.CUSTOM_CONTROLLER_SCOPED||(b.push(f),e=f.sinkId)):e&&e!=f.sinkId?b.push(f):d.push(f))}});Kb(0<b.length?b:d,function(f){f.forDisplay=!0})},Cq=function(a,c,b,d,e){var f=c.b;if(f&&!go(a.m,f)){a.l.info("Add client "+f);var g=so(c);a.m.b.push(new gq(b,f,g,to(c),d||null,void 0!==e?e:null))}},Ap=function(a,c,b,d,e,f,g,k){var m=dn(a.h,b.getId());
if(!m){var p=a.h;m=b.getId();p.l.info("Adding new session: "+m+", "+e.sessionId);var u=ip(p,e.sessionId);u?(Xn(e)?(u.w=e,u.h=m):Xn(u.session)&&(u.w=u.session,u.h=u.sinkId,u.session=e,u.sinkId=m),m=u):(m=new qq(m,e),p.b.push(m))}k&&k.isLocal&&k.wb&&(m.g=!1);var A=null!=c;if(!A&&co(e.appId))return null;null==c?(u=new oo([{appId:e.appId,capabilities:e.capabilities}]),c=uo(u)[0]):u=xo(c);if(p=k){if(!a.f.get(p.id))return a.l.H("Route "+p.id+" not added"),p}else p=Op(c,b,d||e.sessionId,A),a.f.set(p.id,
p);d=p.id;a.l.info("Add route "+d);c=null;u&&(c=u.b,Cq(a,u,d,f,g));Ub(m.b,d)||m.b.push(d);p.Gf&&(f=a.s,g=c||a.D,d=e.transportId,u=!(u&&u.o),(A=gn(f,b))&&Zp(f.g,A,g,d,u));m.offTheRecord=p.offTheRecord;f=m.b;aaa(a,f);Hq(a,f);f=p;g=e.sessionId;Fp(e.appId)?f.isLocal&&g&&f.wb?f.wb.sessionId=g:(f.description=e.statusText||"",e.displayName="",e.statusText=""):f.description=e.statusText||e.displayName;k?a.g.gf(p):a.g.Xf(a,p);yp(a);if(k=c)Ub(m.f,c)?k=!1:(m.f.push(c),k=!0);k&&(a=a.j,ko(a.f,c,new eo("new_session",
e)),lp(a,e,b));return p};
yq.prototype.terminateRoute=function(a){var c=this,b=this.f.get(a);if(!b)return Promise.reject(new vq(3,"Route in Cast provider not found for routeId  "+a));var d=Dp(this.h,a);if(!d)return kp(this,a,!0),Promise.resolve();var e=d.session.sessionId,f=this.b.pa(b.sinkId);if(!f)return en(this.j,e),Promise.resolve();(a=iq(this.m,a))&&$o(this.j,a.clientId,f,chrome.cast.mg.STOP);Do(0);return new Promise(function(g){var k=function(){wp(c.j,f.getId());g()};c.C.sendRequest(new tn(e),f,Tl).then(k,k)})};
var baa=function(a,c){var b=null;Mm(a.f.Rb(!1),function(f){if(!f.Gf)return!1;var g=a.b.pa(f.sinkId);if(!g||!wo(c,Fq(f.mediaSource,g)))return!1;b=f;return!0});if(!b||!b.mediaSource)return null;var d=yo(b.mediaSource);if(!d)return null;var e=go(a.m,d);return e?(d=sq(a.h,d))?{Ef:e,tn:d}:null:null},Gq=function(a,c,b,d,e,f,g){var k=null;Mm(a.f.Rb(!1),function(p){var u=p.wb;return u&&null!=u.tabId&&u.tabId==d&&fj(p.mediaSource)?(k=p,!0):!1});if(!k)return null;var m=function(){return a.createRoute(c,g||
k.sinkId,"",e,f,b,null==d?void 0:d)};return xi(a.terminateRoute(k.id).then(m,m))};h=yq.prototype;h.connectRouteByRouteId=function(a,c,b,d,e){if(!xo(a))return wi(Error("Unsupported presentation URL"));if(!c)return wi(Error("No routeId"));c=Lp(c);c=ip(this.h,c.b);if(!c)return wi(Error("No matching route"));var f=this.b.pa(c.sinkId);return f?(a=Ap(this,a,f,b,c.session,d,e))?vi(a):wi(Error("Failed to create route")):wi(Error("No sink"))};
h.joinRoute=function(a,c,b,d,e,f){var g=xo(a);if(!g)return wi(Error("Unsupported presentation URL"));if(c==chrome.cast.zk){a:{var k=baa(this,g);if(!k){if(!this.o||this.o.Ef.origin!=e||this.o.Ef.tabId!=f){k=null;break a}k=this.o}switch(to(g)){case chrome.cast.qd.PAGE_SCOPED:k=null;break a;case chrome.cast.qd.ORIGIN_SCOPED:if(e!=k.Ef.origin){k=null;break a}break;case chrome.cast.qd.TAB_AND_ORIGIN_SCOPED:if(e!=k.Ef.origin||f!=k.Ef.tabId){k=null;break a}}k=ip(this.h,k.tn.session.sessionId)}if(!k&&(g.g?
g.g:chrome.cast.oh.CREATE_SESSION)!=chrome.cast.oh.CAST_THIS_TAB&&(d=Gq(this,a,e,f,b,d)))return d}else k=Iq(this,c);if(!k)return wi(Error("No matching route"));if(k.offTheRecord!=b)return wi(Error("Off the record mismatch"));d=this.b.pa(k.sinkId);if(!d)return wi(Error("No sink"));a=Ap(this,a,d,c,k.session,e,f);a.offTheRecord=b;return vi(a)};h.detachRoute=function(a){kp(this,a,!1,!0)};
h.Lf=function(a){var c=this.b.pa(a);if(!c)throw Error("Cannot mirror with no sink.");var b=new Aj;c=c.b;c&1||(b.shouldCaptureVideo=!1);c&4||(b.shouldCaptureAudio=!1);b.shouldCaptureAudio&&!b.shouldCaptureVideo&&(b.minLatencyMillis=b.maxLatencyMillis,b.animatedLatencyMillis=b.maxLatencyMillis);b.senderSideLetterboxing=!0;Bj(b);Object.freeze(b);this.l.info(function(){return"Settings for "+a+": "+zj(b)});if(!b.shouldCaptureAudio&&!b.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture");
return b};h.Kf=function(){return"cast_streaming"};h.Uh=function(a){var c=this.f.get(a);c&&c.wb&&c.wb.vc&&(a=Dp(this.h,a))&&(Pp(a.session,c),a.controller&&Ko(a.controller))};
h.sendRouteMessage=function(a,c,b){var d=this;if(!b)return new Promise(function(k,m){"string"!==typeof c&&m(Error("Cannot send non-string messages via ApiHandler."));m=d.j.f;nb(io,"Received: "+c);var p=JSON.parse(c),u=p.clientId;"client_connect"==p.type?(nb(io,"App "+u),(p=go(m.b,u))?(p.b=!0,(m=qn(m.f,p.routeId))&&m.Gb.resolve(!0)):io.H("Client not found "+u)):ho(m,u)?(m=m.g[p.type])&&m(p):io.H("No route for "+u);k()});var e=Dp(this.h,a);if(!e)return Promise.reject(Error("Not managing the route "+
a));var f=this.b.pa(e.sinkId);if(!f)return Promise.reject(Error("Sink no longer accessible"));var g=(a=iq(this.m,a))?a.clientId:this.D;return new Promise(function(k){zn(d.s,f,b.namespace,c,g,e.session.transportId).then(k,k)})};h.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};h.sg=function(a,c){var b=this.b.pa(c);if(!b)return!1;if(!this.w)return!0;a=Fq(a,b);return(a=vo(a))&&0!=a.length?Pb(a,function(d){return Zl(Hm(b,d))}):!1};
h.Df=function(a,c,b){var d=Aq(a);return d&&0!=d.length?c==chrome.cast.zk?!0:b&&b.mediaSource?(a=vo(b.mediaSource),Pb(a,function(e){return Ub(d,e)})):void 0==c||Iq(this,c)?!0:!1:!1};
var Fq=function(a,c,b){return xo(a)?a:hj(a)||ij(a)?(a={appId:0==(c.b&1)?"85CDB22F":"0F5096E8",capabilities:Zn(c.b)},uo(new oo([a],void 0,void 0,void 0,b))[0]):a},Aq=function(a){var c=[],b=xo(a);if(b)c=so(b);else if(hj(a)||ij(a))gj(a)||c.push("85CDB22F"),c.push("0F5096E8");return c},zq=function(a){var c=xo(a);if(!c)return null;a=Aq(a);var b=c.m||"";c=c.w;return b&&c?new rn(a,b,JSON.stringify(c)):null},Iq=function(a,c){return 0==c.indexOf(chrome.cast.Tk)?ip(a.h,c.substr(chrome.cast.Tk.length)):tq(a.h,
c)},dq=function(a,c,b){var d=a.F;if(Qn(d)&&Yl.hasOwnProperty(b.namespace_)){var e=c.Yb();if(e){var f=JSON.parse(b.data);if("RECEIVER_STATUS"===f.type){var g=f.status&&f.status.applications&&f.status.applications[0],k=f=null;g&&(g.appId&&(f=g.appId),g.sessionId&&(k=g.sessionId));g=d.f.get(e);d.f.set(e,new Pl(e,f,k));g&&g.appId===f||Rn(d)}}}a=a.j;c=c.getId();Yl.hasOwnProperty(b.namespace_)?sp(a,c,b):tp(a,c,b)},Zm=function(a,c){a.w&&a.w.Im(c);fn(a.F);a.g.hd()};h=yq.prototype;h.Ca=function(){return"cast.Provider"};
h.qb=function(){return[new caa(this.D,Um(this.f),this.o)]};h.ob=function(){var a=dm(this);a&&(this.D=a.g,Om(this.f,a.f),this.o=a.b)};h.searchSinks=function(){return cb()};h.createMediaRouteController=function(a,c,b){return(a=this.j.createMediaRouteController(a,c,b))?Promise.reject(a):Promise.resolve()};h.provideSinks=function(a){cn(this.b,a)};var yp=function(a){var c=a.Hd().some(function(b){return b.isLocal});a.g.ag(a.Ca(),c)};yq.prototype.l=gb("mr.CastProvider");
var caa=function(a,c,b){this.g=a;this.f=c;this.b=b};var Jq=function(){this.b=[]};Jq.prototype.listen=function(a,c,b){this.b.push({type:a,Yc:c,target:b})};var daa=function(a,c,b){var d=a.b.findIndex(function(e){return"internal_message"==e.type&&e.Yc==c&&e.target==b});-1!=d&&a.b.splice(d,1)},eaa=function(a,c){a.b.forEach(function(b){b.type==c.type&&Promise.resolve().then(function(){return b.Yc.call(b.target,c)})})};var faa={SUCCESS:0,Yo:1,Vt:2,Wt:3,vA:4,hz:5},gaa={SUCCESS:0,iz:1,Yo:2,Lz:3},haa={SUCCESS:0,fy:1,ow:2},Kq=function(a){Bb("MediaRouter.Dial.CreateRoute",a,faa)},Lq=function(a){Bb("MediaRouter.Dial.TerminateRoute",a,gaa)},Mq=function(a){Bb("MediaRouter.Dial.ParseMessage",a,haa)};var Nq=function(a,c,b,d){c="["+c+"]: "+b+" "+d.responseURL+" => "+d.status+" ("+d.statusText+")";200<=d.status&&299>=d.status?a.info(c):nb(a,c)};var iaa=function(){this.name="unknown";this.state="error";this.b=null;this.allowStop=!0;this.resource=null;this.extraData={}},Oq=function(){var a=Error.call(this);this.message=a.message;"stack"in a&&(this.stack=a.stack)};q(Oq,Error);var Qq=function(a){if(void 0===c){Pq||(Pq=new gf(10,2E3));var c=Pq}this.f=a;this.b=c;this.l=gb("mr.dial.Client")};
Qq.prototype.launchApp=function(a,c){var b=this;return this.b.send(Rq(this,a),"POST",c,{timeoutMillis:15E3}).then(function(d){return Sq(b,"launchApp","POST",d)})};
var Uq=function(a,c){return Tq(a,c).then(function(b){return b.resource?b.resource:(a.l.H("stopApp: Resource path for not available for app "+c+": using fallback path."),"run")},function(){a.l.H("stopApp: getAppInfo failed: using fallback path.");return"run"}).then(function(b){return a.b.send(Rq(a,c)+"/"+b,"DELETE")}).then(function(b){return Sq(a,"stopApp","DELETE",b)})},Tq=function(a,c){return a.b.send(Rq(a,c),"GET",void 0,{Mm:3}).then(function(b){Nq(a.l,"GetAppInfo","GET",b);if(!(200<=b.status&&
299>=b.status)){if(404==b.status)throw new Oq;throw Error("Response error: "+b.status);}b=b.responseText;b=(new DOMParser).parseFromString(b,"text/xml");b=b.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","parsererror").length?null:b;if(!b)throw a.l.info("Invalid or empty response"),Error("Invalid or empty response");var d=b.getElementsByTagName("service");if(!d||1!=d.length)throw a.l.info("Invalid GET response (invalid service)"),Error("Invalid GET response (invalid service)");b=new iaa;for(var e=
0,f=d[0].childNodes.length;e<f;e++){var g=d[0].childNodes[e];if("state"==g.nodeName){a:switch(g.textContent){case "running":g="running";break a;case "stopped":g="stopped";break a;default:g="error"}b.state=g}else"name"==g.nodeName?b.name=g.textContent:"link"==g.localName?b.resource=g.getAttribute("href"):"options"==g.nodeName?b.allowStop="false"!=g.getAttribute("allowStop"):b.extraData[g.nodeName]=g.innerHTML}if("unknown"==b.name)throw a.l.info("GET response missing name value"),Error("GET response missing name value");
if(b.name!=c)throw a.l.info("GET app name mismatch"),Error("GET app name mismatch");if("error"==b.state)throw a.l.info("GET response missing state value"),Error("GET response missing state value");if((d=/installable=(.+)/.exec(b.state))&&d[1])b.state="installable",b.b=d[1];else if("running"!=b.state&&"stopped"!=b.state)throw a.l.info("GET response has invalid state value"),Error("GET response has invalid state value");return b})},Rq=function(a,c){a=a.f.Yd;"/"!=a.charAt(a.length-1)&&(a+="/");return a+
c},Sq=function(a,c,b,d){return new Promise(function(e,f){Nq(a.l,c,b,d);200<=d.status&&299>=d.status?e():f(Error(d.statusText))})},Pq=null;var jaa=function(a,c){this.Lc=a;this.appName=c};var Vq=function(a){this.b=new Map;this.f=a};Vq.prototype.init=function(){gm(this)};Vq.prototype.clear=function(){this.b.clear()};Vq.prototype.add=function(a){if(!this.b.get(a.Lc.id)){this.b.set(a.Lc.id,a);var c=this.f;Wq(c);c.h.Xf(c,a.Lc)}};var Xq=function(a,c){a=l(a.b);for(var b=a.next();!b.done;b=a.next())if(b=l(b.value),b.next(),b=b.next().value,b.Lc.sinkId==c)return b;return null},Zq=function(a,c){var b=a.b.get(c);b&&(a.b.delete(c),Yq(a.f,b))};
Vq.prototype.Hd=function(){return Array.from(this.b.values(),function(a){return a.Lc})};Vq.prototype.Ca=function(){return"dial.ActivityRecords"};Vq.prototype.qb=function(){return[Array.from(this.b)]};Vq.prototype.ob=function(){var a=dm(this);a&&(this.b=new Map(a))};var $q=function(a){this.g=a;this.l=gb("mr.dial.SinkDiscoveryService");this.b=new Map;this.f={qg:0,Hg:0};this.h=0};$q.prototype.init=function(){gm(this)};
var maa=function(a,c){a.l.info("addSinks returned "+c.length+" sinks");nb(a.l,function(){return"....the list is: "+JSON.stringify(c)});var b=new Set(a.b.keys());c.forEach(function(f){var g=f.sink_id,k=f.extra_data.dial_media_sink,m=kaa.test(k.model_name);f=new Dm(f.name,g);f.oc=k.ip_address.address_bytes?k.ip_address.address_bytes.join("."):k.ip_address.address.join(".");f.Yd=k.app_url.url;f.Bc=k.model_name;f.He=!m;laa(a,f);b.delete(f.getId())});var d=[];b.forEach(function(f){var g=a.b.get(f);d.push(g);
a.b.delete(f)});0<d.length&&a.g.pj(d);var e=a.b.size;a.f={qg:e,Hg:e}},laa=function(a,c){nb(a.l,"mayAddSink, id = "+c.getId());var b=a.b.get(c.getId());b?b.update(c)&&(nb(a.l,"Updated sink "+b.getId()),a.g.Oh(b)):(nb(a.l,function(){return"Adding new sink "+c.getId()+": name = "+(c.Dc.friendlyName+(c.oc?", ip = "+c.oc:"")+(c.Bc?", model = "+c.Bc:"")+", apps = "+JSON.stringify(c.hc))}),a.b.set(c.getId(),c),a.g.oj(c))};$q.prototype.pa=function(a){return this.b.get(a)||null};
var oaa=function(a,c){var b=[];a.b.forEach(function(d){"available"==Em(d,c)&&b.push(d.Dc)});return new wq(b,naa[c])};$q.prototype.Ye=function(){return this.f};$q.prototype.Ca=function(){return"dial.DialSinkDiscoveryService"};$q.prototype.qb=function(){return[new paa(Array.from(this.b),this.f),{deviceCountMetricsRecordTime:this.h}]};
$q.prototype.ob=function(){var a=dm(this);if(a){for(var c=l(a.sinks),b=c.next();!b.done;b=c.next())b=b.value,this.b.set(b[0],Fm(b[1]));this.f=a.deviceCounts}if(a=em(this))this.h=a.deviceCountMetricsRecordTime};
var naa={YouTube:"https://tv.youtube.com https://tv-green-qa.youtube.com https://tv-release-qa.youtube.com https://web-green-qa.youtube.com https://web-release-qa.youtube.com https://www.youtube.com".split(" "),Netflix:["https://www.netflix.com"],Pandora:["https://www.pandora.com"],Radio:["https://www.pandora.com"],Hulu:["https://www.hulu.com"],Vimeo:["https://www.vimeo.com"],Dailymotion:["https://www.dailymotion.com"],"com.dailymotion":["https://www.dailymotion.com"]},kaa=/Eureka Dongle|Chromecast Audio|Chromecast Ultra/i,
paa=function(a,c){this.sinks=a;this.deviceCounts=c};var ar=function(a){return Promise.all(a.map(function(c){return c.then(function(b){return{ee:!0,value:b}},function(b){return{ee:!1,reason:b}})}))};var br=function(a,c){this.l=gb("mr.dial.AppDiscoveryService");this.b=new Set;this.f=a;this.w=c;this.j=new Map;this.m=new Map;this.g=null;this.h=!1};br.prototype.init=function(){gm(this)};br.prototype.start=function(){this.l.info("Starting periodic scanning.");this.h||(this.h=!0,cr(this))};br.prototype.stop=function(){this.l.info("Stopping periodic scanning.");this.h&&(this.h=!1,this.g&&(clearTimeout(this.g),this.g=null),this.j.clear())};
var cr=function(a){a.l.info("Start app status scan.");var c=[];Array.from(a.f.b.values()).forEach(function(b){c.push.apply(c,dr(a,b))});Array.from(a.w.b.values()).forEach(function(b){c.push(qaa(a,b))});ar(c).then(function(){a.h&&!a.g&&(nb(a.l,"Scan complete; scheduling for next scan."),a.g=setTimeout(function(){nb(a.l,"Start app status scan (timer-based)");a.g=null;cr(a)},6E4))})},dr=function(a,c){if(!c.He)return[];for(var b=[],d=l(a.b),e=d.next();!e.done;e=d.next())b.push(a.o(e.value,c));return b};
br.prototype.o=function(a,c){var b=this;if("unknown"!=Em(c,a)&&36E5>Date.now()-(c.Kh[a]||0)||!c.He)return Promise.resolve();nb(this.l,"Querying "+c.getId()+" for "+a+" to update app status");return er(this,c,a).then(function(d){a:if("Netflix"==d.name)d=!d.extraData||"websocket"!=d.extraData.capabilities||"running"!=d.state&&"stopped"!=d.state?"unavailable":"available";else switch(d.state){case "running":case "stopped":d="available";break a;default:d="unavailable"}fr(b,c,a,d)},function(d){d instanceof
Oq?fr(b,c,a,"unavailable"):(b.l.H("Failed to process app availability; "+c.getId()+" does not support app availability"),c.He=!1)})};
var qaa=function(a,c){var b=a.f.pa(c.Lc.sinkId);if(!b)return a.l.H("Activity refers to nonexistent sink: "+c.Lc.id),Promise.resolve();if(!b.He)return Promise.resolve();var d=c.appName;nb(a.l,"Querying "+b.getId()+" for "+d+" to update activity");return er(a,b,d).then(function(e){"running"!=e.state&&gr(a,b,d)},function(){return gr(a,b,d)})},raa=function(a,c){var b=a.m.get(c.getId());b||(b=new Qq(c),nb(a.l,"Created DIAL client for "+c.getId()),a.m.set(c.getId(),b));return b},er=function(a,c,b){var d=
saa(c,b),e=a.j.get(d);if(e)return e;e=Tq(raa(a,c),b);a.j.set(d,e);c=function(){a.j.delete(d)};e.then(c,c);return e},saa=function(a,c){return a.getId()+":"+c},fr=function(a,c,b,d){nb(a.l,"Got app status "+d+" from "+c.getId()+" for "+b);var e=Em(c,b);c.hc[b]=d;c.Kh[b]=Date.now();d!=e&&a.f.g.Oh(c)},gr=function(a,c,b){(c=Xq(a.w,c.getId()))&&c.appName==b&&Zq(a.w,c.Lc.id)},taa=function(a,c){return Array.from(a.f.b.values()).some(function(b){return"unknown"==Em(b,c)})};br.prototype.Ca=function(){return"dial.AppDiscoveryService"};
br.prototype.qb=function(){return[Array.from(this.b)]};br.prototype.ob=function(){var a=dm(this);this.b=new Set(a||[])};var hr=function(a,c){this.appName=a;this.launchParameter=void 0===c?"":c},jr=function(a){try{var c=new URL(a)}catch(b){return ir.info("Invalid URL: "+a),null}switch(c.protocol){case "dial:":a:if(a=c.pathname,a.match(/^\w+$/)){if(c=c.searchParams.get("postData")||void 0)try{c=sm(c)}catch(b){ir.H("Invalid base64 encoded postData:"+c);a=null;break a}a=new hr(a,c)}else ir.H("Invalid app name: "+a),a=null;return a;case "https:":return uaa(c);default:return nb(ir,"Unhandled protocol: "+c.protocol),null}},
uaa=function(a){var c=a.hash;if(!c)return null;a=(a=vaa.exec(c))?a[1]:null;if(!a)return null;a=decodeURIComponent(a);if(c=(c=waa.exec(c))?c[1]:void 0)try{c=sm(c)}catch(b){return ir.H("Invalid base64 encoded postData:"+c),null}return new hr(a,c)},ir=gb("mr.dial.PresentationUrl"),vaa=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,waa=/__dialPostData__=([A-Za-z0-9]+={0,2})/;var kr=function(a,c){this.h=a;this.f=c||new $q(this);this.g=new Vq(this);this.b=null;this.l=gb("mr.DialProvider")};h=kr.prototype;h.getName=function(){return"dial"};h.Ye=function(){return this.f.Ye()};h.initialize=function(a){a=a&&0==a.enable_dial_sink_query?!1:!0;this.l.info("Dial sink query enabled: "+a+"...");this.g.init();this.f.init();a?(this.b=this.b||new br(this.f,this.g),this.b.init()):this.b=null;Wq(this)};
h.Cg=function(a){if(!this.b)return xq;nb(this.l,"GetAvailableSinks for "+a);return(a=jr(a))?oaa(this.f,a.appName):xq};h.startObservingMediaSinks=function(a){if(this.b){var c=jr(a);if(c){a=this.b;c=c.appName;if(!a.b.has(c)||taa(a,c))a.b.add(c),0!=a.f.b.size&&(a.h?Array.from(a.f.b.values()).forEach(a.o.bind(a,c)):a.start());Wq(this)}}};h.stopObservingMediaSinks=function(a){this.b&&(a=jr(a))&&(this.b.b.delete(a.appName),lr(this))};h.startObservingMediaRoutes=function(){Wq(this)};
h.stopObservingMediaRoutes=function(){lr(this)};var lr=function(a){a.b&&(0==a.f.b.size||0==a.b.b.size&&0==a.g.b.size)&&a.b.stop()},Wq=function(a){a.b&&0<a.f.b.size&&(0<a.b.b.size||0<a.g.b.size)&&a.b.start()};h=kr.prototype;h.pa=function(a){return(a=this.f.pa(a))?a.Dc:null};h.Hd=function(){return this.g.Hd()};
h.createRoute=function(a,c,b,d){var e=this,f=this.f.pa(c);if(!f)return Kq(1),wi(Error("Unkown sink: "+c));Am().f=new xm(f.Bc,f.Yb());var g=jr(a);if(!g)return Kq(4),wi(Error("No app name set."));var k=g.appName,m=new Qq(f);return xi(Tq(m,k).then(function(p){if("running"==p.state)return Uq(m,k)}).then(function(){return m.launchApp(k,g.launchParameter)}).then(function(){Kq(0);return nr(e,c,a,k,b,d)}).catch(function(p){Kq(3);throw p;}))};h.joinRoute=function(){return wi(Error("Not supported"))};
h.connectRouteByRouteId=function(){return wi(Error("Not supported"))};h.detachRoute=function(){};var nr=function(a,c,b,d,e,f){c=Np(e,a.getName(),c,b,!0,d);c.offTheRecord=f;a.g.add(new jaa(c,d));return c};kr.prototype.oj=function(a){this.h.onSinkAvailabilityUpdated(this,1);this.b&&(Wq(this),dr(this.b,a));this.h.hd();Am().b=new xm(a.Bc,a.Yb())};
kr.prototype.pj=function(a){var c=this;if(0==this.f.b.size)this.h.onSinkAvailabilityUpdated(this,0);lr(this);a.forEach(function(b){var d=c.g;b=b.getId();if(b=Xq(d,b))d.b.delete(b.Lc.id),Yq(d.f,b)});this.h.hd()};kr.prototype.Oh=function(){this.h.hd()};var Yq=function(a,c){c=c.Lc;if(c.isLocal)a.h.onPresentationConnectionStateChanged(c.id,"terminated");lr(a);a.h.Mg(c)};h=kr.prototype;
h.terminateRoute=function(a){var c=this.g.b.get(a)||null;if(!c)return Lq(1),Promise.reject(new vq(3,"Route in DIAL provider not found for routeId "+a));Zq(this.g,a);a=this.f.pa(c.Lc.sinkId);return a?Uq(new Qq(a),c.appName).then(function(){Lq(0);return Promise.resolve()}).catch(function(b){Lq(3);return Promise.reject(b)}):(Lq(1),Promise.reject(new vq(3,"Sink in DIAL provider not found for sinkId "+c.Lc.sinkId)))};h.Lf=function(){throw Error("Not implemented.");};h.Kf=function(){return null};h.Uh=function(){};
h.sendRouteMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};h.sendRouteBinaryMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};h.sg=function(a,c){c=this.f.pa(c);return!c||hj(a)?!1:(a=jr(a))?"available"==Em(c,a.appName):!1};h.Df=function(){return!1};h.searchSinks=function(){return cb()};h.createMediaRouteController=function(){return cb()};h.provideSinks=function(a){maa(this.f,a)};var or=function(a){this.m=new $q(this);this.g=new Pm;this.f=a;this.w=this.j=0;this.h=new Ln;this.b=new kr(this,this.m)};h=or.prototype;h.Ca=function(){return"cast.DialProviderWrapper"};h.qb=function(){return[new xaa(Um(this.g),this.j,this.w,this.h.Ga())]};h.ob=function(){var a=dm(this);a&&(Om(this.g,a.f),this.j=a.sequenceNumber,this.w=a.g,Kn(this.h,a.b))};h.getName=function(){return this.b.getName()};h.initialize=function(a){this.b.initialize(a);gm(this)};h.Hd=function(){return this.b.Hd()};
h.Cg=function(a){return(a=pr(a))?this.b.Cg(a):xq};h.startObservingMediaSinks=function(a){(a=pr(a))&&this.b.startObservingMediaSinks(a)};h.stopObservingMediaSinks=function(a){(a=pr(a))&&this.b.stopObservingMediaSinks(a)};h.startObservingMediaRoutes=function(a){(a=pr(a))&&this.b.startObservingMediaRoutes(a)};h.stopObservingMediaRoutes=function(a){(a=pr(a))&&this.b.stopObservingMediaRoutes(a)};h.pa=function(a){return this.b.pa(a)};
var zaa=function(a,c,b,d,e){var f=pr(c);if(!f)return Kq(4),Promise.reject(Error("Invalid source"));var g=jr(f),k=a.m.pa(b);if(!k)return Kq(1),Promise.reject(Error("Attempting custom launch with closed route"));var m=g.appName;if(!m)return Kq(2),Promise.reject(Error("No app name given"));var p=yaa(c);return p?Tq(new Qq(k),m).then(function(u){var A=nr(a.b,b,c,m,e,d);u={routeId:A.id,sinkId:k.getId(),appName:m,ol:u,launchParameter:g.launchParameter,session:null,clientId:null};a.g.set(A.id,u);var F=qr(a,
u.sinkId),E=new eo("receiver_action",{receiver:F,action:chrome.cast.mg.CAST});E.clientId=p;a.f.ie(u.routeId,E);E=chrome.cast.ba;var J=String(a.w);a.w=(a.w+1)%9007199254740992;F=new E(J,"",u.appName,[],F);u.session=F;u.clientId=p;F=new eo("new_session",F);F.clientId=p;a.f.ie(u.routeId,F);return A}).catch(function(u){Kq(3);throw u;}):(Kq(2),Promise.reject(Error("No client ID")))};
or.prototype.createRoute=function(a,c,b,d,e,f,g){return a.startsWith("cast-dial:")||rr.test(a)?xi(zaa(this,a,c,d,b)):this.b.createRoute(a,c,b,d,e,f,g)};or.prototype.terminateRoute=function(a){var c=this.g.get(a);if(c&&c.session&&c.clientId){var b={receiver:qr(this,c.sinkId),action:chrome.cast.mg.STOP};b=new eo("receiver_action",b);b.clientId=c.clientId;this.f.ie(c.routeId,b);this.f.onPresentationConnectionStateChanged(c.routeId,"terminated")}return this.b.terminateRoute(a)};
or.prototype.sendRouteMessage=function(a,c,b){try{var d=JSON.parse(c)}catch(e){return Mq(1),Promise.reject(e)}switch(d.type){case "client_connect":return Mq(0),Aaa(this,a,d.clientId);case "custom_dial_launch":if(this.h.contains(d.sequenceNumber))return Mq(0),Baa(this,a,d).then(function(e){Kq(0);return e}).catch(function(e){Kq(3);throw e;});break;case "v2_message":if("STOP"==d.message.type)return Mq(0),this.terminateRoute(a),Promise.resolve()}Mq(2);return this.b.sendRouteMessage(a,c,b)};
or.prototype.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};
var Baa=function(a,c,b){a.h.remove(b.sequenceNumber);b=b.message;c=a.g.get(c);if(!c)return Promise.reject(Error("Unknown route"));if(b&&!b.doLaunch)return Promise.resolve();a=a.m.pa(c.sinkId);if(!a)return Promise.reject(Error("Custom launch response for sink that no longer exists"));a=new Qq(a);var d=c.launchParameter;d=(b?b.launchParameter:null)||d;return a.launchApp(c.appName,d)},qr=function(a,c){a=a.m.pa(c);c=Bm(Am(),c);c=new chrome.cast.ii(c,a.Dc.friendlyName);c.ipAddress=a.Yb();c.receiverType=
chrome.cast.ph.DIAL;return c},Aaa=function(a,c,b){c=a.g.get(c);if(!c)return Promise.reject(Error("Unknown route"));var d=qr(a,c.sinkId);d.receiverType=chrome.cast.ph.DIAL;d=new eo("custom_dial_launch",new chrome.cast.Fk(d,c.ol.state,c.ol.extraData));d.clientId=b;b=a.j;a.j=(a.j+1)%9007199254740992;d.sequenceNumber=b;a.h.add(d.sequenceNumber);a.f.ie(c.routeId,d);return Promise.resolve()};h=or.prototype;h.Lf=function(a){return this.b.Lf(a)};h.Kf=function(a){return this.b.Kf(a)};h.Uh=function(){};
h.sg=function(a,c){return a.startsWith("cast-dial:")||rr.test(a)||this.b.sg(a,c)};h.Df=function(a,c,b){return this.b.Df(a,c,b)};h.connectRouteByRouteId=function(a,c,b,d,e){return this.b.connectRouteByRouteId(a,c,b,d,e)};h.joinRoute=function(a,c,b,d,e,f){return this.b.joinRoute(a,c,b,d,e,f)};h.detachRoute=function(a){this.g.remove(a);this.b.detachRoute(a)};h.hd=function(){this.f.hd()};h.onSinkAvailabilityUpdated=function(a,c){this.f.onSinkAvailabilityUpdated(a,c)};
h.Xf=function(a,c){this.f.Xf(this,c)};h.Mg=function(a){this.f.Mg(a)};h.gf=function(a){this.f.gf(a)};h.Si=function(){};h.getMirroringServiceHostForTab=function(){};h.getMirroringServiceHostForDesktop=function(){};h.getMirroringServiceHostForOffscreenTab=function(){};h.ie=function(a,c){this.f.ie(a,c)};h.onPresentationConnectionStateChanged=function(a,c){this.f.onPresentationConnectionStateChanged(a,c)};h.onPresentationConnectionClosed=function(a,c,b){this.f.onPresentationConnectionClosed(a,c,b)};
h.Ki=function(a){return this.f.Ki(a)};h.Mi=function(){return this.f.Mi()};h.bf=function(a){this.f.bf(a)};h.Th=function(a,c){this.f.Th(a,c)};h.Vh=function(a){this.f.Vh(a)};h.oj=function(a){this.b.oj(a)};h.pj=function(a){this.b.pj(a)};h.Oh=function(a){this.b.Oh(a)};h.qj=function(){};h.um=function(){};h.searchSinks=function(a,c){return this.b.searchSinks(a,c)};h.provideSinks=function(a){this.b.provideSinks(a)};h.createMediaRouteController=function(){return cb()};
h.ag=function(a,c){return this.f.ag(a,c)};h.Ye=function(){return this.b.Ye()};
var pr=function(a){try{var c=new URL(a)}catch(e){return null}if("dial:"==c.protocol)return a;if("cast-dial:"==c.protocol){var b=c;a="cast-dial:"!=b.protocol?null:new mo(b.pathname,b.searchParams.get("dialPostData"),b.searchParams.get("clientId"));b=a.g;var d=a.b}else if("https:"==c.protocol){a=xo(a);if(!a)return null;b=a.s;d=a.D}b?(a=d||"",b=new URL("dial:"+b),a&&b.searchParams.set("postData",a),b=b.toString()):b=null;return b},yaa=function(a){try{var c=new URL(a)}catch(b){return null}return"cast-dial:"==
c.protocol?c.searchParams.get("clientId"):"https:"==c.protocol?yo(a):null},xaa=function(a,c,b,d){this.f=a;this.sequenceNumber=c;this.g=b;this.b=d},rr=/__dialAppName__/;var sr=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/,Caa=function(a,c){if(a){a=a.split("&");for(var b=0;b<a.length;b++){var d=a[b].indexOf("="),e=null;if(0<=d){var f=a[b].substring(0,d);e=a[b].substring(d+1)}else f=a[b];c(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}},tr=function(a,c,b){b=null!=b?"="+encodeURIComponent(String(b)):"";if(c+=b){b=a.indexOf("#");0>b&&(b=a.length);var d=a.indexOf("?");if(0>d||d>b){d=b;var e=
""}else e=a.substring(d+1,b);a=[a.substr(0,d),e,a.substr(b)];b=a[1];a[1]=c?b?b+"&"+c:c:b;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a},Daa=/#|$/,ur=function(a,c){var b=a.search(Daa);a:{var d=0;for(var e=c.length;0<=(d=a.indexOf(c,d))&&d<b;){var f=a.charCodeAt(d-1);if(38==f||63==f)if(f=a.charCodeAt(d+e),!f||61==f||38==f||35==f)break a;d+=e+1}d=-1}if(0>d)return null;e=a.indexOf("&",d);if(0>e||e>b)e=b;d+=c.length+1;return decodeURIComponent(a.substr(d,e-d).replace(/\+/g," "))},vr=function(a,c){var b=a.length-
1;0<=b&&a.indexOf("/",b)==b&&(a=a.substr(0,a.length-1));jd(c,"/")&&(c=c.substr(1));return re(a,"/",c)};var wr=function(a){this.yc=this.w=this.g="";this.Ka=null;this.h=this.b="";this.j=!1;var c;a instanceof wr?(this.j=Ia(void 0)?void 0:a.j,xr(this,a.g),this.w=a.w,this.yc=a.yc,yr(this,a.Fb()),this.b=a.b,zr(this,a.f.clone()),this.h=a.h):a&&(c=String(a).match(sr))?(this.j=!1,xr(this,c[1]||"",!0),this.w=Ar(c[2]||""),this.yc=Ar(c[3]||"",!0),yr(this,c[4]),this.b=Ar(c[5]||"",!0),zr(this,c[6]||"",!0),this.h=Ar(c[7]||"")):(this.j=!1,this.f=new Br(null,this.j))};
wr.prototype.toString=function(){var a=[],c=this.g;c&&a.push(Cr(c,Dr,!0),":");var b=this.yc;if(b||"file"==c)a.push("//"),(c=this.w)&&a.push(Cr(c,Dr,!0),"@"),a.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.Fb(),null!=b&&a.push(":",String(b));if(b=this.b)this.yc&&"/"!=b.charAt(0)&&a.push("/"),a.push(Cr(b,"/"==b.charAt(0)?Eaa:Faa,!0));(b=this.f.toString())&&a.push("?",b);(b=this.h)&&a.push("#",Cr(b,Gaa));return a.join("")};
wr.prototype.resolve=function(a){var c=this.clone(),b=!!a.g;b?xr(c,a.g):b=!!a.w;b?c.w=a.w:b=!!a.yc;b?c.yc=a.yc:b=null!=a.Ka;var d=a.b;if(b)yr(c,a.Fb());else if(b=!!a.b){if("/"!=d.charAt(0))if(this.yc&&!this.b)d="/"+d;else{var e=c.b.lastIndexOf("/");-1!=e&&(d=c.b.substr(0,e+1)+d)}e=d;if(".."==e||"."==e)d="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){d=jd(e,"/");e=e.split("/");for(var f=[],g=0;g<e.length;){var k=e[g++];"."==k?d&&g==e.length&&f.push(""):".."==k?((1<f.length||1==f.length&&""!=
f[0])&&f.pop(),d&&g==e.length&&f.push("")):(f.push(k),d=!0)}d=f.join("/")}else d=e}b?c.b=d:b=""!==a.f.toString();b?zr(c,a.f.clone()):b=!!a.h;b&&(c.h=a.h);return c};wr.prototype.clone=function(){return new wr(this)};var xr=function(a,c,b){a.g=b?Ar(c,!0):c;a.g&&(a.g=a.g.replace(/:$/,""))};wr.prototype.Fb=function(){return this.Ka};
var yr=function(a,c){if(c){c=Number(c);if(isNaN(c)||0>c)throw Error("Bad port number "+c);a.Ka=c}else a.Ka=null},zr=function(a,c,b){c instanceof Br?(a.f=c,Haa(a.f,a.j)):(b||(c=Cr(c,Iaa)),a.f=new Br(c,a.j))},Ar=function(a,c){return a?c?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},Cr=function(a,c,b){return Ja(a)?(a=encodeURI(a).replace(c,Jaa),b&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},Jaa=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},
Dr=/[#\/\?@]/g,Faa=/[#\?:]/g,Eaa=/[#\?]/g,Iaa=/[#\?@]/g,Gaa=/#/g,Br=function(a,c){this.f=this.b=null;this.g=a||null;this.h=!!c},Er=function(a){a.b||(a.b=new Pm,a.f=0,a.g&&Caa(a.g,function(c,b){a.add(decodeURIComponent(c.replace(/\+/g," ")),b)}))},Gr=function(a){var c=Fn(a);if("undefined"==typeof c)throw Error("Keys are undefined");var b=new Br(null,void 0);a=En(a);for(var d=0;d<c.length;d++){var e=c[d],f=a[d];Ta(f)?Fr(b,e,f):b.add(e,f)}return b};h=Br.prototype;h.za=function(){Er(this);return this.f};
h.add=function(a,c){Er(this);this.g=null;a=Hr(this,a);var b=this.b.get(a);b||this.b.set(a,b=[]);b.push(c);this.f+=1;return this};h.remove=function(a){Er(this);a=Hr(this,a);return Sm(this.b,a)?(this.g=null,this.f-=this.b.get(a).length,this.b.remove(a)):!1};h.clear=function(){this.b=this.g=null;this.f=0};h.Ub=function(){Er(this);return 0==this.f};var Ir=function(a,c){Er(a);c=Hr(a,c);return Sm(a.b,c)};h=Br.prototype;h.Ff=function(a){var c=this.Ga();return Ub(c,a)};
h.forEach=function(a,c){Er(this);this.b.forEach(function(b,d){Kb(b,function(e){a.call(c,e,d,this)},this)},this)};h.Jb=function(){Er(this);for(var a=this.b.Ga(),c=this.b.Jb(),b=[],d=0;d<c.length;d++)for(var e=a[d],f=0;f<e.length;f++)b.push(c[d]);return b};h.Ga=function(a){Er(this);var c=[];if(Ja(a))Ir(this,a)&&(c=dc(c,this.b.get(Hr(this,a))));else{a=this.b.Ga();for(var b=0;b<a.length;b++)c=dc(c,a[b])}return c};
h.set=function(a,c){Er(this);this.g=null;a=Hr(this,a);Ir(this,a)&&(this.f-=this.b.get(a).length);this.b.set(a,[c]);this.f+=1;return this};h.get=function(a,c){if(!a)return c;a=this.Ga(a);return 0<a.length?String(a[0]):c};var Fr=function(a,c,b){a.remove(c);0<b.length&&(a.g=null,a.b.set(Hr(a,c),y(b)),a.f+=b.length)};
Br.prototype.toString=function(){if(this.g)return this.g;if(!this.b)return"";for(var a=[],c=this.b.Jb(),b=0;b<c.length;b++){var d=c[b],e=encodeURIComponent(String(d));d=this.Ga(d);for(var f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}}return this.g=a.join("&")};Br.prototype.clone=function(){var a=new Br;a.g=this.g;this.b&&(a.b=this.b.clone(),a.f=this.f);return a};
var Hr=function(a,c){c=String(c);a.h&&(c=c.toLowerCase());return c},Haa=function(a,c){c&&!a.h&&(Er(a),a.g=null,a.b.forEach(function(b,d){var e=d.toLowerCase();d!=e&&(this.remove(d),Fr(this,e,b))},a));a.h=c};Br.prototype.extend=function(a){for(var c=0;c<arguments.length;c++)Hn(arguments[c],function(b,d){this.add(d,b)},this)};var Kaa=function(a,c){this.input=a;this.domain=c};var Jr=function(a){this.b=a;this.l=gb("mr.ExternalMessageHandler")};
Jr.prototype.onMessage=function(a,c,b){var d=this;this.l.info("Received a message from "+c.id+" type: "+a.type);var e=chrome.runtime.id;"start"==a.type?(a=a.message,this.b.searchSinks("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new Kaa(a.meetingName,a.domain)).then(function(f){var g="PresentationId"+c.id+Laa++;d.b.createRoute("urn:x-org.chromium.media:source:desktop",f,g).then(function(k){b(new qf(e,"route",k.id))}).catch(function(k){b(new qf(e,"error",k))})},function(){b(new qf(e,"error",
Error("Failed to find sink.")))})):"stop"==a.type?this.b.terminateRoute(a.message.routeId).then(function(){b(new qf(e,"stopped"))}):"subscribe_log_data"==a.type?(ib.push(function(f){chrome.runtime.sendMessage(c.id,new qf(e,"log_message",f))}),b(new qf(e,"subscribed"))):(b(new qf(e,"error",Error("Unhandled message type"))),this.l.error("Unhandled message type "+a.type))};var Laa=0;var Kr=function(){this.b=[];this.f=[]};h=Kr.prototype;h.enqueue=function(a){if(1E3<=this.za()){if(this.Ub())throw Error("Empty queue");0==this.b.length&&(this.b=this.f,this.b.reverse(),this.f=[]);this.b.pop()}this.f.push(a)};h.za=function(){return this.b.length+this.f.length};h.Ub=function(){return 0==this.za()};h.Ga=function(){var a=this.b.slice();a.reverse();a.push.apply(a,n(this.f));return a};h.clear=function(){this.b=[];this.f=[]};var Lr=function(){this.b=new Kr;this.f=Date.now()},Nr=function(){null==Mr&&(Mr=new Lr);return Mr};
Lr.prototype.init=function(){hb=1;var a=gb("browser"),c=window.onerror;window.onerror=function(d,e,f,g,k){try{var m=k.result.error.errors[0];if("usageLimits"==m.domain&&"accessNotConfigured"==m.reason)return!0}catch(p){}c&&c(d,e,f,g,k);a.error("Error: "+d+" ("+e+" @ Line: "+f+")",k)};ib.push(this.h.bind(this));var b=window.localStorage["debug.logs"];b&&(hb=pb(b.toUpperCase()));(b=window.localStorage["debug.console"])&&"false"!=b.toLowerCase()&&ib.push(this.g.bind(this))};
Lr.prototype.h=function(a){this.b.enqueue(Or(this,a,!1));a=a.Jc;a instanceof Error&&a.stack&&this.b.enqueue(a.stack)};Lr.prototype.g=function(a){var c=[Or(this,a,!0)];a.Jc&&c.push(a.Jc);switch(a.level){case 3:console.error.apply(console,n(c));break;case 2:console.warn.apply(console,n(c));break;case 1:console.log.apply(console,n(c));break;default:console.debug.apply(console,n(c))}};
var Or=function(a,c,b){var d=["["];if(b)d.push(("       "+((Date.now()-a.f)/1E3).toFixed(3)).slice(-7));else{a=new Date(c.time);var e=function(f){return 10>f?"0"+f:f};d.push(a.getFullYear().toString(),"-",e(a.getMonth()+1),"-",e(a.getDate())," ",e(a.getHours()),":",e(a.getMinutes()),":",e(a.getSeconds()),".",e(Math.floor(a.getMilliseconds()/10)))}d.push("][",ob[c.level],"][",c.R,"] ",c.message);if(!b&&null!=c.Jc)if(d.push("\n"),c.Jc instanceof Error)d.push(c.Jc.message);else try{d.push(JSON.stringify(c.Jc))}catch(f){d.push(c.Jc.toString())}d.push("\n");
return d.join("")},Maa=function(){var a=Nr();return 0==a.b.za()?"NA":a.b.Ga().join("")},Naa=function(){var a=Nr();gm(a)};Lr.prototype.Ca=function(){return"LogManager"};Lr.prototype.qb=function(){return[this.b.Ga()]};Lr.prototype.ob=function(){var a=this.b.Ga();this.b.clear();for(var c=l(dm(this)||[]),b=c.next();!b.done;b=c.next())this.b.enqueue(b.value);a=l(a);for(b=a.next();!b.done;b=a.next())this.b.enqueue(b.value)};var Mr=null;var Pr=function(a){this.b=a;this.l=gb("mr.InternalMessageHandler")};
Pr.prototype.onMessage=function(a,c,b){var d=this;if("retrieve_log_data"!=a.type)b(new qf(chrome.runtime.id,"error",Error("Unhandled message type")));else{var e={logs:Maa(),device:Cm()};c=[];var f=pf(e.device.ip).then(function(k){k.b&&(e.device.version=k.b)});c.push(f);var g=this.b.s;g&&(a=Oaa(this,g,a.source).then(function(k){k&&(e.castStreamingLogs=k)},function(){d.l.error("Log upload failed for service: "+g)}),c.push(a));e.dialDeviceCounts=Paa(this);c.push(Qaa(this,e));a=this.b.getMediaSinkServiceStatus().then(function(k){e.mediaSinkServiceStatus=
k.status},function(){d.l.error("Fail to get media sink service status")});c.push(a);this.b.config&&(e.mirroringServiceEnabled=this.b.config.use_mirroring_service,e.nativeCastMrpEnabled=!this.b.config.enable_cast_sink_query,e.nativeDialMrpEnabled=!this.b.config.enable_dial_sink_query);ar(c).then(function(){b(e)})}};
var Qaa=function(a,c){return Wi("mr.cast.SinkDiscoveryService").then(function(b){b=b.Ye();c.castDeviceCounts=b.Hg+"."+b.qg},function(){a.l.error("Failed to get device counts for castDeviceCounts.")})},Paa=function(a){a=Qr(a.b,"dial");if(!a)return"";a=a.Ye();return a.Hg+"."+a.qg},Oaa=function(a,c,b){return Rr(a.b,c).then(function(d){return d.Dj(b)})};var Raa={ACCEPTED:0,bv:1,TIMEOUT:2},Saa={SUCCESS:0,rv:1},Taa={up:0,Ro:1,HA:2,Sv:3,Rv:4,hx:5,TIMEOUT:6,yy:7},Uaa={Pv:0,Mz:1},Vaa={Zx:0,Nw:1,USER:2,Kv:3},Sr=function(a){Bb("MediaRouter.Cloud.Knock.Result",a,Raa)},Tr=function(a){Bb("MediaRouter.Cloud.Session.Start",a,Saa)},Ur=function(a){Bb("MediaRouter.Cloud.Session.Type",a,Uaa)},Vr=function(a){Bb("MediaRouter.Cloud.Device.UserRole",a,Vaa)};var Wr=function(a,c){this.b=a;this.f=c},Xr=new Wr("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Waa=new Wr("https://castedumessaging-pa.googleapis.com/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Xaa=new Wr("https://www.googleapis.com/calendar/v3",""),Yaa=new Wr("https://www.googleapis.com/hangouts/v1",""),Yr=new Wr("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var Zr=function(a,c,b,d,e,f){b=void 0===b?null:b;a||null==b&&(b="default");this.jm=a;this.Ja=c;this.yc=b;this.Sf=void 0===d?null:d;this.ad=void 0===e?null:e;this.kf=void 0===f?null:f};Zr.prototype.f=function(){var a="";this.ad?a=this.ad:this.Sf&&(a=this.Sf);return a};Zr.prototype.Nd=function(){return this.jm};Zr.prototype.getId=function(){return this.Ja};Zr.prototype.merge=function(a){!this.kf&&a.kf&&(this.kf=a.kf);!this.ad&&a.ad&&(this.ad=a.ad);this.ad&&a.ad&&this.kf&&(this.ad=a.ad)};var $r=function(a,c){this.f=a;this.g=c;this.l=gb("mr.cloud.calendar.CalendarService")},aba=function(a){return Zaa(a,a.g.b).then(function(c){a.l.info(as(c.length)+" events discovered before filtering.");return $aa(a,c)},function(c){a.l.H("Error getting Hangouts from calendar.",c);return[]})},as=function(a){return 20<a?"20+":a.toString()},Zaa=function(a,c){var b=Date.now();return bba(a,c,new Date(b),new Date(b+9E5)).then(function(d){return d.filter(a.b)})};
$r.prototype.b=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};
var bba=function(a,c,b,d){c=bs(Xaa.b,["calendars",c,"events"],{timeMin:b.toJSON(),timeMax:d.toJSON(),singleEvents:!0});nb(a.l,"Retrieving Hangouts from Calendar: "+c);return cs(a.f,c,"GET").then(function(e){return e.items?e.items:[]})},$aa=function(a,c){var b=[];c.filter(function(d){return d.hangoutLink}).forEach(function(d){var e=new wr(d.hangoutLink);if("meet.google.com"==e.yc)b.push(new Zr(!0,e.b.substring(1),void 0,void 0,d.summary));else if(e=e.b.substring(12).split("/"),2==e.length){var f=l(e);
e=f.next().value;f=f.next().value;if(-1!=e.indexOf(".")){var g=f;var k=e}b.push(new Zr(!1,f+"@"+e,k,g,d.summary,void 0))}else a.l.H("Invalid hangout link from calendar event: "+d.hangoutLink)});a.l.info(as(b.length)+" events discovered with Hangout links.");return b};var ds=function(a){this.b=a;this.id=a.id;this.l=gb("mr.cloud.devices.WeaveDevice")};ds.prototype.isAvailable=function(){if(this.getState().appStatus){var a="online"==this.b.connectionStatus,c="available"==this.getState().appStatus,b=es(this,864E5);nb(this.l,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+c+", checked in: "+b);return a&&c&&b}a=es(this,9E5);this.l.info("Availability for legacy receiver app: "+a);return a};
var es=function(a,c){a=a.b.lastUpdateTimeMs?Number(a.b.lastUpdateTimeMs):null;return!!(a&&a>Date.now()-c)};ds.prototype.f=function(){return this.getState().settings.receiverName};ds.prototype.getId=function(){return this.id};ds.prototype.getState=function(){return this.b.state._cloudCast};var fs=function(){this.l=Mf("mr.cloud.GcmRegistrationSerializer");this.b=Promise.resolve("")};fs.prototype.register=function(a){var c=this,b=function(){return new Promise(function(d,e){chrome.gcm.register(a,function(f){f?(c.l.info("Got GCM registration ID: "+f),d(f)):e(Error(chrome.runtime.lastError&&chrome.runtime.lastError.message||"unknown error"))})})};return this.b=this.b.then(b,b)};var cba=function(a){this.email=a;this.imageUrl=null},dba=function(a){this.type=a},gs=function(a,c,b,d){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=c||null;this.flungUrl=b||null;this.presentationId=d||null};q(gs,dba);
var hs=function(a,c,b){this.name=a;this.parameters=c;this.minimalRole=null!=b?b:"user"},is={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},eba=new hs("_knockingStartWebrtcSession",is,"viewer"),fba=new hs("_startWebrtcSession",is),gba=new hs("_stopSession",{},"viewer");var js=function(a,c){this.j=a;this.w=c;this.f=this.g=this.b=null;this.h=!1;this.l=gb("mr.cloud.devices.WeaveDevicesService");gm(this)};js.prototype.getDevice=function(a){a=bs(Xr.b,["devices",a]);return cs(this.j,a,"GET").then(function(c){return new ds(c)})};
var hba=function(a){return ks(a,{descriptionSubstring:"Chrome Streaming Receiver"}).catch(function(){return[]})},ks=function(a,c){var b=bs(Xr.b,["devices"],c);return cs(a.j,b,"GET").then(function(d){var e=(d.devices||[]).filter(function(g){return null!=g.commandDefs&&null!=g.commandDefs._cloudCast}).map(function(g){return new ds(g)});if(d=d.nextPageToken){var f=Mc(c);f.token=d;return ks(a,f).then(function(g){return e.concat(g)})}return e})};js.prototype.Ca=function(){return"WeaveDevicesService"};
js.prototype.qb=function(){return[new iba(this.b,this.f,this.g)]};js.prototype.ob=function(){var a=dm(this);a&&(this.b=a.br,this.f=a.gcmRegistrationId,this.g=a.ar)};var jba=function(a){return a.f&&null!=a.g&&a.g+864E5>=Date.now()?Promise.resolve(a.f):a.w.register(["919648714761"]).then(function(c){nb(a.l,"Got GCM ID: "+c);a.f=c;a.g=Date.now();a.b=null;return c},function(c){a.l.H("Error",c);a.f=null;a.g=null;a.b=null;throw c;})};
js.prototype.subscribe=function(a){var c=this;if(this.h)return Promise.resolve();this.h=!0;if(!a||this.b&&!(this.b+864E5<Date.now()))return Promise.resolve();a={filters:["myDevices"],gcmRegistrationId:a,gcmSenderId:"919648714761",expirationTimeMs:864E5};var b=bs(Xr.b,["subscriptions","subscribe"],{});return cs(this.j,b,"POST",a).then(function(){nb(c.l,"Subscribed on: "+Date.now());c.b=Date.now();c.h=!1;return Promise.resolve()},function(){c.h=!1;return Promise.resolve()})};
var iba=function(a,c,b){this.br=a;this.gcmRegistrationId=c;this.ar=b};var ls=function(a,c,b,d,e,f,g,k){var m=Bm(Am(),a);this.sb=new $l(m,c,g,k,e);this.deviceId=a;this.b=b;this.model=d;this.isAvailable=f};ca.Object.defineProperties(ls.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.sb.id}},displayName:{configurable:!0,enumerable:!0,set:function(a){this.sb.friendlyName=a}}});var ms=function(a,c,b,d,e){ls.call(this,a,c,"weave","Chrome Streaming Receiver",d,e,"education");this.si=b};q(ms,ls);
var ns=function(a){var c=a.yc,b;a.Sf&&a.f()!=a.Sf&&(b=a.Sf);ls.call(this,a.getId(),a.f(),"mesi","Hangout",c,!1,a.Nd()?"meeting":"hangout",b);this.Nd=a.Nd();this.fh=a.kf||""};q(ns,ls);var os=function(a,c,b){ls.call(this,a,c,"slarti","Cast Receiver for Education","default",b,"education")};q(os,ls);var ps=function(a,c,b){this.w=a;this.h=c;this.b=new Map;this.g=new Map;this.f=null;this.j=b};ps.prototype.je=function(){var a=this.f+this.j;if(null==this.f||a<Date.now())this.f=Date.now(),kba(this);return Array.from(this.b.values())};ps.prototype.pa=function(a){return this.b.get(a)||null};
var kba=function(a){a.w().then(function(c){lba(a,c)})},lba=function(a,c){var b=new Map(a.b),d=new Map,e=new Map,f=[],g=[];c.forEach(function(k){var m=k.id;d.set(m,k);e.set(m,k.deviceId);b.has(m)?b.has(m)&&JSON.stringify(b.get(m))!=JSON.stringify(k)&&g.push(k.sb):f.push(k.sb);b.delete(m)});c=[].concat(n(b.values())).map(function(k){return k.sb});a.g.clear();a.g=e;a.b.clear();a.b=d;mba(a,f,g,c)},mba=function(a,c,b,d){0<c.length&&qs(a.h,c);0<b.length&&rs(a.h,b);0<d.length&&ss(a.h,d)},ts=function(a){for(var c=
{},b=l(a.b.entries()),d=b.next();!d.done;d=b.next()){var e=l(d.value);d=e.next().value;e=e.next().value;c[d]=e}b={};d=l(a.g.entries());for(e=d.next();!e.done;e=d.next()){var f=l(e.value);e=f.next().value;f=f.next().value;b[e]=f}return new nba(c,b,a.f)},us=function(a,c){for(var b in c.sinks){var d=c.sinks[b],e=null;"Hangout"==d.model?e=new ns(new Zr(d.Nd,d.deviceId,d.sb.domain,d.sb.description,d.sb.friendlyName,d.fh)):"Cast Receiver for Education"==d.model?e=new os(d.deviceId,d.sb.friendlyName,d.isAvailable):
"Chrome Streaming Receiver"==d.model&&(e=new ms(d.deviceId,d.sb.friendlyName,d.si,d.sb.domain,d.isAvailable));a.b.set(b,e)}for(b in c.b)a.g.set(b,c.b[b]);c.f&&(a.f=c.f)},nba=function(a,c,b){this.sinks=a;this.b=c;this.f=b};var ws=function(a,c,b){if(!vs){Lf();var d=Kf;d.f=Gf;var e=oba;d.b||(d.b=[]);d.b.push(e);vs=!0}this.g=a;this.h=c;this.b=new ps(this.j.bind(this),b,2E4);this.f=new Map;gm(this)},oba=function(a){jb({R:a.g,level:qb(a.f.value),time:a.j,message:a.getMessage(),Jc:a.b})};ws.prototype.je=function(){return this.b.je()};ws.prototype.pa=function(a){return this.b.pa(a)};
ws.prototype.j=function(){var a=this;this.l.info("Fetching hangouts");return ar([pba(this.h),aba(this.g)]).then(function(c){var b=Array.from(a.f.values());c.forEach(function(e){e.ee?b=b.concat(e.value):a.l.error("Error discovering Hangouts",e.reason)});var d=b.reduce(function(e,f){var g=e[f.getId()];g?g.merge(f):g=f;e[g.getId()]=g;return e},{});return Object.keys(d).map(function(e){e=d[e];Ab("MediaRouter.Cloud.Hangout.Sink.Discovered");return new ns(e)})})};
var qba=function(a,c){return Wi("mr.mirror.hangouts.MeetingsService").then(function(b){return b.Zb(c)}).then(function(b){return xs(a,b)},function(){return c.input.match(/^#/)?Promise.reject(Error("Failed to resolve meeting alias.")):xs(a,c.input,c.domain)})},xs=function(a,c,b){b=b||void 0;var d=!b;c=new Zr(d,d?c:c+"@"+b,b,c,void 0,void 0);a.f.set(c.getId(),c);c=new ns(c);a.b.b.set(c.id,c);return c.sb};ws.prototype.Ca=function(){return"HangoutSinkDiscoveryService"};
ws.prototype.qb=function(){for(var a={},c=l(this.f.entries()),b=c.next();!b.done;b=c.next()){var d=l(b.value);b=d.next().value;d=d.next().value;a[b]=d}return[{cache:ts(this.b),manualHangouts:a}]};ws.prototype.ob=function(){var a=dm(this);if(a){us(this.b,a.cache);for(var c in a.manualHangouts){var b=a.manualHangouts[c];this.f.set(c,new Zr(b.jm,b.Ja,b.yc,b.Sf,b.ad,b.kf))}}};ws.prototype.l=gb("mr.cloud.discovery.HangoutSinkDiscoveryService");var vs=!1;var zs=function(){this.f=!1;this.b=null;this.g=!1;this.l=gb("mr.cloud.identity.IdentityService");gm(this);rba(this);ys(this)},As=function(a){return a.b?a.b.substr(a.b.indexOf("@")+1):""};
zs.prototype.getAuthToken=function(){return chrome.identity?new Promise(function(a,c){chrome.identity.getAuthToken({interactive:!1},function(b){chrome.runtime.lastError?c(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==b?c(Error("User is not logged in (no token found)")):a(b)})}):Promise.reject(Error("chrome.identity permission required for auth."))};
var sba=function(a){return new Promise(function(c){chrome.identity.removeCachedAuthToken({token:a},function(){c()})})},ys=function(a){a.getAuthToken().then(function(c){chrome.identity.getProfileUserInfo(function(b){a.f=!!b.email||!!b.id;a.b=b.email||null;c&&!a.f&&(a.g=!0)})},function(c){nb(a.l,"Unable to set sign in and email.",c)})},rba=function(a){chrome.identity.onSignInChanged.addListener(function(c,b){ej(6);a.f=b;a.l.info("Signed in change: "+a.f);a.f?ys(a):(a.b=null,a.g=!1)})},tba=function(a){return a.getAuthToken().then(function(c){var b=
window.gapi;if(!b)return a.l.error("gapi not loaded."),!1;a.l.info("Setting gapi auth token");b.auth.setToken({access_token:c});return!0})};zs.prototype.Ca=function(){return"IdentityService"};zs.prototype.qb=function(){return[null,{signedIn:this.f,userEmail:this.b,kioskAuth:this.g}]};zs.prototype.ob=function(){var a=em(this);a&&(a.signedIn&&(this.f=a.signedIn),a.userEmail&&(this.b=a.userEmail),a.kioskAuth&&(this.g=a.kioskAuth))};var Bs="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");var Cs=function(a){var c=a.method,b=a.uri,d=a.baseUrl,e=a.Mc,f=a.dn,g=a.headers,k=a.body,m=a.start,p=a.apiKey,u=a.gh;a=a.nb;this.method=c&&c.toUpperCase()||"GET";(c=b)||(d=[d].concat(n(e||[])).join("/"),d=new wr(encodeURI(d)),f&&(f=Gr(f),zr(d,f)),c=d);this.uri=c;p&&this.uri.f.add("key",p);this.b=a||null;this.headers=g||{};(this.body=k)&&(this.headers["Content-Type"]="application/json");this.gh=void 0!==u?u:1E4;this.start=m||v()},uba=function(a){return(a.b?a.b.getAuthToken():Promise.resolve(null)).then(function(c){c&&
(a.headers.Authorization="Bearer "+c);c={method:a.method,headers:a.headers};a.body&&(c.body=JSON.stringify(a.body));return new Request(a.uri.toString(),c)})};var vba={Su:100,Qz:101,Vx:200,Tu:201,ACCEPTED:202,zx:203,Mx:204,Sy:205,gy:206,nx:207,mx:300,jx:301,yv:302,pz:303,Jx:304,BA:305,Tz:307,ny:308,Un:400,nA:401,Co:402,xv:403,Fx:404,dx:405,Cx:406,Cy:407,Qy:408,Ou:409,Iv:410,Jw:411,vy:412,Ny:413,Ry:414,uA:415,Py:416,lv:417,tA:422,Mw:423,mv:424,wy:428,Wz:429,Oy:431,so:500,Gx:501,bu:502,xz:503,Dv:504,Yv:505,kw:507,tx:511,Fy:1223};var Ds=function(a,c){Db.call(this,c&&c.message||a.statusText);this.code=a.status;this.response=a;this.status=(this.b=c)&&c.status};q(Ds,Db);var zba=function(a){if(wba.has(a.code))return!0;var c=a.b||{};return a.b?xba.has(c.status)?!0:!!(c.errors||[]).find(function(b){return yba.has(b)}):!1},Es=function(a,c){a=new Response(void 0,{status:c||408,statusText:a});return new Ds(a)},wba=new Set([400,401,403,404,405,406,501]),xba=new Set(["PERMISSION_DENIED"]),yba=new Set("authError command_is_in_terminal_state forbidden notFound unmanaged_group_acl acl_entry_bad_scope network_error".split(" "));var W=function(){this.Tc=this.Tc;this.jb=this.jb};W.prototype.Tc=!1;W.prototype.w=function(){return this.Tc};W.prototype.lb=function(){this.Tc||(this.Tc=!0,this.fa())};W.prototype.b=function(a){Fs(this,bb(Gs,a))};var Fs=function(a,c){a.Tc?Ia(void 0)?c.call(void 0):c():(a.jb||(a.jb=[]),a.jb.push(Ia(void 0)?t(c,void 0):c))};W.prototype.fa=function(){if(this.jb)for(;this.jb.length;)this.jb.shift()()};
var Gs=function(a){a&&"function"==typeof a.lb&&a.lb()},Hs=function(a){for(var c=0,b=arguments.length;c<b;++c){var d=arguments[c];Ua(d)?Hs.apply(null,d):Gs(d)}};var Is=function(){this.id="Oa"};Is.prototype.toString=function(){return this.id};var X=function(a,c){this.type=a instanceof Is?String(a):a;this.f=this.target=c;this.kn=!0};X.prototype.h=function(){this.kn=!1};var Js=!Be||9<=Number(Xe),Aba=Be&&!We("9"),Bba=function(){if(!Ha.addEventListener||!Object.defineProperty)return!1;var a=!1,c=Object.defineProperty({},"passive",{get:function(){a=!0}});try{Ha.addEventListener("test",Pa,c),Ha.removeEventListener("test",Pa,c)}catch(b){}return a}();var Ks=function(a,c){X.call(this,a?a.type:"");this.relatedTarget=this.f=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType="";this.b=null;a&&this.init(a,c)};x(Ks,X);var Cba=vf({2:"touch",3:"pen",4:"mouse"});
Ks.prototype.init=function(a,c){var b=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.f=c;(c=a.relatedTarget)?Ee&&(we(c,"nodeName")||(c=null)):"mouseover"==b?c=a.fromElement:"mouseout"==b&&(c=a.toElement);this.relatedTarget=c;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:
a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType=Ja(a.pointerType)?a.pointerType:Cba[a.pointerType]||"";this.state=a.state;this.b=a;a.defaultPrevented&&this.h()};
Ks.prototype.h=function(){Ks.ub.h.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Aba)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(c){}};var Ls="closure_listenable_"+(1E6*Math.random()|0),Ms=function(a){return!(!a||!a[Ls])},Dba=0;var Eba=function(a,c,b,d,e){this.listener=a;this.proxy=null;this.src=c;this.type=b;this.capture=!!d;this.Yc=e;this.key=++Dba;this.removed=this.uh=!1},Ns=function(a){a.removed=!0;a.listener=null;a.proxy=null;a.src=null;a.Yc=null};var Os=function(a){this.src=a;this.b={};this.f=0};Os.prototype.add=function(a,c,b,d,e){var f=a.toString();a=this.b[f];a||(a=this.b[f]=[],this.f++);var g=Ps(a,c,d,e);-1<g?(c=a[g],b||(c.uh=!1)):(c=new Eba(c,this.src,f,!!d,e),c.uh=b,a.push(c));return c};Os.prototype.remove=function(a,c,b,d){a=a.toString();if(!(a in this.b))return!1;var e=this.b[a];c=Ps(e,c,b,d);return-1<c?(Ns(e[c]),$b(e,c),0==e.length&&(delete this.b[a],this.f--),!0):!1};
var Qs=function(a,c){var b=c.type;if(!(b in a.b))return!1;var d=ac(a.b[b],c);d&&(Ns(c),0==a.b[b].length&&(delete a.b[b],a.f--));return d};Os.prototype.removeAll=function(a){a=a&&a.toString();var c=0,b;for(b in this.b)if(!a||b==a){for(var d=this.b[b],e=0;e<d.length;e++)++c,Ns(d[e]);delete this.b[b];this.f--}return c};var Rs=function(a,c,b,d,e){a=a.b[c.toString()];c=-1;a&&(c=Ps(a,b,d,e));return-1<c?a[c]:null};
Os.prototype.hasListener=function(a,c){var b=Ia(a),d=b?a.toString():"",e=Ia(c);return Cc(this.b,function(f){for(var g=0;g<f.length;++g)if(!(b&&f[g].type!=d||e&&f[g].capture!=c))return!0;return!1})};var Ps=function(a,c,b,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.listener==c&&f.capture==!!b&&f.Yc==d)return e}return-1};var Ss="closure_lm_"+(1E6*Math.random()|0),Ts={},Us=0,Ws=function(a,c,b,d,e){if(d&&d.once)return Vs(a,c,b,d,e);if(Ta(c)){for(var f=0;f<c.length;f++)Ws(a,c[f],b,d,e);return null}b=Xs(b);return Ms(a)?a.listen(c,b,Wa(d)?!!d.capture:!!d,e):Ys(a,c,b,!1,d,e)},Ys=function(a,c,b,d,e,f){if(!c)throw Error("Invalid event type");var g=Wa(e)?!!e.capture:!!e,k=Zs(a);k||(a[Ss]=k=new Os(a));b=k.add(c,b,d,g,f);if(b.proxy)return b;d=Fba();b.proxy=d;d.src=a;d.listener=b;if(a.addEventListener)Bba||(e=g),void 0===e&&
(e=!1),a.addEventListener(c.toString(),d,e);else if(a.attachEvent)a.attachEvent($s(c.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");Us++;return b},Fba=function(){var a=Gba,c=Js?function(b){return a.call(c.src,c.listener,b)}:function(b){b=a.call(c.src,c.listener,b);if(!b)return b};return c},Vs=function(a,c,b,d,e){if(Ta(c)){for(var f=0;f<c.length;f++)Vs(a,c[f],b,d,e);return null}b=Xs(b);return Ms(a)?at(a,
c,b,Wa(d)?!!d.capture:!!d,e):Ys(a,c,b,!0,d,e)},bt=function(a,c,b,d,e){if(Ta(c))for(var f=0;f<c.length;f++)bt(a,c[f],b,d,e);else d=Wa(d)?!!d.capture:!!d,b=Xs(b),Ms(a)?a.K.remove(String(c),b,d,e):a&&(a=Zs(a))&&(c=Rs(a,c,b,d,e))&&ct(c)},ct=function(a){if(r(a)||!a||a.removed)return!1;var c=a.src;if(Ms(c))return Qs(c.K,a);var b=a.type,d=a.proxy;c.removeEventListener?c.removeEventListener(b,d,a.capture):c.detachEvent?c.detachEvent($s(b),d):c.addListener&&c.removeListener&&c.removeListener(d);Us--;(b=Zs(c))?
(Qs(b,a),0==b.f&&(b.src=null,c[Ss]=null)):Ns(a);return!0},dt=function(a){if(a)if(Ms(a))a.Zj(void 0);else if(a=Zs(a)){var c=0,b;for(b in a.b)for(var d=a.b[b].concat(),e=0;e<d.length;++e)ct(d[e])&&++c}},$s=function(a){return a in Ts?Ts[a]:Ts[a]="on"+a},ft=function(a,c,b,d){var e=!0;if(a=Zs(a))if(c=a.b[c.toString()])for(c=c.concat(),a=0;a<c.length;a++){var f=c[a];f&&f.capture==b&&!f.removed&&(f=et(f,d),e=e&&!1!==f)}return e},et=function(a,c){var b=a.listener,d=a.Yc||a.src;a.uh&&ct(a);return b.call(d,
c)},Gba=function(a,c){if(a.removed)return!0;if(!Js){var b=c||Oa("window.event");c=new Ks(b,this);var d=!0;if(!(0>b.keyCode||void 0!=b.returnValue)){a:{var e=!1;if(0==b.keyCode)try{b.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==b.returnValue)b.returnValue=!0}b=[];for(e=c.f;e;e=e.parentNode)b.push(e);a=a.type;for(e=b.length-1;0<=e;e--){c.f=b[e];var f=ft(b[e],a,!0,c);d=d&&f}for(e=0;e<b.length;e++)c.f=b[e],f=ft(b[e],a,!1,c),d=d&&f}return d}return et(a,new Ks(c,this))},Zs=function(a){a=a[Ss];return a instanceof
Os?a:null},gt="__closure_events_fn_"+(1E9*Math.random()>>>0),Xs=function(a){if(Va(a))return a;a[gt]||(a[gt]=function(c){return a.handleEvent(c)});return a[gt]};var ht=function(){W.call(this);this.K=new Os(this);this.tf=this;this.D=null};x(ht,W);ht.prototype[Ls]=!0;h=ht.prototype;h.addEventListener=function(a,c,b,d){Ws(this,a,c,b,d)};h.removeEventListener=function(a,c,b,d){bt(this,a,c,b,d)};
h.N=function(a){var c,b=this.D;if(b)for(c=[];b;b=b.D)c.push(b);b=this.tf;var d=a.type||a;if(Ja(a))a=new X(a,b);else if(a instanceof X)a.target=a.target||b;else{var e=a;a=new X(d,b);Qc(a,e)}e=!0;if(c)for(var f=c.length-1;0<=f;f--){var g=a.f=c[f];e=g.Jf(d,!0,a)&&e}g=a.f=b;e=g.Jf(d,!0,a)&&e;e=g.Jf(d,!1,a)&&e;if(c)for(f=0;f<c.length;f++)g=a.f=c[f],e=g.Jf(d,!1,a)&&e;return e};h.fa=function(){ht.ub.fa.call(this);this.Zj();this.D=null};h.listen=function(a,c,b,d){return this.K.add(String(a),c,!1,b,d)};
var at=function(a,c,b,d,e){return a.K.add(String(c),b,!0,d,e)};ht.prototype.Zj=function(a){this.K&&this.K.removeAll(a)};ht.prototype.Jf=function(a,c,b){a=this.K.b[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.removed&&f.capture==c){var g=f.listener,k=f.Yc||f.src;f.uh&&Qs(this.K,f);d=!1!==g.call(k,b)&&d}}return d&&0!=b.kn};ht.prototype.hasListener=function(a,c){return this.K.hasListener(Ia(a)?String(a):void 0,c)};var it=function(a,c){this.g=a;this.h=c;this.f=0;this.b=null};it.prototype.get=function(){if(0<this.f){this.f--;var a=this.b;this.b=a.next;a.next=null}else a=this.g();return a};var jt=function(a,c){a.h(c);100>a.f&&(a.f++,c.next=a.b,a.b=c)};var kt=function(a){Ha.setTimeout(function(){throw a;},0)},lt,Hba=function(){var a=Ha.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!ae("Presto")&&(a=function(){var e=document.createElement("IFRAME");e.style.display="none";me(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(fe(he));e.close();var g="callImmediate"+Math.random(),k="file:"==f.location.protocol?"*":f.location.protocol+"//"+
f.location.host;e=t(function(m){if(("*"==k||m.origin==k)&&m.data==g)this.port1.onmessage()},this);f.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,k)}}});if("undefined"!==typeof a&&!ae("Trident")&&!ae("MSIE")){var c=new a,b={},d=b;c.port1.onmessage=function(){if(Ia(b.next)){b=b.next;var e=b.Bl;b.Bl=null;e()}};return function(e){d.next={Bl:e};d=d.next;c.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?
function(e){var f=document.createElement("SCRIPT");f.onreadystatechange=function(){f.onreadystatechange=null;f.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){Ha.setTimeout(e,0)}};var mt=function(){this.f=this.b=null},ot=new it(function(){return new nt},function(a){a.reset()});mt.prototype.add=function(a,c){var b=ot.get();b.set(a,c);this.f?this.f.next=b:this.b=b;this.f=b};mt.prototype.remove=function(){var a=null;this.b&&(a=this.b,this.b=this.b.next,this.b||(this.f=null),a.next=null);return a};var nt=function(){this.next=this.scope=this.b=null};nt.prototype.set=function(a,c){this.b=a;this.scope=c;this.next=null};nt.prototype.reset=function(){this.next=this.scope=this.b=null};var st=function(a,c){pt||Iba();qt||(pt(),qt=!0);rt.add(a,c)},pt,Iba=function(){if(Ha.Promise&&Ha.Promise.resolve){var a=Ha.Promise.resolve(void 0);pt=function(){a.then(tt)}}else pt=function(){var c=tt;!Va(Ha.setImmediate)||Ha.Window&&Ha.Window.prototype&&!ae("Edge")&&Ha.Window.prototype.setImmediate==Ha.setImmediate?(lt||(lt=Hba()),lt(c)):Ha.setImmediate(c)}},qt=!1,rt=new mt,tt=function(){for(var a;a=rt.remove();){try{a.b.call(a.scope)}catch(c){kt(c)}jt(ot,a)}qt=!1};var ut=function(a){a.prototype.$goog_Thenable=!0},vt=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(c){return!1}};var yt=function(a,c){this.b=0;this.m=void 0;this.h=this.f=this.g=null;this.j=this.w=!1;if(a!=Pa)try{var b=this;a.call(c,function(d){wt(b,2,d)},function(d){if(!(d instanceof xt))try{if(d instanceof Error)throw d;throw Error("Promise rejected.");}catch(e){}wt(b,3,d)})}catch(d){wt(this,3,d)}},zt=function(){this.next=this.context=this.f=this.h=this.b=null;this.g=!1};zt.prototype.reset=function(){this.context=this.f=this.h=this.b=null;this.g=!1};
var At=new it(function(){return new zt},function(a){a.reset()}),Bt=function(a,c,b){var d=At.get();d.h=a;d.f=c;d.context=b;return d},Ct=function(a){if(a instanceof yt)return a;var c=new yt(Pa);wt(c,2,a);return c},Dt=function(a){return new yt(function(c,b){b(a)})},Ft=function(a,c,b){Et(a,c,b,null)||st(bb(c,a))},Gt=function(a){return new yt(function(c,b){a.length||c(void 0);for(var d=0,e;d<a.length;d++)e=a[d],Ft(e,c,b)})},Ht=function(a){return new yt(function(c,b){var d=a.length,e=[];if(d)for(var f=
function(p,u){d--;e[p]=u;0==d&&c(e)},g=function(p){b(p)},k=0,m;k<a.length;k++)m=a[k],Ft(m,bb(f,k),g);else c(e)})},It=function(a){return new yt(function(c){var b=a.length,d=[];if(b)for(var e=function(k,m,p){b--;d[k]=m?{ee:!0,value:p}:{ee:!1,reason:p};0==b&&c(d)},f=0,g;f<a.length;f++)g=a[f],Ft(g,bb(e,f,!0),bb(e,f,!1));else c(d)})},Jt=function(){var a,c,b=new yt(function(d,e){a=d;c=e});return new Jba(b,a,c)};yt.prototype.then=function(a,c,b){return Kt(this,Va(a)?a:null,Va(c)?c:null,b)};ut(yt);
var Mt=function(a,c,b){c=Bt(c,c,b);c.g=!0;Lt(a,c);return a},Nt=function(a,c){return Kt(a,null,c,void 0)};yt.prototype.cancel=function(a){0==this.b&&st(function(){var c=new xt(a);Ot(this,c)},this)};
var Ot=function(a,c){if(0==a.b)if(a.g){var b=a.g;if(b.f){for(var d=0,e=null,f=null,g=b.f;g&&(g.g||(d++,g.b==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(0==b.b&&1==d?Ot(b,c):(f?(d=f,d.next==b.h&&(b.h=d),d.next=d.next.next):Pt(b),Qt(b,e,3,c)))}a.g=null}else wt(a,3,c)},Lt=function(a,c){a.f||2!=a.b&&3!=a.b||Rt(a);a.h?a.h.next=c:a.f=c;a.h=c},Kt=function(a,c,b,d){var e=Bt(null,null,null);e.b=new yt(function(f,g){e.h=c?function(k){try{var m=c.call(d,k);f(m)}catch(p){g(p)}}:f;e.f=b?function(k){try{var m=b.call(d,
k);!Ia(m)&&k instanceof xt?g(k):f(m)}catch(p){g(p)}}:g});e.b.g=a;Lt(a,e);return e.b};yt.prototype.s=function(a){this.b=0;wt(this,2,a)};yt.prototype.D=function(a){this.b=0;wt(this,3,a)};
var wt=function(a,c,b){0==a.b&&(a===b&&(c=3,b=new TypeError("Promise cannot resolve to itself")),a.b=1,Et(b,a.s,a.D,a)||(a.m=b,a.b=c,a.g=null,Rt(a),3!=c||b instanceof xt||Kba(a,b)))},Et=function(a,c,b,d){if(a instanceof yt)return Lt(a,Bt(c||Pa,b||null,d)),!0;if(vt(a))return a.then(c,b,d),!0;if(Wa(a))try{var e=a.then;if(Va(e))return Lba(a,e,c,b,d),!0}catch(f){return b.call(d,f),!0}return!1},Lba=function(a,c,b,d,e){var f=!1,g=function(m){f||(f=!0,b.call(e,m))},k=function(m){f||(f=!0,d.call(e,m))};try{c.call(a,
g,k)}catch(m){k(m)}},Rt=function(a){a.w||(a.w=!0,st(a.o,a))},Pt=function(a){var c=null;a.f&&(c=a.f,a.f=c.next,c.next=null);a.f||(a.h=null);return c};yt.prototype.o=function(){for(var a;a=Pt(this);)Qt(this,a,this.b,this.m);this.w=!1};
var Qt=function(a,c,b,d){if(3==b&&c.f&&!c.g)for(;a&&a.j;a=a.g)a.j=!1;if(c.b)c.b.g=null,St(c,b,d);else try{c.g?c.h.call(c.context):St(c,b,d)}catch(e){Tt.call(null,e)}jt(At,c)},St=function(a,c,b){2==c?a.h.call(a.context,b):a.f&&a.f.call(a.context,b)},Kba=function(a,c){a.j=!0;st(function(){a.j&&Tt.call(null,c)})},Tt=kt,xt=function(a){Db.call(this,a)};x(xt,Db);xt.prototype.name="cancel";var Jba=function(a,c,b){this.Y=a;this.resolve=c;this.reject=b};var Ut=function(a,c){ht.call(this);this.h=a||1;this.g=c||Ha;this.j=t(this.o,this);this.m=v()};x(Ut,ht);Ut.prototype.enabled=!1;Ut.prototype.f=null;var Vt=function(a,c){a.h=c;a.f&&a.enabled?(a.stop(),a.start()):a.f&&a.stop()};Ut.prototype.o=function(){if(this.enabled){var a=v()-this.m;0<a&&a<.8*this.h?this.f=this.g.setTimeout(this.j,this.h-a):(this.f&&(this.g.clearTimeout(this.f),this.f=null),this.N("tick"),this.enabled&&(this.stop(),this.start()))}};
Ut.prototype.start=function(){this.enabled=!0;this.f||(this.f=this.g.setTimeout(this.j,this.h),this.m=v())};Ut.prototype.stop=function(){this.enabled=!1;this.f&&(this.g.clearTimeout(this.f),this.f=null)};Ut.prototype.fa=function(){Ut.ub.fa.call(this);this.stop();delete this.g};
var Wt=function(a,c,b){if(Va(a))b&&(a=t(a,b));else if(a&&"function"==typeof a.handleEvent)a=t(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:Ha.setTimeout(a,c||0)},Xt=function(a){Ha.clearTimeout(a)},Yt=function(a){var c=null;return Nt(new yt(function(b,d){c=Wt(function(){b(void 0)},a);-1==c&&d(Error("Failed to schedule timer."))}),function(b){Xt(c);throw b;})};var Zt=function(){var a=void 0===a?!0:a;this.l=Mf("mr.cloud.slarti.Fetcher");this.b=0;this.f=a};Zt.prototype.execute=function(a){var c=this,b="Fetch call "+ ++this.b,d=new ef(function(){return Mba(c,b,a,function(e){return d.abort(e)})},1E3,this.f?5:1);return d.start()};
var Mba=function(a,c,b,d){var e=b.uri.toString().replace(/\?.*/,"?<redacted>"),f=b.method+" "+e;B(a.l,c+": "+f);e=[uba(b).then(function(g){return Promise.resolve(fetch(g))})];b.gh&&e.push(Yt(b.gh).then(function(){throw Es("API call timed out",504);}));return Promise.race(e).then(function(g){if(!g.ok)return g.json().then(function(m){return m},function(){return null}).then(function(m){var p;m&&m instanceof Object&&m.error&&(p=m.error);throw new Ds(g,p);});var k=(v()-b.start)/1E3;B(a.l,c+" succeeded: "+
f+" duration = "+k+"s");return(k=g.headers.get("content-type"))&&k.includes("application/json")?g.json():k&&(k.includes("image")||k.includes("application/octet-stream"))?g.blob():g.text()},function(g){var k="";if(g instanceof Ds)k=", ("+g.status+"): "+g.message,zba(g)&&d(g);else{try{k=", "+JSON.stringify(g,null,2)}catch(m){}g instanceof Error&&"Failed to fetch"==g.message&&(g=Es(g.message))}Of(a.l,c+" failed: "+k);throw g;})};var $t=function(a,c){this.b=Waa.b;this.nb=a;this.f=c};var au=function(a,c){$t.call(this,a,c)};q(au,$t);au.prototype.register=function(a){a=new Cs({method:"POST",baseUrl:this.b,Mc:["user:register"],nb:this.nb,body:{gcmId:a}});return this.f.execute(a)};au.prototype.unregister=function(a){a=new Cs({method:"POST",baseUrl:this.b,Mc:["user:unregister"],nb:this.nb,body:{gcmId:a}});return this.f.execute(a)};var Nba=function(a,c,b){this.l=gb("mr.cloud.slarti.GcmRegistration");this.g=a;this.f=c;this.h=b;this.b=null},Oba=function(a){if(!a.b){var c=a.f["mr.cloud.slarti.GcmRegistration.ID"];a.b=a.h.register(["307539924703"]).then(function(b){if(b==c)nb(a.l,"Slarti GCM ID unchanged: "+b);else return nb(a.l,"Got new Slarti GCM ID: "+b),(c?bu(a,c):Promise.resolve()).then(function(){return a.g.register(b).then(function(){a.f["mr.cloud.slarti.GcmRegistration.ID"]=b})})},function(b){a.l.H("Error registering for GCM notifications",
b);c&&bu(a,c).catch(function(d){a.l.H("Failed to unregister GCM ID with Slarti",d)});throw b;});a.b.then(function(){a.b=null},function(){a.b=null})}return a.b},bu=function(a,c){return a.g.unregister(c).then(function(){delete a.f["mr.cloud.slarti.GcmRegistration.ID"]},function(b){a.l.H("Failed to unregister GCM ID with Slarti",b)})};var cu=null,du=function(){Gp.call(this,5,"mr.cloud.slarti.GcmEventListener","mr.cloud.slarti.SinkDiscoveryService",chrome.gcm.onMessage);this.l=gb("mr.cloud.slarti.GcmEventListener")};q(du,Gp);du.prototype.ih=function(a){if(a&&"307539924703"==a.from&&"object"==typeof a.data&&"string"==typeof a.data.data){var c=JSON.parse(a.data.data);a=c.type;c=c.id;if(a)return this.l.info("Received Slarti GCM notification: "+a+" ("+c+")"),!0}return!1};var eu=function(){null==cu&&(cu=new du);return cu};var fu=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];d=a;b=l(b);for(var e=b.next();!e.done;e=b.next()){if(void 0==d||"object"!=typeof d)return;d=d[e.value]}return d};var gu=function(){Gp.call(this,5,"cloud.GcmEventListener","mr.cloud.discovery.WeaveSinkDiscoveryService",chrome.gcm.onMessage);this.l=gb("mr.WeaveGcmEventListener")};q(gu,Gp);gu.prototype.ih=function(a){if(!a||"919648714761"!=a.from)return!1;a=fu(a,"data","notification");if(!a)return this.l.error("Notification json not found"),!1;try{var c=JSON.parse(a);return!!c&&Array.isArray(c.events)&&0<c.events.length}catch(b){return this.l.error("Invalid json: "+a),!1}};
var iu=function(){hu||(hu=new gu);return hu},hu=null;var ju=function(a){this.b=a;this.l=gb("mr.cloud.messaging.WeaveGcmMessageHandler")};ju.prototype.onMessage=function(a){var c=this;a=JSON.parse(a.data.notification);var b=Am();a.events.forEach(function(d){if(d.deviceId){var e=Bm(b,d.deviceId);switch(d.type){case "deviceCreated":Pba(c,d);break;case "deviceUpdated":Qba(c,d,e);break;case "deviceDeleted":Rba(c.b,{sinkId:e});break;default:nb(c.l,function(){return"[unhandled event] "+JSON.stringify(d)})}}else c.l.error("Device ID not provided")})};
var Pba=function(a,c){var b=fu(c,"statePatch","_cloudCast","settings","receiverName");"string"!=typeof b?a.l.error("Receiver name not a string: "+b):(c=new ms(c.deviceId,b,"owner","default",!0),a=a.b,a.b.b.set(c.id,c),a.b.f=Date.now(),qs(a.f,[c.sb]))},Qba=function(a,c,b){c=fu(c,"statePatch","_cloudCast","appStatus");if("string"!=typeof c)a.l.error("App status not a string: "+c);else if(a=a.b,c="available"==c,b=a.b.pa(b))b.isAvailable=c||!1,a.b.f=Date.now(),rs(a.f,[b.sb])};var ku=function(a,c){this.g=a;this.f=c;this.b=new ps(this.ur.bind(this),c,2E4);this.h=new ju(this);iu().addListener();gm(this);bj("mr.cloud.discovery.WeaveSinkDiscoveryService",this)};q(ku,Si);h=ku.prototype;h.je=function(){var a=this;jba(this.g).then(function(c){a.g.subscribe(c)}).catch(function(){});return this.b.je().filter(function(c){return c.isAvailable})};h.pa=function(a){return this.b.pa(a)};
h.handleEvent=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];if(a==chrome.gcm.onMessage)this.h.onMessage.apply(this.h,n(b));else throw Error("Unhandled event: expected chrome.gcm.onMessage");};h.ur=function(){return hba(this.g).then(function(a){return a.map(function(c){Ab("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");var b=c.isAvailable()&&!(c.b.invitations&&0!=c.b.invitations.length);return new ms(c.getId(),c.f(),c.b.personalizedInfo.maxRole,"default",b)})},function(){})};
h.Ca=function(){return"WeaveSinkDiscoveryService"};h.qb=function(){return[{cache:ts(this.b)}]};h.ob=function(){var a=dm(this);a&&us(this.b,a.cache)};var Rba=function(a,c){if(c=a.b.pa(c.sinkId))a.b.b.delete(c.id),a.b.f=Date.now(),ss(a.f,[c.sb])};var lu=Ha.JSON.parse,mu=Ha.JSON.stringify;var nu=function(a,c,b,d,e,f,g,k,m){W.call(this);this.f=null;this.C=!1;this.D=Jt();this.g=[];this.s=a?encodeURIComponent(String(a)):null;this.F=null;!d&&c&&(this.F=c);this.J=b||null;this.h=!d;this.j=null!=e?e:null;this.o=f||null;this.M=!!g;this.K=k||null;this.m=null!=m?m:null};q(nu,W);nu.prototype.init=function(){var a=t(function(b){this.f=b;var d=Oa("auth",b);Oa("client.request",b)&&d?this.G():b.load("client",t(this.G,this))},this),c=ou("gapi");c?a(c.gapi):Sba(this,a);return this.D.Y};
var ou=function(a){for(var c=window,b=Oa(a,c);!b&&c!=window.top&&Tba(c.parent,a);)c=c.parent,b=Oa(a,c);return b?c:null},Tba=function(a,c){try{return!!a&&null!=a.location.href&&we(a,c)}catch(b){return!1}},Sba=function(a,c){var b=ou("gapi_onload");if(b){var d=b.gapi_onload;b.gapi_onload=function(){d();c(b.gapi)}}else{window.gapi_onload=function(){c(window.gapi)};var e=document.createElement("SCRIPT");ne(e,Uba);a.K&&bg(e,mu(a.K));document.getElementsByTagName("head")[0].appendChild(e)}};
nu.prototype.G=function(){for(var a=0;a<this.g.length;a++)this.g[a].Gb.resolve(pu(this,this.g[a].requestData));this.C=!0;this.D.resolve(this.f)};nu.prototype.sendRequest=function(a){if(this.C)return pu(this,a);var c=Jt();this.g.push({requestData:a,Gb:c});return c.Y};
var pu=function(a,c){var b=Oa("config.get",a.f);if(!a.h){var d=b("googleapis.config/auth/useFirstPartyAuth");var e=b("googleapis.config/auth/useOriginToken")}var f;null!=a.j&&(f=b("client/cors"));var g;null!=a.m&&(g=b("client/xd4"));try{var k=Oa("config.update",a.f);a.h||(k("googleapis.config/auth/useFirstPartyAuth",!1),k("googleapis.config/auth/useOriginToken",!1));null!=a.j&&k("client/cors",a.j);null!=a.m&&k("client/xd4",a.m);var m=Vba(a);c.headers&&Qc(m,c.headers);var p={headers:m,root:a.J,path:c.path,
method:c.method,body:c.body},u=c.params||{};a.s&&!a.o?Qc(u,{key:a.s}):a.o&&Qc(u,{key:null});Kc(u)||(p.params=u);var A=Ct(Oa("client.request",a.f)(p));c.callback&&A.then(function(F){c.callback.apply(null,[F.result,F])},function(F){c.callback.apply(null,[F.result,F])});return A}finally{b=Oa("config.update",a.f),a.h||(b("googleapis.config/auth/useFirstPartyAuth",d),b("googleapis.config/auth/useOriginToken",e)),null!=a.j&&b("client/cors",f),null!=a.m&&b("client/xd4",g)}},Vba=function(a){if(a.h){if(a.o)return{Authorization:"Bearer "+
a.o};var c=Oa("auth.getAuthHeaderValueForFirstParty",a.f);return{Authorization:a.M?c([]):c(),"X-Goog-AuthUser":a.F}}return{}},Uba=new hd(fd,Vc(new Uc(Sc,"https://apis.google.com/js/client.js")),null);var Wba=function(a){this.b=a},bs=function(a,c,b){var d="";c.forEach(function(e){d+="/"+encodeURIComponent(e)});a=new wr(a+d);b&&(b=Gr(b),zr(a,b));return a},cs=function(a,c,b,d){return a.b.getAuthToken().then(function(e){var f=Xba(e);return Yba(f,c,b,d).catch(function(g){if("INVALID_ACCESS_ERROR"==g)return Zba(a,e,c,b,d);throw g;})})},Zba=function(a,c,b,d,e){return sba(c).then(function(){return cs(a,b,d,e)})},Yba=function(a,c,b,d){return new Promise(function(e,f){a.sendRequest($ba(c,b,function(g){g&&
!g.error?e(g):g&&401==g.error.code?f("INVALID_ACCESS_ERROR"):f(g&&g.error?g.error.errors?g.error.errors[0]:g:Error(g))},d))})},Xba=function(a){a=new nu(void 0,void 0,void 0,!1,!1,a);a.init();return a},$ba=function(a,c,b,d){a={callback:b,method:c,path:a.toString()};d&&(a.body=d);return a};var qu={Lu:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},Ku:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},ru=qu;ru=qu;var su={AED:[2,"dh","\u062f.\u0625."],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,
"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","PHP"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd",
"RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"\u20ba","TRY"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var tu={Ck:".",ei:",",Rk:"%",ki:"0",Do:"+",Mk:"-",Gk:"E",Sk:"\u2030",fi:"\u221e",yo:"NaN",bo:"#,##0.###",nz:"#E0",my:"#,##0%",Yu:"\u00a4#,##0.00",Dk:"USD"},uu=tu;uu=tu;var wu=function(){this.D=40;this.f=1;this.g=3;this.F=this.w=0;this.J=!1;this.C=this.o="";this.h=uu.Mk;this.s="";this.b=1;this.m=!1;this.j=[];this.K=this.G=!1;var a=uu.bo;a.replace(/ /g,"\u00a0");var c=[0];this.o=vu(this,a,c);for(var b=c[0],d=-1,e=0,f=0,g=0,k=-1,m=a.length,p=!0;c[0]<m&&p;c[0]++)switch(a.charAt(c[0])){case "#":0<f?g++:e++;0<=k&&0>d&&k++;break;case "0":if(0<g)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>d&&k++;break;case ",":0<k&&this.j.push(k);k=0;break;case ".":if(0<=
d)throw Error('Multiple decimal separators in pattern "'+a+'"');d=e+f+g;break;case "E":if(this.K)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.K=!0;this.F=0;c[0]+1<m&&"+"==a.charAt(c[0]+1)&&(c[0]++,this.J=!0);for(;c[0]+1<m&&"0"==a.charAt(c[0]+1);)c[0]++,this.F++;if(1>e+f||1>this.F)throw Error('Malformed exponential pattern "'+a+'"');p=!1;break;default:c[0]--,p=!1}0==f&&0<e&&0<=d&&(f=d,0==f&&f++,g=e-f,e=f-1,f=1);if(0>d&&0<g||0<=d&&(d<e||d>e+f)||0==k)throw Error('Malformed pattern "'+
a+'"');g=e+f+g;this.g=0<=d?g-d:0;0<=d&&(this.w=e+f-d,0>this.w&&(this.w=0));this.f=(0<=d?d:g)-e;this.K&&(this.D=e+this.f,0==this.g&&0==this.f&&(this.f=1));this.j.push(Math.max(0,k));this.G=0==d||d==g;b=c[0]-b;this.C=vu(this,a,c);c[0]<a.length&&";"==a.charAt(c[0])?(c[0]++,1!=this.b&&(this.m=!0),this.h=vu(this,a,c),c[0]+=b,this.s=vu(this,a,c)):(this.h+=this.o,this.s+=this.C)};
wu.prototype.parse=function(a,c){c=c||[0];a=a.replace(/ |\u202f/g,"\u00a0");var b=a.indexOf(this.o,c[0])==c[0],d=a.indexOf(this.h,c[0])==c[0];b&&d&&(this.o.length>this.h.length?d=!1:this.o.length<this.h.length&&(b=!1));b?c[0]+=this.o.length:d&&(c[0]+=this.h.length);if(a.indexOf(uu.fi,c[0])==c[0]){c[0]+=uu.fi.length;var e=Infinity}else{e=a;var f=!1,g=!1,k=!1,m=-1,p=1,u=uu.Ck,A=uu.ei,F=uu.Gk;A=A.replace(/\u202f/g,"\u00a0");for(var E="";c[0]<e.length;c[0]++){var J=e.charAt(c[0]),U=xu(J);if(0<=U&&9>=
U)E+=U,k=!0;else if(J==u.charAt(0)){if(f||g)break;E+=".";f=!0}else if(J==A.charAt(0)&&("\u00a0"!=A.charAt(0)||c[0]+1<e.length&&0<=xu(e.charAt(c[0]+1)))){if(f||g)break}else if(J==F.charAt(0)){if(g)break;E+="E";g=!0;m=c[0]}else if("+"==J||"-"==J){if(k&&m!=c[0]-1)break;E+=J}else if(1==this.b&&J==uu.Rk.charAt(0)){if(1!=p)break;p=100;if(k){c[0]++;break}}else if(1==this.b&&J==uu.Sk.charAt(0)){if(1!=p)break;p=1E3;if(k){c[0]++;break}}else break}1!=this.b&&(p=this.b);e=parseFloat(E)/p}if(b){if(a.indexOf(this.C,
c[0])!=c[0])return NaN;c[0]+=this.C.length}else if(d){if(a.indexOf(this.s,c[0])!=c[0])return NaN;c[0]+=this.s.length}return d?-e:e};
wu.prototype.format=function(a){if(isNaN(a))return uu.yo;var c=[];var b=aca;a=yu(a,-b.mq);c.push(b.prefix);var d=0>a||0==a&&0>1/a;c.push(d?this.h:this.o);if(isFinite(a))if(a=a*(d?-1:1)*this.b,this.K)if(0==a)zu(this,a,this.f,c),Au(this,0,c);else{var e=Math.floor(Math.log(a)/Math.log(10)+2E-15);a=yu(a,-e);var f=this.f;1<this.D&&this.D>this.f?(f=e%this.D,0>f&&(f=this.D+f),a=yu(a,f),e-=f,f=1):1>this.f?(e++,a=yu(a,-1)):(e-=this.f-1,a=yu(a,this.f-1));zu(this,a,f,c);Au(this,e,c)}else zu(this,a,this.f,c);
else c.push(uu.fi);c.push(d?this.s:this.C);c.push(b.tt);return c.join("")};
var zu=function(a,c,b,d){if(a.w>a.g)throw Error("Min value must be less than max value");d||(d=[]);var e=yu(c,a.g);e=Math.round(e);if(isFinite(e)){c=Math.floor(yu(e,-a.g));var f=Math.floor(e-yu(c,a.g))}else f=0;e=c;c=f;var g=e;f=c;var k=0<a.w||0<f||!1;e=a.w;k&&(e=a.w);var m="";for(c=g;1E20<c;)m="0"+m,c=Math.round(yu(c,-1));m=c+m;var p=uu.Ck;c=uu.ki.charCodeAt(0);var u=m.length,A=0;if(0<g||0<b){for(g=u;g<b;g++)d.push(String.fromCharCode(c));if(2<=a.j.length)for(b=1;b<a.j.length;b++)A+=a.j[b];b=u-A;
if(0<b){g=a.j;A=u=0;for(var F,E=uu.ei,J=m.length,U=0;U<J;U++)if(d.push(String.fromCharCode(c+1*Number(m.charAt(U)))),1<J-U)if(F=g[A],U<b){var wa=b-U;(1===F||0<F&&1===wa%F)&&d.push(E)}else A<g.length&&(U===b?A+=1:F===U-b-u+1&&(d.push(E),u+=F,A+=1))}else{b=m;m=a.j;g=uu.ei;F=b.length;E=[];for(u=m.length-1;0<=u&&0<F;u--){A=m[u];for(J=0;J<A&&0<=F-J-1;J++)E.push(String.fromCharCode(c+1*Number(b.charAt(F-J-1))));F-=A;0<F&&E.push(g)}d.push.apply(d,E.reverse())}}else k||d.push(String.fromCharCode(c));(a.G||
k)&&d.push(p);k=String(f);f=k.split("e+");if(2==f.length){if(k=parseFloat(f[0])){p=k;if(isFinite(p)){for(b=0;1<=(p/=10);)b++;p=b}else p=0<p?p:0;p=0-p-1;k=-1>p?k&&isFinite(k)?yu(Math.round(yu(k,-1)),1):k:k&&isFinite(k)?yu(Math.round(yu(k,p)),-p):k}k=String(k);k=k.replace(".","");k+=oe("0",parseInt(f[1],10)-k.length+1)}a.g+1>k.length&&(k="1"+oe("0",a.g-k.length)+k);for(a=k.length;"0"==k.charAt(a-1)&&a>e+1;)a--;for(g=1;g<a;g++)d.push(String.fromCharCode(c+1*Number(k.charAt(g))))},Au=function(a,c,b){b.push(uu.Gk);
0>c?(c=-c,b.push(uu.Mk)):a.J&&b.push(uu.Do);c=""+c;for(var d=uu.ki,e=c.length;e<a.F;e++)b.push(d);b.push(c)},xu=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var c=uu.ki.charCodeAt(0);return c<=a&&a<c+10?a-c:-1},vu=function(a,c,b){for(var d="",e=!1,f=c.length;b[0]<f;b[0]++){var g=c.charAt(b[0]);if("'"==g)b[0]+1<f&&"'"==c.charAt(b[0]+1)?(b[0]++,d+="'"):e=!e;else if(e)d+=g;else switch(g){case "#":case "0":case ",":case ".":case ";":return d;case "\u00a4":b[0]+1<f&&"\u00a4"==c.charAt(b[0]+
1)?(b[0]++,d+=uu.Dk):(g=uu.Dk,d+=g in su?su[g][1]:g);break;case "%":if(!a.m&&1!=a.b)throw Error("Too many percent/permill");if(a.m&&100!=a.b)throw Error("Inconsistent use of percent/permill characters");a.b=100;a.m=!1;d+=uu.Rk;break;case "\u2030":if(!a.m&&1!=a.b)throw Error("Too many percent/permill");if(a.m&&1E3!=a.b)throw Error("Inconsistent use of percent/permill characters");a.b=1E3;a.m=!1;d+=uu.Sk;break;default:d+=g}}return d},aca={prefix:"",tt:"",mq:0},yu=function(a,c){if(!a||!isFinite(a)||
0==c)return a;a=String(a).split("e");return parseFloat(a[0]+"e"+(parseInt(a[1]||0,10)+c))};var Bu=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},Cu=Bu;Cu=Bu;var Du=function(a,c){if(void 0===c){c=a+"";var b=c.indexOf(".");c=Math.min(-1==b?0:c.length-b-1,3)}return 1==(a|0)&&0==c?"one":"other"},Eu=Du;Eu=Du;var Iu=function(){this.h=bca;this.f=this.b=this.j=null;var a=uu,c=ru;if(Fu!==a||Gu!==c)Fu=a,Gu=c,Hu=new wu;this.w=Hu},Fu=null,Gu=null,Hu=null,cca=/'([{}#].*?)'/g,dca=/''/g;Iu.prototype.format=function(a){if(this.h){this.j=[];var c=eca(this,this.h);this.f=Ju(this,c);this.h=null}if(this.f&&0!=this.f.length)for(this.b=y(this.j),c=[],Ku(this,this.f,a,!1,c),a=c.join("");0<this.b.length;)a=a.replace(this.g(this.b),this.b.pop());else a="";return a};
var Ku=function(a,c,b,d,e){for(var f=0;f<c.length;f++)switch(c[f].type){case 4:e.push(c[f].value);break;case 3:var g=c[f].value,k=a,m=e,p=b[g];Ia(p)?(k.b.push(p),m.push(k.g(k.b))):m.push("Undefined parameter - "+g);break;case 2:g=c[f].value;k=e;m=g.th;Ia(b[m])?(m=g[b[m]],Ia(m)||(m=g.other),Ku(a,m,b,d,k)):k.push("Undefined parameter - "+m);break;case 0:g=c[f].value;Lu(a,g,b,Eu,d,e);break;case 1:g=c[f].value;Lu(a,g,b,Cu,d,e);break;default:Gb("Unrecognized block type: "+c[f].type)}},Lu=function(a,c,
b,d,e,f){var g=c.th,k=c.ql,m=+b[g];isNaN(m)?f.push("Undefined or invalid parameter - "+g):(k=m-k,g=c[b[g]],Ia(g)||(d=d(k),g=c[d],Ia(g)||(g=c.other)),c=[],Ku(a,g,b,e,c),b=c.join(""),e?f.push(b):(a=a.w.format(k),f.push(b.replace(/#/g,a))))},eca=function(a,c){var b=a.j,d=t(a.g,a);c=c.replace(dca,function(){b.push("'");return d(b)});return c=c.replace(cca,function(e,f){b.push(f);return d(b)})},Mu=function(a){var c=0,b=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var g=f.index;"}"==f[0]?(b.pop(),
0==b.length&&(f={type:1},f.value=a.substring(c,g),d.push(f),c=g+1)):(0==b.length&&(c=a.substring(c,g),""!=c&&d.push({type:0,value:c}),c=g+1),b.push("{"))}c=a.substring(c);""!=c&&d.push({type:0,value:c});return d},Nu=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Ou=/^\s*(\w+)\s*,\s*selectordinal\s*,/,Pu=/^\s*(\w+)\s*,\s*select\s*,/,Ju=function(a,c){var b=[];c=Mu(c);for(var d=0;d<c.length;d++){var e={};if(0==c[d].type)e.type=4,e.value=c[d].value;else if(1==c[d].type){var f=c[d].value;switch(Nu.test(f)?
0:Ou.test(f)?1:Pu.test(f)?2:/^\s*\w+\s*/.test(f)?3:5){case 2:e.type=2;e.value=fca(a,c[d].value);break;case 0:e.type=0;e.value=gca(a,c[d].value);break;case 1:e.type=1;e.value=hca(a,c[d].value);break;case 3:e.type=3;e.value=c[d].value;break;default:Gb("Unknown block type for pattern: "+c[d].value)}}else Gb("Unknown part of the pattern.");b.push(e)}return b},fca=function(a,c){var b="";c=c.replace(Pu,function(k,m){b=m;return""});var d={};d.th=b;c=Mu(c);for(var e=0;e<c.length;){var f=c[e].value;e++;var g;
1==c[e].type?g=Ju(a,c[e].value):Gb("Expected block type.");d[f.replace(/\s/g,"")]=g;e++}return d},gca=function(a,c){var b="",d=0;c=c.replace(Nu,function(m,p,u){b=p;u&&(d=parseInt(u,10));return""});var e={};e.th=b;e.ql=d;c=Mu(c);for(var f=0;f<c.length;){var g=c[f].value;f++;var k;1==c[f].type?k=Ju(a,c[f].value):Gb("Expected block type.");e[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e},hca=function(a,c){var b="";c=c.replace(Ou,function(k,m){b=m;return""});var d={};d.th=b;d.ql=0;c=Mu(c);for(var e=
0;e<c.length;){var f=c[e].value;e++;if(1==c[e].type)var g=Ju(a,c[e].value);else Gb("Expected block type.");d[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=g;e++}return d};Iu.prototype.g=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var Qu=chrome.i18n.getMessage("1522140683318860351"),Ru=chrome.i18n.getMessage("4246483347873264186"),Su=chrome.i18n.getMessage("5991427458288444010"),oi=chrome.i18n.getMessage("6063910461797960050"),ica=chrome.i18n.getMessage("7735695102441495789"),jca=chrome.i18n.getMessage("4575332923598659024"),bca=chrome.i18n.getMessage("2297080986956220930"),Tu=new Iu;var kca=function(a){this.b=a;this.l=gb("mr.cloud.mesi.MesiService")},pba=function(a){var c=bs(Yaa.b,["hangouts","search"]);a.l.info("Retrieving Hangouts from MESI: "+c);return cs(a.b,c,"POST",lca).then(function(b){var d=[];b.result&&(d=b.result.map(function(e){var f=e.hangout,g=f.meeting_room_name,k;f.meeting_domain?k=f.meeting_domain:"BUSINESS"==f.type&&f.company_title&&(k=f.company_title.toLowerCase());var m=Tu.format({ORGANIZER:"",PARTICIPANTS:0});if((e=e.participant)&&0<e.length){var p=e[0].display_name;
m=e.reduce(function(u,A){u.add(A.user_id);"ORGANIZER"==A.role&&(p=A.display_name);return u},new Set);m=Tu.format({ORGANIZER:p,PARTICIPANTS:m.size})}return g&&k?new Zr(!1,g+"@"+k,k,g,m,f.hangout_id):new Zr(!1,f.hangout_id,k,g,m,f.hangout_id)}));return d})},lca={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};var mca=function(a,c){this.f=a;this.b=c},nca=function(a,c,b,d){switch(c.type){case "REFRESH_AUTH":var e=d.Nd,f=d.deviceId,g=d.fh;return tba(a.f).then(function(){Uu(a.b,new Cj("AUTH_READY",{Nd:e,eb:f,fh:g}),b.id)});case "STATUS_REQUEST":return Uu(a.b,c,b.id),Promise.resolve();case "STATUS_RESPONSE":return Uu(a.b,c,b.id,!0),c.data.routeDescription||Uu(a.b,c,b.id),Promise.resolve();case "HANGOUT_INACTIVE":return Vu(a.b,b,4,si(new ni(ica,"warning"),b.sinkId));case "HANGOUT_INVALID":return Vu(a.b,b,3,
si(new ni(jca,"warning"),b.sinkId));default:return Promise.reject(Error("Unknown type: "+c.type))}};var Wu=new Map([["status","status"],["results","result"],["expirationTime","expiration_time"]]),Xu=function(a,c){$t.call(this,a,c);this.l=Mf("mr.cloud.slarti.CommandsService")};q(Xu,$t);Xu.prototype.get=function(a){a=new Cs({method:"GET",baseUrl:this.b,Mc:["commands",a],nb:this.nb});return this.f.execute(a).then(function(c){return c})};
Xu.prototype.list=function(a){a=new Cs({method:"GET",baseUrl:this.b,Mc:["commands"],dn:{deviceId:a},nb:this.nb});return this.f.execute(a).then(function(c){return c.command||[]})};Xu.prototype.send=function(a,c){var b=this;a=new Cs({method:"POST",baseUrl:this.b,Mc:["commands:send"],nb:this.nb,body:{command:c,deviceId:a}});return this.f.execute(a).then(function(d){b.l.info("Sent Slarti command with ID "+d.id);return d})};
Xu.prototype.update=function(a,c){for(var b=[],d={},e=l(Wu.keys()),f=e.next();!f.done;f=e.next())f=f.value,c[f]&&(d[f]=c[f],b.push(Wu.get(f)));d.id=a;a=new Cs({method:"PUT",baseUrl:this.b,Mc:["commands",a],nb:this.nb,body:{command:d,updateMask:b}});return this.f.execute(a).then(function(g){return g})};var oca=Ha.JSON.parse;var Yu=function(){};Yu.prototype.b=null;Yu.prototype.getOptions=function(){var a;(a=this.b)||(a={},Zu(this)&&(a[0]=!0,a[1]=!0),a=this.b=a);return a};var $u,av=function(){};x(av,Yu);var bv=function(a){return(a=Zu(a))?new ActiveXObject(a):new XMLHttpRequest},Zu=function(a){if(!a.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var c=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],b=0;b<c.length;b++){var d=c[b];try{return new ActiveXObject(d),a.f=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.f};$u=new av;var cv=function(a){ht.call(this);this.headers=new Pm;this.V=a||null;this.g=!1;this.T=this.f=null;this.ha=this.J="";this.o=0;this.h="";this.j=this.ea=this.G=this.da=!1;this.m=0;this.C=null;this.s="";this.M=this.F=!1};x(cv,ht);cv.prototype.l=Mf("goog.net.XhrIo");var pca=/^https?$/i,qca=["POST","PUT"],dv=[],ev=function(a,c,b,d,e,f,g){var k=new cv;dv.push(k);c&&k.listen("complete",c);at(k,"ready",k.ra);f&&(k.m=Math.max(0,f));g&&(k.F=g);k.send(a,b,d,e);return k};
cv.prototype.ra=function(){this.lb();ac(dv,this)};
cv.prototype.send=function(a,c,b,d){if(this.f)throw Error("[goog.net.XhrIo] Object is active with another request="+this.J+"; newUri="+a);c=c?c.toUpperCase():"GET";this.J=a;this.h="";this.o=0;this.ha=c;this.da=!1;this.g=!0;this.f=this.V?bv(this.V):bv($u);this.T=this.V?this.V.getOptions():$u.getOptions();this.f.onreadystatechange=t(this.ma,this);try{Pf(this.l,fv(this,"Opening Xhr")),this.ea=!0,this.f.open(c,String(a),!0),this.ea=!1}catch(f){Pf(this.l,fv(this,"Error opening Xhr: "+f.message));gv(this,
f);return}a=b||"";var e=this.headers.clone();d&&Hn(d,function(f,g){e.set(g,f)});d=Sb(e.Jb(),rca);b=Ha.FormData&&a instanceof Ha.FormData;!Ub(qca,c)||d||b||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");e.forEach(function(f,g){this.f.setRequestHeader(g,f)},this);this.s&&(this.f.responseType=this.s);"withCredentials"in this.f&&this.f.withCredentials!==this.F&&(this.f.withCredentials=this.F);try{hv(this),0<this.m&&(this.M=sca(this.f),Pf(this.l,fv(this,"Will abort after "+this.m+
"ms if incomplete, xhr2 "+this.M)),this.M?(this.f.timeout=this.m,this.f.ontimeout=t(this.oa,this)):this.C=Wt(this.oa,this.m,this)),Pf(this.l,fv(this,"Sending request")),this.G=!0,this.f.send(a),this.G=!1}catch(f){Pf(this.l,fv(this,"Send error: "+f.message)),gv(this,f)}};var sca=function(a){return Be&&We(9)&&r(a.timeout)&&Ia(a.ontimeout)},rca=function(a){return kd("Content-Type",a)};
cv.prototype.oa=function(){"undefined"!=typeof Ga&&this.f&&(this.h="Timed out after "+this.m+"ms, aborting",this.o=8,Pf(this.l,fv(this,this.h)),this.N("timeout"),this.abort(8))};var gv=function(a,c){a.g=!1;a.f&&(a.j=!0,a.f.abort(),a.j=!1);a.h=c;a.o=5;iv(a);jv(a)},iv=function(a){a.da||(a.da=!0,a.N("complete"),a.N("error"))};cv.prototype.abort=function(a){this.f&&this.g&&(Pf(this.l,fv(this,"Aborting")),this.g=!1,this.j=!0,this.f.abort(),this.j=!1,this.o=a||7,this.N("complete"),this.N("abort"),jv(this))};
cv.prototype.fa=function(){this.f&&(this.g&&(this.g=!1,this.j=!0,this.f.abort(),this.j=!1),jv(this,!0));cv.ub.fa.call(this)};cv.prototype.ma=function(){this.w()||(this.ea||this.G||this.j?kv(this):this.sa())};cv.prototype.sa=function(){kv(this)};
var kv=function(a){if(a.g&&"undefined"!=typeof Ga)if(a.T[1]&&4==lv(a)&&2==a.Ua())Pf(a.l,fv(a,"Local request error detected and ignored"));else if(a.G&&4==lv(a))Wt(a.ma,0,a);else if(a.N("readystatechange"),4==lv(a)){Pf(a.l,fv(a,"Request complete"));a.g=!1;try{if(mv(a))a.N("complete"),a.N("success");else{a.o=6;try{var c=2<lv(a)?a.f.statusText:""}catch(b){Pf(a.l,"Can not get status: "+b.message),c=""}a.h=c+" ["+a.Ua()+"]";iv(a)}}finally{jv(a)}}},jv=function(a,c){if(a.f){hv(a);var b=a.f,d=a.T[0]?Pa:null;
a.f=null;a.T=null;c||a.N("ready");try{b.onreadystatechange=d}catch(e){Of(a.l,"Problem encountered resetting onreadystatechange: "+e.message)}}},hv=function(a){a.f&&a.M&&(a.f.ontimeout=null);a.C&&(Xt(a.C),a.C=null)},mv=function(a){var c=a.Ua();a:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break a;default:b=!1}if(!b){if(c=0===c)a=String(a.J).match(sr)[1]||null,!a&&Ha.self&&Ha.self.location&&(a=Ha.self.location.protocol,a=a.substr(0,a.length-1)),c=!pca.test(a?a.toLowerCase():
"");b=c}return b},lv=function(a){return a.f?a.f.readyState:0};cv.prototype.Ua=function(){try{return 2<lv(this)?this.f.status:-1}catch(a){return-1}};
var nv=function(a){try{return a.f?a.f.responseText:""}catch(c){return Pf(a.l,"Can not get responseText: "+c.message),""}},tca=function(a){if(a.f)return oca(a.f.responseText)},uca=function(a){try{if(!a.f)return null;if("response"in a.f)return a.f.response;switch(a.s){case "":case "text":return a.f.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.f)return a.f.mozResponseArrayBuffer}Of(a.l,"Response type "+a.s+" is not supported on this browser");return null}catch(c){return Pf(a.l,"Can not get response: "+
c.message),null}};cv.prototype.getResponseHeader=function(a){if(this.f&&4==lv(this))return a=this.f.getResponseHeader(a),null===a?void 0:a};var vca=function(a){var c={};a=(a.f&&4==lv(a)?a.f.getAllResponseHeaders()||"":"").split("\r\n");for(var b=0;b<a.length;b++)if(!ld(a[b])){var d=te(a[b],":",1),e=d[0];d=d[1];if(Ja(d)){d=d.trim();var f=c[e]||[];c[e]=f;f.push(d)}}return Bc(c,function(g){return g.join(", ")})},fv=function(a,c){return c+" ["+a.ha+" "+a.J+" "+a.Ua()+"]"};var wca=function(){this.l=gb("mr.cloud.CredentialService")},ov=function(a){var c=new Cb,b=Yr.b+"/iceconfig?key="+Yr.f;a.l.info("Requesting TURN credentials from "+b);var d=ev(b,function(){mv(d)?(a.l.info("Got TURN credentials: "+nv(d)),c.resolve(xca(a,tca(d)))):c.resolve(yca(a))},"POST",void 0,{"Content-Type":"application/json"});return c.b},xca=function(a,c){try{var b=[];c.iceServers.forEach(function(d){d.urls.forEach(function(e){0==e.indexOf("turn:")&&b.push({url:e,credential:d.credential,username:d.username})})});
return b}catch(d){return a.l.error("Error parsing TURN credentials.",d),[]}},yca=function(a){a.l.error("XHR failed fetching TURN credentials.",null);return[]};var zca=function(a,c,b){this.l=gb("mr.cloud.slarti.MessageHandler");this.g=a;this.h=c;this.b=b;this.f=new Map},Aca=function(a){if(gj(a.mediaSource))return Promise.resolve({title:"screen"});var c=a.wb&&a.wb.tabId;return null==c?Promise.resolve({title:"",url:""}):new Promise(function(b){chrome.tabs.get(c,function(d){b({title:d&&d.title||"",url:d&&d.url||""})})})},Bca=function(a,c,b,d){var e=d.deviceId,f=c.data;return Aca(b).then(function(g){g={id:null,issuer:null,name:"stream",status:null,results:null,
expirationTime:null,parameters:JSON.stringify({info:g,sessionDescription:f.description,mediaConstraints:f.mediaConstraints,settings:f.settings})};return a.g.send(e,g).then(function(k){return new Promise(function(m,p){a.f.set(k.id,{routeId:b.id,sinkId:d.id,resolve:m,reject:p,Uq:"PENDING_APPROVAL"==k.status})})},function(){Vu(a.b,b.id,7,si(ri(qi(new ni(Qu,"warning")),b.id),d.id))})})},Cca=function(a,c){return ov(a.h).then(function(b){Uu(a.b,new Cj("TURN_CREDENTIALS",{credentials:b}),c.id)})};var Dca=function(a,c,b,d){this.f=a;this.g=c;this.h=b;this.b=d},Gca=function(a,c,b,d,e){return new Promise(function(f){switch(c){case "slarti":case "weave":case "mesi":break;default:throw Error("Unrecognized channel type: "+c);}if(!b.type)throw Error("Message has no type");switch(b.type){case "STOP":f(Vu(a.b,d,1,null));return;case "SESSION_START_SUCCESS":Tr(0);break;case "SESSION_END":break;case "SESSION_FAILURE":Tr(1);f(Vu(a.b,d,2,si(new ni(Qu,"warning"),d?d.sinkId:"")));return;case "__webrtc_stats__":break;
case "PRESENTATION_CONNECTION_MESSAGE":Uu(a.b,b.data,d.id,!0);break;case "OFFER":switch(c){case "slarti":f(Bca(a.f,b,d,e));return;case "weave":f(Eca(a.g,b,d,e));return;default:throw Error("Unexpected channel type: "+c);}case "GET_TURN_CREDENTIALS":switch(c){case "slarti":f(Cca(a.f,d));return;case "weave":f(Fca(a.g,d));return;default:throw Error("Unexpected channel type: "+c);}case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":f(nca(a.h,
b,d,e));return;case "new_session":Uu(a.b,b,d.id,!0);break;case "remove_session":Uu(a.b,b,d.id,!0);a.b.terminateRoute(d.id);break;default:throw Error("Unknown type: "+b.type);}f()})};var pv=function(a,c,b){this.state=a;this.type=null!=c?c:null;this.results=null!=b?b:null},qv=function(a){this.b=a},Hca=function(a,c,b,d){return rv(a,eba,c,b,d,35E3).then(function(e){return sv(a,e)})},Ica=function(a,c,b,d){return rv(a,fba,c,b,d,23E3).then(function(e){var f=e.state;return"done"==f?(e=tv(e),new pv(f,e.type,new gs(e.sessionDescription))):new pv(f)})},rv=function(a,c,b,d,e,f){var g={_webrtcMessage:JSON.stringify(d.presentationUrl?new gs(d.description,null,d.presentationUrl,d.presentationId):
new gs(d.description))};d.settings&&(g._settings=zj(d.settings));d.mediaConstraints&&(g._optMediaConstraints=JSON.stringify(d.mediaConstraints));e&&(g._user=JSON.stringify(e));return uv(a,b,c,g,f)},sv=function(a,c){var b=c.state;switch(b){case "done":return Promise.resolve(Jca(c));case "queued":case "inProgress":return Kca(a,c).then(function(d){return sv(a,d)});default:return Promise.resolve(new pv(b))}},Kca=function(a,c){return new Promise(function(b){var d=setInterval(function(){Lca(a,c.id).then(function(e){"queued"!=
e.state&&"inProgress"!=e.state&&(clearInterval(d),b(e))})},2E3)})},Jca=function(a){a=tv(a);return"__cloud_webrtc_session_message__"==a.type?new pv("done","knocking_cloud_webrtc_session_message",new gs(a.sessionDescription)):new pv("done",a.type)},uv=function(a,c,b,d,e){c={deviceId:c,name:"_cloudCast."+b.name,parameters:d,expirationTimeoutMs:e||1E4};b={};e&&(b.responseAwaitMs=Math.min(e+5E3,25E3));e=bs(Xr.b,["commands"],b);return cs(a.b,e,"POST",c)},tv=function(a){return a.results&&a.results.results?
JSON.parse(a.results.results):null},Lca=function(a,c){c=bs(Xr.b,["commands",c]);return cs(a.b,c,"GET")};qv.$inject=["gapiService"];var Mca=function(a,c,b,d){this.f=a;this.g=c;this.h=b;this.b=d},Eca=function(a,c,b,d){return Nca(a,c,d).then(function(e){a:{var f=b.id;if("done"!=e.state)f=Promise.reject(Error("Offer not executed by receiver. State: "+e.state));else{switch(e.type){case "__cloud_webrtc_session_message__":e=new Cj("ANSWER",e.results.sessionDescription);Uu(a.b,e,f);break;case "knocking_cloud_webrtc_session_message":Sr(0);e=new Cj("KNOCK_ANSWER",e.results.sessionDescription);Uu(a.b,e,f);break;case "knock_denied":Sr(1);
vv(a,Ru,f);break;case "knock_timeout":Sr(2);vv(a,Su,f);break;default:f=Promise.reject(Error("Invalid message type: "+e.type));break a}f=Promise.resolve()}}return f})},Fca=function(a,c){return ov(a.h).then(function(b){Uu(a.b,new Cj("TURN_CREDENTIALS",{credentials:b}),c.id)})},Nca=function(a,c,b){var d=b.deviceId,e=a.g.b;e=e?new cba(e):void 0;c=c.data;switch(b.si){case "owner":Vr(0);break;case "manager":Vr(1);break;case "user":Vr(2);break;case "viewer":Vr(3)}return"viewer"==b.si?Hca(a.f,d,c,e):Ica(a.f,
d,c,e)},vv=function(a,c,b){c=new ni(c,"warning");qi(c);a.b.b.bf(c);Uu(a.b,new Cj("STOP"),b)};var Oca=function(){var a=this;this.l=gb("mr.cloud.settings.SettingsService");this.b=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(c){ej(13);if(a.b){c=l(c);for(var b=c.next();!b.done;b=c.next())if(b=b.value,"media_router.cloudservices.enabled"==b.key){a.b.call(null,b.value);break}}})},Pca=function(a,c){a.b=c},Qca=function(a){var c=a.l;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&c.H("Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})},
Rca=function(a){return wv().catch(function(){return wv().catch(function(c){a.l.H("Error retrieving cloud on setting.",c);return!1})})},wv=function(){return xv("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})},xv=function(a){return new Promise(function(c,b){chrome.storage.sync.get(a,function(d){chrome.runtime.lastError?b(chrome.runtime.lastError):c(d)})})},Sca=function(a){return yv().catch(function(){return yv().catch(function(c){a.l.H("Error retrieving cloud enabled setting.",
c);return!1})})},yv=function(){return Tca().then(function(a){return!!a.value})},Tca=function(){return new Promise(function(a,c){chrome.settingsPrivate.getPref("media_router.cloudservices.enabled",function(b){chrome.runtime.lastError?c(chrome.runtime.lastError):a(b)})})},Uca=function(a){var c=a.l;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&c.H("Error setting notified Hangout privacy.",chrome.runtime.lastError)})},Vca=function(a){return zv().catch(function(){return zv().catch(function(c){a.l.H("Error retrieving hangouts notified setting.",
c);return!1})})},zv=function(){return xv("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var Av=new Map([["displayName","display_name"],["description","description"],["type","type"],["status","status"],["state","state"],["commandDefs","command_defs"]]),Bv=function(a,c){$t.call(this,a,c)};q(Bv,$t);h=Bv.prototype;h.act=function(a,c){a=new Cs({method:"POST",baseUrl:this.b,Mc:["devices:act"],nb:this.nb,body:{gcmId:c,id:a}});return this.f.execute(a).then(function(b){return b})};h.create=function(a){a=new Cs({method:"POST",baseUrl:this.b,Mc:["devices"],nb:this.nb,body:a});return this.f.execute(a).then(function(c){return c})};
h.delete=function(a){a=new Cs({method:"DELETE",baseUrl:this.b,Mc:["devices",a],nb:this.nb});return this.f.execute(a)};h.get=function(a){a=new Cs({method:"GET",baseUrl:this.b,Mc:["devices",a],nb:this.nb});return this.f.execute(a).then(function(c){return c})};
h.list=function(a){var c=a.type,b=a.status;a=a.permission;var d={};c&&(d.type=c);b&&(d.status=b);a&&(d.permission=a);c=new Cs({method:"GET",baseUrl:this.b,Mc:["devices"],dn:d,nb:this.nb});return this.f.execute(c).then(function(e){return e.device||[]})};h.update=function(a,c){for(var b=[],d={},e=l(Av.keys()),f=e.next();!f.done;f=e.next())f=f.value,c[f]&&(d[f]=c[f],b.push(Av.get(f)));d.id=a;a=new Cs({method:"PUT",baseUrl:this.b,Mc:["devices",a],nb:this.nb,body:{device:d,updateMask:b}});return this.f.execute(a).then(function(g){return g})};var Cv=function(a,c,b,d,e,f){f=void 0===f?null:f;this.l=gb("mr.cloud.slarti.SinkDiscoveryService");this.w=a;this.g=c;this.f=b;this.j=d;this.h=e;this.b=f||new ps(this.m.bind(this),b,36E5);eu().addListener();gm(this);bj("mr.cloud.slarti.SinkDiscoveryService",this)};q(Cv,Si);Cv.prototype.je=function(){Oba(this.h).catch(function(){});return this.b.je().filter(function(a){return a.isAvailable})};Cv.prototype.pa=function(a){return this.b.pa(a)};
Cv.prototype.handleEvent=function(a,c){if(a!=chrome.gcm.onMessage)throw Error("Unhandled event: expected chrome.gcm.onMessage");Wca(this,c)};
var Wca=function(a,c){var b=JSON.parse(c.data.data);a.l.info("Received Slarti GCM notification: "+b.type);nb(a.l,function(){return"Got notification: "+JSON.stringify(b)});switch(b.type){case "DEVICE_ADDED":Dv(a,b).then(function(d){"cast-receiver"==d.type&&(d=new os(d.id,d.displayName,"ONLINE"==d.status),a.b.b.set(d.id,d),qs(a.f,[d.sb]))});break;case "DEVICE_CHANGED":Dv(a,b).then(function(d){if("cast-receiver"==d.type){var e=Bm(Am(),d.id);if(e=a.b.pa(e))e.displayName=d.displayName,e.isAvailable="ONLINE"==
d.status,rs(a.f,[e.sb])}});break;case "DEVICE_REMOVED":Xca(a,Yca(b));Promise.resolve();break;case "COMMAND_CHANGED":Zca(a,b).then(function(d){var e=a.j,f=d.id,g=e.f.get(f);if(g){var k=g.routeId,m=g.sinkId,p=g.resolve,u=g.reject,A=g.Uq;g=!0;try{var F=JSON.parse(d.results||"{}"),E=F.sessionDescription,J=F.errorCode,U=F.errorText;switch(d.status){case "SUCCESS":p(Uu(e.b,new Cj("ANSWER",E),k));A&&Sr(0);break;case "ERROR":case "TIMEOUT":var wa="TIMEOUT"==d.status;p=Qu;"KNOCK_DENIED"==J&&(Sr(wa?2:1),p=
wa?Su:Ru);Vu(e.b,k,7,si(ri(qi(new ni(p,"warning")),k),m));throw Error("Slarti command "+f+" failed with status: "+(d.status+", errorCode: "+J+", errorText: ")+U);default:g=!1}}catch(db){u(db)}finally{g&&e.f.delete(f)}}else e.l.H("Received update to unknown command with name = "+(d.name+" and id = "+f))});break;default:Promise.resolve()}};Cv.prototype.m=function(){return this.g.list({type:"cast-receiver"}).then(function(a){return a.map(function(c){return new os(c.id,c.displayName,"ONLINE"==c.status)})})};
Cv.prototype.Ca=function(){return"SlartiSinkDiscoveryService"};Cv.prototype.qb=function(){return[{cache:ts(this.b)}]};Cv.prototype.ob=function(){var a=dm(this);a&&us(this.b,a.cache)};
var Xca=function(a,c){c=Bm(Am(),c);var b=a.b.pa(c);b&&(a.b.b.delete(c),ss(a.f,[b.sb]))},Yca=function(a){a=a.deviceInfo;return a.device?a.device.id:a.deviceId},Dv=function(a,c){c=c.deviceInfo;return c.device?Promise.resolve(c.device):a.g.get(c.deviceId)},Zca=function(a,c){c=c.commandInfo;return c.command?Promise.resolve(c.command):a.w.get(c.commandId)};var Ev=function(){this.b=null},Fv=function(a,c){if(!a.b||O(a.b,2)<O(c,2))a.b=Gl(c)},Gv=function(a){return a.b?O(a.b,2)+";"+O(a.b,1):null};var Hv=function(){this.D=this.w=this.J=this.K=this.F=this.C=this.g=this.s=this.h=this.f=this.j=this.ha=this.ea=this.V=this.G=this.jb=this.da=this.T=this.M=this.m=this.o=this.b=null},Iv=function(){var a=Hv.cb();null==a.w&&(a.w=new Ev);return a.w},Jv=function(a){null==a.b&&(a.b=new zs);return a.b},Kv=function(a){null==a.o&&(a.o=new Wba(Jv(a)));return a.o},Lv=function(a){null==a.m&&(a.m=new Zt);return a.m},Mv=function(a){null==a.M&&(a.M=new Xu(Jv(a),Lv(a)));return a.M},Ov=function(a,c){null==a.G&&(a.G=
new zca(Mv(a),Nv(a),c));return a.G},Pv=function(a){null==a.s&&(a.s=new qv(Kv(a)));return a.s},Nv=function(a){null==a.J&&(a.J=new wca(Kv(a)));return a.J},Qv=function(a){null==a.D&&(a.D=new fs);return a.D};Qa(Hv);var Sv=function(a,c){this.g=a;this.w=c;this.j=new Cb;this.ga=this.j.b;this.b=Rv(a.id);this.f=new Cb;this.h=!1;$ca(this);ada(this);this.b.sendMessage(new Cj("GET_TURN_CREDENTIALS"))};Sv.prototype.start=function(){var a=this;return this.ga.then(function(c){if(c.b)return Promise.reject(Error("Presentation already started"));c.start();return a.f.b})};Sv.prototype.stop=function(){var a=this;this.h=!1;return this.ga.then(function(c){c.stop();a.ga=Promise.reject(Error("Peer connection has already been stopped"))})};
var $ca=function(a){a.b.onMessage=function(c){if(c.type)switch(c.type){case "TURN_CREDENTIALS":a.j.resolve(new Hj(a.g.id,c.data.credentials));break;case "ANSWER":a.ga.then(function(b){Pj(b,c.data)});break;case "STOP":a.f.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+c.type);}else a.ga.then(function(b){var d={type:"PRESENTATION_CONNECTION_MESSAGE",data:c};"string"==typeof d?b.h.send(d):b.h.send(JSON.stringify(d))})}},ada=function(a){a.ga.then(function(c){Lj(c,
function(b){a.b.sendMessage(new Cj("OFFER",new Ej(b,null,null,a.w,a.g.id)))});Mj(c,function(b){b=Dj(b);"STOP"==b.type&&a.stop();a.b.sendMessage(b)});Ij(c,function(){a.h=!0;a.b.sendMessage(new Cj("SESSION_START_SUCCESS"));a.f.resolve(a.g)});Kj(c,function(){a.b.sendMessage(new Cj("SESSION_END"))});Jj(c,function(b){a.h||a.f.reject(b);a.b.sendMessage(new Cj("SESSION_FAILURE"))})})};var Tv=function(a){this.b=a;this.f=new Map;this.F=new Map;this.K=new Map;this.o=[];this.j=this.J=this.D=this.G=this.w=null;this.m=this.h=this.g=!1;this.C=new Map;this.s=new Map;gm(this)};Tv.prototype.getName=function(){return"cloud"};
Tv.prototype.initialize=function(){var a=this;this.l.info("Initializing Cloud MRP");var c=Hv.cb();null==c.ha&&(null==c.ea&&(c.ea=new js(Kv(c),Qv(c))),c.ha=new ku(c.ea,this));this.o.push(c.ha);if(null==c.jb){var b=Mv(c);null==c.T&&(c.T=new Bv(Jv(c),Lv(c)));var d=c.T,e=Ov(c,this);null==c.V&&(null==c.da&&(c.da=new au(Jv(c),Lv(c))),c.V=new Nba(c.da,window.localStorage,Qv(c)));c.jb=new Cv(b,d,this,e,c.V)}this.o.push(c.jb);null==c.h&&(null==c.f&&(c.f=new $r(Kv(c),Jv(c))),b=c.f,null==c.j&&(c.j=new kca(Kv(c))),
c.h=new ws(b,c.j,this));this.w=c.h;this.o.push(this.w);this.G=Pv(c);Ov(c,this);this.D=Jv(c);null==c.F&&(b=Ov(c,this),null==c.g&&(c.g=new Mca(Pv(c),Jv(c),Nv(c),this)),d=c.g,null==c.C&&(c.C=new mca(Jv(c),this)),c.F=new Dca(b,d,c.C,this));this.J=c.F;null==c.K&&(c.K=new Oca);this.j=c.K;Sca(this.j).then(function(f){a.g=f;a.l.info("Cloud enabled setting: "+a.g)});Rca(this.j).then(function(f){a.h=f;a.l.info("Cloud on setting: "+a.h)});Pca(this.j,function(f){a.g=f;a.l.info("Cloud enabled setting: "+a.g);
a.g&&Uv(a)});Vca(this.j).then(function(f){a.m=f;a.l.info("Privacy notified setting: "+a.m)})};Tv.prototype.Hd=function(){return Array.from(this.f.values())};
Tv.prototype.Cg=function(a){if(!Vv(this,a))return xq;nb(this.l,"GetAvailableSinks for "+a);var c=[];if(this.h||bda())c=Uv(this);this.s.clear();for(var b={},d=l(this.C.values()),e=d.next();!e.done;b={sf:b.sf,kh:b.kh},e=d.next())b.sf=e.value,b.kh=!1,c.forEach(function(f){return function(g){g.id==f.sf.id&&(f.kh=!0,g.sb.friendlyName=f.sf.sb.friendlyName)}}(b)),b.kh||this.s.set(b.sf.id,b.sf);c=c.concat.apply(c,n(this.s.values()));nb(this.l,function(){return"Available sinks are..."+JSON.stringify(c)});
b=c.map(function(f){return f.sb});this.w&&(b=b.concat(cda));return new wq(b,-1!=a.indexOf("0F5096E8")?jj:null)};var Uv=function(a){var c=[];a.l.info("Checking cloud discovery services");Am().g=v();a.o.forEach(function(b){b=b.je();c=c.concat(b)});return c};h=Tv.prototype;h.startObservingMediaSinks=function(){};h.stopObservingMediaSinks=function(){};h.startObservingMediaRoutes=function(){};h.stopObservingMediaRoutes=function(){};h.pa=function(a){return(a=Wv(this,a))?a.sb:null};
h.createRoute=function(a,c,b,d,e,f,g){var k=this;this.l.info("createRoute called");nb(this.l,"urn: "+a+" sinkId:"+c);if(e=this.F.get(c))return ui(this.b.um(this,e,a,b,g,function(m){m.mediaSource=a;m.wb.tabId=g;return vi(m)}),function(m){k.b.gf(m);return m});e=Wv(this,c);return dda(this,a,e,c,b,d,g)};
var Xv=function(a,c,b,d,e){c instanceof vq&&2==c.errorCode?Vu(a,b,6,null):(a.l.error("Error on start session",c instanceof Error?c:Error("Expected an Error value, got "+c)),a.f.has(b.id)&&Vu(a,b,e,si(new ni(Qu,"warning"),b.sinkId)));if(c=a.w)c=a.w,c.f.delete(d.deviceId)?(c.b.b.delete(d.id),c=!0):c=!1;c&&ss(a,[d.sb])},dda=function(a,c,b,d,e,f,g){if(f)return wi(Error("not supported"));f=!1;switch(b.b){case "slarti":case "weave":Ur(1);break;case "mesi":f=!0;if(!a.m){a.m=!0;Uca(a.j);var k=si(pi(),d);
a.b.bf(k)}Ur(0)}Am().f=new xm(b.model,null);var m=Np(e,a.getName(),d,c,!0,"");a.f.set(m.id,m);a.F.set(d,m);a.C.set(m.id,b);a.K.set(m.id,b.b);a.b.Xf(a,m);a.b.ag(a.Ca(),!0);if(ij(c)&&!f)return a.l.info("starting presentation on route: "+m.id),eda(m,c).catch(function(p){Xv(a,p,m,b,7);throw p;});a.l.info("starting mirroring on route: "+m.id);m.wb={tabId:g,sessionId:"",dg:"",ne:b.model};ij(c)&&(m.isOffscreenPresentation=!0);return a.b.qj(a,m,e).catch(function(p){Xv(a,p,m,b,5);throw p;})};
Tv.prototype.terminateRoute=function(a){return Vu(this,a,0,null)};
var Vu=function(a,c,b,d){var e="string"==typeof c?a.f.get(c):c;if(!e)return Promise.reject(new vq(3,"Route in cloud provider not found for routeId "+c));a.l.info("terminating route: "+e.id);a.f.delete(e.id);a.F.delete(e.sinkId);c=a.C.get(e.id);a.C.delete(e.id);d&&a.b.bf(d);Bb("MediaRouter.Cloud.Session.End",b,Taa);switch(b){case 1:break;default:switch(c.b){case "weave":uv(a.G,c.deviceId,gba,{})}}a.b.Mg(e);0==a.f.size&&a.b.ag(a.Ca(),!1);a.b.onPresentationConnectionStateChanged(e.id,"terminated");a.s.has(e.sinkId)&&
(b=a.s.get(e.sinkId),ss(a,[b.sb]),a.s.delete(e.sinkId));return Promise.resolve()};h=Tv.prototype;h.sendRouteMessage=function(a,c){var b=this.K.get(a);if(b){var d=(a=this.f.get(a)||void 0)?Wv(this,a.sinkId):void 0;return Gca(this.J,b,c,a,d)}return"string"===typeof c?(Uu(this,c,a),Promise.resolve()):Promise.reject(Error("Channel type missing"))};h.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};
h.Lf=function(a){var c=new Aj;5>c.minFrameRate&&(c.minFrameRate=5);var b=this.Kf(a);"hangouts"==b||"meetings"==b?(c.maxWidth=Math.min(window.screen&&window.screen.width||Infinity,2880),c.maxHeight=Math.min(window.screen&&window.screen.height||Infinity,1800)):c.senderSideLetterboxing=!0;Bj(c);Object.freeze(c);this.l.info("Settings for "+a+": "+zj(c));if(!c.shouldCaptureAudio&&!c.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture.");return c};
h.Kf=function(a){var c=null;a=Wv(this,a);switch(a.b){case "slarti":case "weave":c="webrtc";break;case "mesi":c=a.Nd?"meetings":"hangouts"}return c};h.Uh=function(){};h.sg=function(a,c){nb(this.l,"Checking canRoute: "+a+" for sinkId: "+c);return Vv(this,a)&&!!this.pa(c)};h.Df=function(a,c){return ij(a)&&this.f.has(c)};h.joinRoute=function(a,c){return(a=this.f.get(c))?(this.l.info("joining route: "+a.id),vi(a)):wi(Error("not supported"))};h.connectRouteByRouteId=function(){return wi(Error("not supported"))};
h.detachRoute=function(){};
var qs=function(a,c){a.l.info(c.length+" sinks added");0<c.length&&!a.h&&(Qca(a.j),a.h=!0);c=Wv(a,c[0].id);Am().b=new xm(c.model,null);a.b.hd();a.b.onSinkAvailabilityUpdated(a,2);a.l.info("sinkAvailability changed to AVAILABLE")},ss=function(a,c){a.l.info(c.length+" sinks removed");a.o.some(function(b){return 0<b.je().length})||(a.b.onSinkAvailabilityUpdated(a,0),a.l.info("sinkAvailability changed to UNAVAILABLE"));a.b.hd()},rs=function(a,c){a.l.info(c.length+" sinks updated");a.b.hd()},Uu=function(a,
c,b,d){(void 0===d?0:d)?a.b.ie(b,c):a.b.Th(b,c)},Wv=function(a,c){var b=fda(a,c);b||(b=null,(c=a.F.get(c))&&(b=a.C.get(c.id)));return b},fda=function(a,c){var b=null;a.o.some(function(d){b=d.pa(c);return!!b});return b},bda=function(){var a=Am().g;return 3E5<=Date.now()-a},Vv=function(a,c){var b=hj(c);c=ij(c);if(a.D.g&&!a.D.f&&b)return a.b.onSinkAvailabilityUpdated(a,2),!0;var d=!1;a.g&&a.D.f&&(d=!0);var e;if(e=!chrome.declarativeWebRequest)a=a.D,e=!(a.g||a.f&&a.b&&(-1!=Bs.indexOf(a.b)||-1!=Bs.indexOf(As(a))))&&
c;return e?!1:d&&(b||c)};h=Tv.prototype;h.searchSinks=function(a,c){var b=this;if(!Vv(this,a))return Promise.reject(Error("err"));a=qba(this.w,c);a.then(function(d){qs(b,[d])});return a};h.createMediaRouteController=function(){return cb()};h.provideSinks=function(){};h.Ca=function(){return"CloudProvider"};h.qb=function(){return[void 0,{cloudEnabled:this.g,cloudOn:this.h,notifiedHangoutsPrivacy:this.m}]};
h.ob=function(){var a=em(this);a&&(a.cloudEnabled&&(this.g=a.cloudEnabled),a.cloudOn&&(this.h=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.m=a.notifiedHangoutsPrivacy))};var eda=function(a,c){a=new Sv(a,c);return xi(a.start())};Tv.prototype.l=gb("mr.CloudProvider");var cda=new $l("pseudo:cloud","","meeting","","default");var Yv=function(){Gp.call(this,12,"ExternalMessageListener","mr.ProviderManager",chrome.runtime.onMessageExternal)};q(Yv,Gp);Yv.prototype.ih=function(a,c){return c.id&&-1!=gda.indexOf(c.id)?"start"==a.type||"stop"==a.type||"subscribe_log_data"==a.type:!1};Yv.prototype.Bi=function(){return!0};var $v=function(){Zv||(Zv=new Yv);return Zv},Zv=null,gda=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"];var aw=function(){Gp.call(this,11,"InternalMessageListener","mr.ProviderManager",chrome.runtime.onMessage)};q(aw,Gp);aw.prototype.ih=function(a,c){return"retrieve_log_data"==a.type&&c.id==chrome.runtime.id&&c.url=="chrome-extension://"+c.id+"/feedback.html"};aw.prototype.Bi=function(){return!0};var cw=function(){bw||(bw=new aw);return bw},bw=null;function hda(){var a=dw;var c=new yq(a);var b=new or(a);c=[c,b];c.push(new Tv(a));return c};var ew=function(a,c){this.routeId=a;this.message=c},fw=function(a){return"string"!=typeof a.message};var gw=function(a){this.D=a;this.h=this.j=null},hw=function(a){if(null==a.h)if(null==a.j||Date.now()-a.j>=a.D)a.w();else{var c=Math.max(a.j+a.D-Date.now(),5);a.h=setTimeout(a.w.bind(a),c)}};gw.prototype.w=function(){null!=this.h&&(clearTimeout(this.h),this.h=null);this.s();this.j=Date.now()};gw.prototype.s=function(){};var iw=function(a,c){gw.call(this,20);this.b=new Map;this.f=new Set;this.o=null;this.m=this.g=0;this.C=!1;this.K=a;this.F=c;this.l=gb("mr.RouteMessageSender")};q(iw,gw);iw.prototype.init=function(a){this.o=a;gm(this)};iw.prototype.stopListeningForRouteMessages=function(a){this.f.delete(a)};
iw.prototype.send=function(a,c){var b=this.b.get(a);b||(b=[],this.b.set(a,b));c=new ew(a,c);b.push(c);50<b.length&&1==b.length%50&&this.l.H(function(){return"Message queue length is excessively large ("+(b.length+") for route "+a)});this.g+=fw(c)?0:c.message.length;fw(c)&&this.m++;jw(this);this.f.has(a)&&hw(this)};
var kw=function(a,c){if(0!=c.length){c=l(c);for(var b=c.next();!b.done;b=c.next())b=b.value,a.g-=fw(b)?0:b.message.length,fw(b)&&a.m--}},jw=function(a){var c=0<a.m||a.g>a.F;c!=a.C&&(a.C=c,a.K.ag(a.Ca(),c))};iw.prototype.s=function(){if(this.o){for(var a=l(this.f),c=a.next();!c.done;c=a.next()){c=c.value;var b=this.b.get(c);b&&0!=b.length&&(this.o(c,b),kw(this,b),this.b.set(c,[]))}jw(this)}else this.l.error("sendMessagesCallback not set. Messages not delivered.")};iw.prototype.Ca=function(){return"mr.RouteMessageSender"};
iw.prototype.qb=function(){var a=[].concat(n(this.b.entries())).map(function(c){return[c[0],c[1].map(function(b){return b.message})]});return[new ida(a,Array.from(this.f),this.g)]};iw.prototype.ob=function(){var a=dm(this);if(a){this.b=new Map;for(var c={},b=l(a.f),d=b.next();!d.done;c={nh:c.nh},d=b.next())d=d.value,c.nh=d[0],d=d[1].map(function(e){return function(f){return new ew(e.nh,f)}}(c)),this.b.set(c.nh,d);this.f=new Set(a.b);this.g=a.g}};var ida=function(a,c,b){this.f=a;this.b=c;this.g=b};var jda=function(a,c){this.type="internal_message";this.routeId=a;this.message=c};var lw=function(a,c,b){this.b=a;this.h=c;this.g=b;this.onMessage=function(){};b.listen("internal_message",this.f,this)};lw.prototype.sendMessage=function(a,c){return this.h(this.b,a,c)};lw.prototype.f=function(a){if(a.routeId==this.b)this.onMessage(a.message)};lw.prototype.lb=function(){this.onMessage=function(){};daa(this.g,this.f,this)};
var kda=new lw("",function(){return Promise.resolve()},new Jq),lda=function(a){this.b=a},Rv=function(a){var c=li,b=c.b.Ki(a);return b?new lw(a,b.sendRouteMessage.bind(b),c.b.Mi()):kda};var mw=function(a,c){this.w=null!=c?a.bind(c):a;this.j=this.m.bind(this);this.h=[];this.b=!1;this.f=null};mw.prototype.g=function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];this.h=[].concat(n(c));null==this.f?nw(this):this.b=!0};var nw=function(a){a.f=setTimeout(a.j,500);a.w.apply(a,n(a.h))};mw.prototype.m=function(){this.f=null;this.b&&(this.b=!1,nw(this))};var ow=function(){this.config=null;this.l=gb("mr.ProviderManager");this.g=[];this.f=new Map;this.m=new Map;this.j=new Set;this.h=new Set;this.D=new Map;this.b=this.s=null;this.G=new Jq;this.J=new mw(this.rn,this);this.V=new mw(this.K,this);this.w=new iw(this,524288);this.F=0;this.o=new Map;this.C=[];var a=new Pr(this);this.T=a.onMessage.bind(a);a=new Jr(this);this.M=a.onMessage.bind(a);this.onBeforeInvokeHandler=this.onBeforeInvokeHandler;this.createRoute=this.createRoute;this.joinRoute=this.joinRoute;
this.connectRouteByRouteId=this.connectRouteByRouteId;this.terminateRoute=this.terminateRoute;this.startObservingMediaSinks=this.startObservingMediaSinks;this.stopObservingMediaSinks=this.stopObservingMediaSinks;this.sendRouteMessage=this.sendRouteMessage;this.sendRouteBinaryMessage=this.sendRouteBinaryMessage;this.startListeningForRouteMessages=this.startListeningForRouteMessages;this.stopListeningForRouteMessages=this.stopListeningForRouteMessages;this.startObservingMediaRoutes=this.startObservingMediaRoutes;
this.stopObservingMediaRoutes=this.stopObservingMediaRoutes;this.detachRoute=this.detachRoute;this.searchSinks=this.searchSinks;this.provideSinks=this.provideSinks;this.updateMediaSinks=this.updateMediaSinks;this.createMediaRouteController=this.createMediaRouteController};q(ow,Si);
ow.prototype.handleEvent=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];if(a==chrome.runtime.onMessage)this.T.apply(this,n(b));else if(a==chrome.runtime.onMessageExternal)this.M.apply(this,n(b));else throw Error("Unhandled event");};
var Rr=function(a,c){c=a.D.get(c);return Wi(c).then(function(b){b.initialize(a,!!a.config&&a.config.use_mirroring_service);return b})},mda=function(a,c,b){c.forEach(function(d){if(Qr(a,d.getName()))a.l.H("Provider "+d.getName()+" already registered.");else try{d.initialize(b),a.g.push(d),a.o.set(d.getName(),0)}catch(e){a.l.H("Provider "+d.getName()+" failed to initialize.",e)}})};
ow.prototype.initialize=function(a,c,b){this.D.set("webrtc","mr.mirror.webrtc.WebRtcService");this.D.set("cast_streaming","mr.mirror.cast.Service");this.D.set("hangouts","mr.mirror.hangouts.HangoutsService");this.D.set("meetings","mr.mirror.hangouts.MeetingsService");var d=new lda(this);li||(li=d);this.b=a;this.w.init(this.b.onRouteMessagesReceived.bind(this.b));mda(this,c,b);this.config=b;gm(this);bj("mr.ProviderManager",this)};
var qw=function(a,c,b){return new Promise(function(d,e){var f=null;a.F++;pw(a);f=window.setTimeout(function(){f=null;c.cancel(new vq(2,"timeout after "+b+" ms."))},b);c.b.then(function(g){a.F--;pw(a);null!=f&&window.clearTimeout(f);d(g)},function(g){a.F--;pw(a);null!=f&&window.clearTimeout(f);e(g instanceof vq?g:g instanceof Error?new vq(0,g.message,g.stack):new vq(0))})})};ow.prototype.onBeforeInvokeHandler=function(){ej(0)};
var rw=function(a){return"string"==typeof a?a:a.unique?"":a.scheme+"://"+a.host+"\n       "+(a.port?":"+a.port:"")+"/"};h=ow.prototype;
h.createRoute=function(a,c,b,d,e,f,g){var k=this;g=void 0===g?!1:g;var m=nda(this,a,c);if(!m)return Promise.reject(new vq(7,"No provider supports createRoute with source: "+a+" and sink: "+c));var p=void 0;void 0!==d&&(p=rw(d));f=f&&0<f?f:6E4;a=m.createRoute(a,c,b,g,f,p,e);return qw(this,a,f).then(function(u){return u},function(u){k.l.error("Error creating route.",u);throw u;})};
h.connectRouteByRouteId=function(a,c,b,d,e,f){var g=this.f.get(c);if(!g)return Promise.reject(new vq(7,"No provider supports join "+c));a=g.connectRouteByRouteId(a,c,b,rw(d),e);return qw(this,a,f&&0<f?f:3E4)};h.joinRoute=function(a,c,b,d,e,f){f=void 0===f?!1:f;var g=oda(this,a,c);if(!g)return Promise.reject(new vq(7,"No provider supports join "+c));e=e&&0<e?e:3E4;a=g.joinRoute(a,c,f,e,rw(b),d);return qw(this,a,e)};
h.terminateRoute=function(a){var c=this.f.get(a);return c?sw(this,a).then(function(){return c.terminateRoute(a)}):Promise.reject(new vq(3,"Route not found for routeId "+a))};h.startObservingMediaSinks=function(a){this.j.has(a)||(this.j.add(a),this.g.forEach(function(c){c.startObservingMediaSinks(a)}));tw(this,a)};h.stopObservingMediaSinks=function(a){this.j.delete(a)?uw(this,a):this.l.info("No existing query "+a)};
var uw=function(a,c){a.g.forEach(function(b){b.stopObservingMediaSinks(c)})},tw=function(a,c){if("urn:x-org.chromium.media:source:tab:-1"==c)a.l.H("No sinks for sourceUrn: "+c);else{var b=new Map,d=[];a.g.forEach(function(e){var f=e.Cg(c);0<f.sinks.length&&(d=f.origins);f.sinks.forEach(function(g){b.has(g.id)?a.l.H("Detected duplicate sink "+g.id+" from provider: "+e.getName()):b.set(g.id,g)})});pda(a,c,Array.from(b.values()),d||[])}},pda=function(a,c,b,d){a.l.info("Sending "+b.length+" sinks to MR for "+
c);a.b.onSinksReceived(c,b,d.map(Ho))};h=ow.prototype;h.sendRouteMessage=function(a,c,b){var d=this.f.get(a);d?(a=d.sendRouteMessage(a,c,b),a=qw(this,xi(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};h.sendRouteBinaryMessage=function(a,c){var b=this.f.get(a);b?(a=b.sendRouteBinaryMessage(a,c),a=qw(this,xi(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};
h.startListeningForRouteMessages=function(a){var c=this.w;c.f.has(a)||(c.f.add(a),(a=c.b.get(a))&&0<a.length&&hw(c))};h.stopListeningForRouteMessages=function(a){this.w.stopListeningForRouteMessages(a)};h.detachRoute=function(a){var c=this.f.get(a);c?c.detachRoute(a):this.l.info("Route "+a+" does not exist.")};h.enableMdnsDiscovery=function(){};var nda=function(a,c,b){return a.g.find(function(d){return d.sg(c,b)})||null},oda=function(a,c,b){return a.g.find(function(d){return d.Df(c,b)})||null};
ow.prototype.K=function(){var a=this;this.j.forEach(function(c){tw(a,c)})};var pw=function(a){a.b.setKeepAlive(0<a.F||0<a.C.length)};h=ow.prototype;h.startObservingMediaRoutes=function(a){this.h.has(a)||(this.h.add(a),this.g.forEach(function(c){c.startObservingMediaRoutes(a)}));this.J.g()};h.stopObservingMediaRoutes=function(a){this.h.delete(a)?this.g.forEach(function(c){c.stopObservingMediaRoutes(a)}):this.l.info("No existing route query "+a)};
h.rn=function(){var a=this;if(0!=this.h.size){var c=[];this.g.forEach(function(b){c=c.concat(b.Hd())});this.h.forEach(function(b){var d=[];a.g.forEach(function(e){e.Hd().forEach(function(f){!f.Gf&&e.Df(b,void 0,f)&&d.push(f.id)})});a.b.onRoutesUpdated(c,b,d)})}};h.Ca=function(){return"ProviderManager"};
h.qb=function(){return[new qda(this.g.map(function(a){return a.getName()}),Array.from(this.j),Array.from(this.h),Array.from(this.f,function(a){var c=l(a);a=c.next().value;c=c.next().value;return[a,c.getName()]}),Array.from(this.o),this.s)]};h.ob=function(){var a=dm(this);if(a){this.j=new Set(a.j);this.h=new Set(a.g);for(var c=l(a.f),b=c.next();!b.done;b=c.next()){var d=l(b.value);b=d.next().value;d=d.next().value;d=Qr(this,d);this.f.set(b,d)}this.o=new Map(a.h);this.s=a.b||null}};h.Ki=function(a){return this.f.get(a)};
h.Xf=function(a,c){this.f.set(c.id,a);this.gf(c)};h.Mg=function(a){sw(this,a.id);this.f.delete(a.id);var c=this.w,b=a.id;c.f.delete(b);var d=c.b.get(b);d&&(c.b.delete(b),kw(c,d),jw(c));this.gf(a)};h.gf=function(){0<this.h.size&&this.J.g()};h.Si=function(a){var c=this.f.get(a.id);c&&(c.Uh(a.id),0<this.h.size&&this.rn())};h.ie=function(a,c){this.f.has(a)?("string"===typeof c||c instanceof Uint8Array||(c=JSON.stringify(c)),this.w.send(a,c)):this.l.H("Got route message for closed route "+a)};
h.onPresentationConnectionStateChanged=function(a,c){"terminated"==c&&this.w.w();this.b.onPresentationConnectionStateChanged(a,c)};h.onPresentationConnectionClosed=function(a,c,b){this.w.w();this.b.onPresentationConnectionClosed(a,c,b)};h.Vh=function(a){this.m.delete(a);var c=this.f.get(a);c&&c.terminateRoute(a)};h.Th=function(a,c){eaa(this.G,new jda(a,c))};h.hd=function(){this.V.g()};
h.onSinkAvailabilityUpdated=function(a,c){var b=this;if(this.o.get(a.getName())!=c){var d=vw(this);this.o.set(a.getName(),c);a=vw(this);d!=a&&(0==a&&this.K(),this.b.onSinkAvailabilityUpdated(a),0==a&&(this.j.forEach(function(e){uw(b,e)}),this.j.clear()))}};var vw=function(a){return Array.from(a.o.values()).reduce(function(c,b){return Math.max(c,b)},0)};ow.prototype.Mi=function(){return this.G};ow.prototype.bf=function(a){this.b.onIssue(a)};
var sw=function(a,c){return a.m.has(c)?Rr(a,a.m.get(c)).then(function(b){a.m.delete(c);return b.m()}):Promise.resolve(!1)};ow.prototype.qj=function(a,c,b,d){var e=this,f=a.Kf(c.sinkId);this.l.info("Starting mirroring using service: "+f);this.m.set(c.id,f);return yi(Rr(this,f),function(g){e.s=f;return g.Ej(c,c.mediaSource,a.Lf(c.sinkId),b,d).catch(function(k){if(k instanceof Ai&&3==k.reason)throw new vq(8);throw k;})})};
ow.prototype.um=function(a,c,b,d,e,f){var g=this,k=this.m.get(c.id);return k?yi(Rr(this,k),function(m){g.s=k;return m.Fj(c,b,a.Lf(c.sinkId),d,e,f)}):wi(Error("Route "+c.id+" is not mirroring"))};ow.prototype.ag=function(a,c){var b=this.C.indexOf(a),d=0<=b;c&&!d?this.C.push(a):!c&&d&&this.C.splice(b,1);pw(this)};var Qr=function(a,c){return a.g.find(function(b){return b.getName()==c})||null};h=ow.prototype;
h.searchSinks=function(a,c,b){var d=a.startsWith("pseudo:")?a.substring(7):null;return(d=d?Qr(this,d):null)?d.searchSinks(c,b).then(function(e){return e.id}):Promise.reject(Error("No provider supports "+a))};h.provideSinks=function(a,c){var b=Qr(this,a);b?b.provideSinks(c):this.l.error("provideSinks: Provider not found for providerName "+a)};h.updateMediaSinks=function(a){this.j.has(a)||tw(this,a)};
h.createMediaRouteController=function(a,c,b){var d=this,e=this.f.get(a);return e?e.createMediaRouteController(a,c,b).catch(function(f){d.l.error("createMediaRouteController failed: "+f.message);c.close();b.ptr.reset();throw f;}):(a="createMediaRouteController: Provider not found for "+a,this.l.error(a),c.close(),b.ptr.reset(),Promise.reject(Error(a)))};h.onMediaRemoterCreated=function(a,c,b){this.b.onMediaRemoterCreated(a,c,b)};
h.getMediaSinkServiceStatus=function(){return"function"!=typeof this.b.getMediaSinkServiceStatus?Promise.resolve({status:""}):this.b.getMediaSinkServiceStatus()};h.getMirroringServiceHostForTab=function(a,c){this.b.getMirroringServiceHostForTab(a,c)};h.getMirroringServiceHostForDesktop=function(a,c,b){this.b.getMirroringServiceHostForDesktop(a,c,b)};h.getMirroringServiceHostForOffscreenTab=function(a,c,b){this.b.getMirroringServiceHostForOffscreenTab(a,c,b)};
var qda=function(a,c,b,d,e,f){this.j=c;this.g=b;this.f=d;this.h=e;this.b=f};
